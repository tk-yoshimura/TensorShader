using System;
using System.Diagnostics;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TensorShader;
using TensorShader.Operators.Connection2D;

namespace TensorShaderTest.Operators.Connection2D {
    [TestClass]
    public class ChannelwiseDeconvolutionTest {
        [TestMethod]
        public void ExecuteTest() {
            float max_err = 0;

            foreach (int batch in new int[] { 1, 2 }) {
                foreach (int channels in new int[] { 1, 2, 3, 4, 5, 10, 15, 20 }) {
                    foreach (int kheight in new int[] { 1, 3, 5 }) {
                        foreach (int kwidth in new int[] { 1, 3, 5 }) {
                            foreach (int inwidth in new int[] { 8, 9, 13, 17 }) {
                                foreach (int inheight in new int[] { 8, 9, 19, 23 }) {
                                    int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1;

                                    float[] yval = (new float[outwidth * outheight * channels * batch]).Select((_, idx) => idx * 1e-4f).ToArray();
                                    float[] wval = (new float[kwidth * kheight * channels]).Select((_, idx) => idx * 1e-4f).Reverse().ToArray();

                                    Map2D y = new Map2D(channels, outwidth, outheight, batch, yval);
                                    Filter2D w = new Filter2D(channels, 1, kwidth, kheight, wval);

                                    Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight);

                                    OverflowCheckedTensor y_tensor = new OverflowCheckedTensor(Shape.Map2D(channels, outwidth, outheight, batch), yval);
                                    OverflowCheckedTensor w_tensor = new OverflowCheckedTensor(Shape.Kernel2D(channels, 1, kwidth, kheight), wval);

                                    OverflowCheckedTensor x_tensor = new OverflowCheckedTensor(Shape.Map2D(channels, inwidth, inheight, batch));

                                    ChannelwiseDeconvolution ope = new ChannelwiseDeconvolution(outwidth, outheight, channels, kwidth, kheight, batch);

                                    ope.Execute(y_tensor, w_tensor, x_tensor);

                                    float[] x_expect = x.ToArray();
                                    float[] x_actual = x_tensor.State;

                                    CollectionAssert.AreEqual(yval, y_tensor.State);
                                    CollectionAssert.AreEqual(wval, w_tensor.State);

                                    AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, ref max_err, $"mismatch value {channels},{kwidth},{kheight},{inwidth},{inheight},{batch}");

                                    Console.WriteLine($"pass: {channels},{kwidth},{kheight},{inwidth},{inheight},{batch}");
                                }
                            }
                        }
                    }
                }
            }

            Console.WriteLine($"maxerr:{max_err}");
        }

        [TestMethod]
        public void SpeedTest() {
            int inwidth = 512, inheight = 512, channels = 31, ksize = 3;
            int outwidth = inwidth - ksize + 1, outheight = inheight - ksize + 1;

            OverflowCheckedTensor y_tensor = new OverflowCheckedTensor(Shape.Map2D(channels, outwidth, outheight));
            OverflowCheckedTensor w_tensor = new OverflowCheckedTensor(Shape.Kernel2D(channels, 1, ksize, ksize));

            OverflowCheckedTensor x_tensor = new OverflowCheckedTensor(Shape.Map2D(channels, inwidth, inheight));

            ChannelwiseDeconvolution ope = new ChannelwiseDeconvolution(outwidth, outheight, channels, ksize, ksize);

            ope.Execute(y_tensor, w_tensor, x_tensor);

            Stopwatch sw = new Stopwatch();
            sw.Start();

            ope.Execute(y_tensor, w_tensor, x_tensor);
            ope.Execute(y_tensor, w_tensor, x_tensor);
            ope.Execute(y_tensor, w_tensor, x_tensor);
            ope.Execute(y_tensor, w_tensor, x_tensor);

            sw.Stop();

            Console.WriteLine($"{sw.ElapsedMilliseconds / 4} msec");
        }

        public static Map2D Reference(Map2D y, Filter2D w, int inw, int inh, int kwidth, int kheight) {
            int channels = w.InChannels, batch = y.Batch;
            int outw = inw - kwidth + 1, outh = inh - kheight + 1;

            if (y.Width != outw || y.Height != outh) {
                throw new ArgumentException("mismatch shape");
            }

            Map2D x = new Map2D(channels, inw, inh, batch);

            for (int kx, ky = 0; ky < kheight; ky++) {
                for (kx = 0; kx < kwidth; kx++) {
                    for (int th = 0; th < batch; th++) {
                        for (int ox, oy = 0; oy < outh; oy++) {
                            for (ox = 0; ox < outw; ox++) {
                                for (int ch = 0; ch < channels; ch++) {
                                    x[ch, kx + ox, ky + oy, th] += y[ch, ox, oy, th] * w[ch, 0, kx, ky];
                                }
                            }
                        }
                    }
                }
            }

            return x;
        }

        public static Map2D OptimizedReference(Map2D y, Filter2D w, int inw, int inh, int kwidth, int kheight) {
            int channels = w.InChannels, batch = y.Batch;
            int outw = inw - kwidth + 1, outh = inh - kheight + 1;

            if (y.Width != outw || y.Height != outh) {
                throw new ArgumentException("mismatch shape");
            }

            Map2D x = new Map2D(channels, inw, inh, batch);

            for (int kx, ky = 0; ky < kheight; ky++) {
                for (kx = 0; kx < kwidth; kx++) {
                    int outmap_offset = (kx + ky * inw) * channels;
                    int kernel_offset = (kx + ky * kwidth) * channels;

                    for (int th = 0; th < batch; th++) {
                        for (int ox, oy = 0; oy < outh; oy++) {
                            for (ox = 0; ox < outw; ox++) {
                                int inmap_idx = (ox + oy * outw) * channels + th * outw * outh * channels;
                                int outmap_idx = outmap_offset + (ox + oy * inw) * channels + th * inw * inh * channels;
                                int kernel_idx = kernel_offset;

                                for (int ch = 0; ch < channels; ch++) {
                                    x[outmap_idx] += y[inmap_idx] * w[kernel_idx];

                                    outmap_idx++;
                                    inmap_idx++;
                                    kernel_idx++;
                                }
                            }
                        }
                    }
                }
            }

            return x;
        }

        [TestMethod]
        public void ReferenceTest() {
            int channels = 7, kwidth = 3, kheight = 5, inwidth = 13, inheight = 17, batch = 2;
            int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1;

            float[] yval = (new float[outwidth * outheight * channels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * channels]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            Map2D y = new Map2D(channels, outwidth, outheight, batch, yval);
            Filter2D w = new Filter2D(channels, 1, kwidth, kheight, wval);

            Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight);

            float[] x_expect = {
                0.000000e+00f,  1.030000e-04f,  2.040000e-04f,  3.030000e-04f,  4.000000e-04f,  4.950000e-04f,  5.880000e-04f,
                0.000000e+00f,  9.600000e-05f,  1.900000e-04f,  2.820000e-04f,  3.720000e-04f,  4.600000e-04f,  5.460000e-04f,
                7.280000e-04f,  9.130000e-04f,  1.094000e-03f,  1.271000e-03f,  1.444000e-03f,  1.613000e-03f,  1.778000e-03f,
                6.790000e-04f,  7.680000e-04f,  8.550000e-04f,  9.400000e-04f,  1.023000e-03f,  1.104000e-03f,  1.183000e-03f,
                2.086000e-03f,  2.257000e-03f,  2.424000e-03f,  2.587000e-03f,  2.746000e-03f,  2.901000e-03f,  3.052000e-03f,
                1.358000e-03f,  1.440000e-03f,  1.520000e-03f,  1.598000e-03f,  1.674000e-03f,  1.748000e-03f,  1.820000e-03f,
                3.444000e-03f,  3.601000e-03f,  3.754000e-03f,  3.903000e-03f,  4.048000e-03f,  4.189000e-03f,  4.326000e-03f,
                2.037000e-03f,  2.112000e-03f,  2.185000e-03f,  2.256000e-03f,  2.325000e-03f,  2.392000e-03f,  2.457000e-03f,
                4.802000e-03f,  4.945000e-03f,  5.084000e-03f,  5.219000e-03f,  5.350000e-03f,  5.477000e-03f,  5.600000e-03f,
                2.716000e-03f,  2.784000e-03f,  2.850000e-03f,  2.914000e-03f,  2.976000e-03f,  3.036000e-03f,  3.094000e-03f,
                6.160000e-03f,  6.289000e-03f,  6.414000e-03f,  6.535000e-03f,  6.652000e-03f,  6.765000e-03f,  6.874000e-03f,
                3.395000e-03f,  3.456000e-03f,  3.515000e-03f,  3.572000e-03f,  3.627000e-03f,  3.680000e-03f,  3.731000e-03f,
                3.150000e-03f,  3.204000e-03f,  3.256000e-03f,  3.306000e-03f,  3.354000e-03f,  3.400000e-03f,  3.444000e-03f,
                0.000000e+00f,  8.200000e-05f,  1.620000e-04f,  2.400000e-04f,  3.160000e-04f,  3.900000e-04f,  4.620000e-04f,
                0.000000e+00f,  7.500000e-05f,  1.480000e-04f,  2.190000e-04f,  2.880000e-04f,  3.550000e-04f,  4.200000e-04f,
                5.810000e-04f,  7.240000e-04f,  8.630000e-04f,  9.980000e-04f,  1.129000e-03f,  1.256000e-03f,  1.379000e-03f,
                5.320000e-04f,  6.000000e-04f,  6.660000e-04f,  7.300000e-04f,  7.920000e-04f,  8.520000e-04f,  9.100000e-04f,
                1.645000e-03f,  1.774000e-03f,  1.899000e-03f,  2.020000e-03f,  2.137000e-03f,  2.250000e-03f,  2.359000e-03f,
                1.064000e-03f,  1.125000e-03f,  1.184000e-03f,  1.241000e-03f,  1.296000e-03f,  1.349000e-03f,  1.400000e-03f,
                2.709000e-03f,  2.824000e-03f,  2.935000e-03f,  3.042000e-03f,  3.145000e-03f,  3.244000e-03f,  3.339000e-03f,
                1.596000e-03f,  1.650000e-03f,  1.702000e-03f,  1.752000e-03f,  1.800000e-03f,  1.846000e-03f,  1.890000e-03f,
                3.773000e-03f,  3.874000e-03f,  3.971000e-03f,  4.064000e-03f,  4.153000e-03f,  4.238000e-03f,  4.319000e-03f,
                2.128000e-03f,  2.175000e-03f,  2.220000e-03f,  2.263000e-03f,  2.304000e-03f,  2.343000e-03f,  2.380000e-03f,
                4.837000e-03f,  4.924000e-03f,  5.007000e-03f,  5.086000e-03f,  5.161000e-03f,  5.232000e-03f,  5.299000e-03f,
                2.660000e-03f,  2.700000e-03f,  2.738000e-03f,  2.774000e-03f,  2.808000e-03f,  2.840000e-03f,  2.870000e-03f,
                2.415000e-03f,  2.448000e-03f,  2.479000e-03f,  2.508000e-03f,  2.535000e-03f,  2.560000e-03f,  2.583000e-03f,
                4.368000e-03f,  4.490000e-03f,  4.608000e-03f,  4.722000e-03f,  4.832000e-03f,  4.938000e-03f,  5.040000e-03f,
                4.074000e-03f,  4.182000e-03f,  4.286000e-03f,  4.386000e-03f,  4.482000e-03f,  4.574000e-03f,  4.662000e-03f,
                9.310000e-03f,  9.512000e-03f,  9.706000e-03f,  9.892000e-03f,  1.007000e-02f,  1.024000e-02f,  1.040200e-02f,
                5.138000e-03f,  5.232000e-03f,  5.322000e-03f,  5.408000e-03f,  5.490000e-03f,  5.568000e-03f,  5.642000e-03f,
                1.143800e-02f,  1.161200e-02f,  1.177800e-02f,  1.193600e-02f,  1.208600e-02f,  1.222800e-02f,  1.236200e-02f,
                6.202000e-03f,  6.282000e-03f,  6.358000e-03f,  6.430000e-03f,  6.498000e-03f,  6.562000e-03f,  6.622000e-03f,
                1.356600e-02f,  1.371200e-02f,  1.385000e-02f,  1.398000e-02f,  1.410200e-02f,  1.421600e-02f,  1.432200e-02f,
                7.266000e-03f,  7.332000e-03f,  7.394000e-03f,  7.452000e-03f,  7.506000e-03f,  7.556000e-03f,  7.602000e-03f,
                1.569400e-02f,  1.581200e-02f,  1.592200e-02f,  1.602400e-02f,  1.611800e-02f,  1.620400e-02f,  1.628200e-02f,
                8.330000e-03f,  8.382000e-03f,  8.430000e-03f,  8.474000e-03f,  8.514000e-03f,  8.550000e-03f,  8.582000e-03f,
                1.782200e-02f,  1.791200e-02f,  1.799400e-02f,  1.806800e-02f,  1.813400e-02f,  1.819200e-02f,  1.824200e-02f,
                9.394000e-03f,  9.432000e-03f,  9.466000e-03f,  9.496000e-03f,  9.522000e-03f,  9.544000e-03f,  9.562000e-03f,
                8.610000e-03f,  8.634000e-03f,  8.654000e-03f,  8.670000e-03f,  8.682000e-03f,  8.690000e-03f,  8.694000e-03f,
                3.486000e-03f,  3.566000e-03f,  3.642000e-03f,  3.714000e-03f,  3.782000e-03f,  3.846000e-03f,  3.906000e-03f,
                3.192000e-03f,  3.258000e-03f,  3.320000e-03f,  3.378000e-03f,  3.432000e-03f,  3.482000e-03f,  3.528000e-03f,
                7.252000e-03f,  7.370000e-03f,  7.480000e-03f,  7.582000e-03f,  7.676000e-03f,  7.762000e-03f,  7.840000e-03f,
                3.962000e-03f,  4.014000e-03f,  4.062000e-03f,  4.106000e-03f,  4.146000e-03f,  4.182000e-03f,  4.214000e-03f,
                8.792000e-03f,  8.882000e-03f,  8.964000e-03f,  9.038000e-03f,  9.104000e-03f,  9.162000e-03f,  9.212000e-03f,
                4.732000e-03f,  4.770000e-03f,  4.804000e-03f,  4.834000e-03f,  4.860000e-03f,  4.882000e-03f,  4.900000e-03f,
                1.033200e-02f,  1.039400e-02f,  1.044800e-02f,  1.049400e-02f,  1.053200e-02f,  1.056200e-02f,  1.058400e-02f,
                5.502000e-03f,  5.526000e-03f,  5.546000e-03f,  5.562000e-03f,  5.574000e-03f,  5.582000e-03f,  5.586000e-03f,
                1.187200e-02f,  1.190600e-02f,  1.193200e-02f,  1.195000e-02f,  1.196000e-02f,  1.196200e-02f,  1.195600e-02f,
                6.272000e-03f,  6.282000e-03f,  6.288000e-03f,  6.290000e-03f,  6.288000e-03f,  6.282000e-03f,  6.272000e-03f,
                1.341200e-02f,  1.341800e-02f,  1.341600e-02f,  1.340600e-02f,  1.338800e-02f,  1.336200e-02f,  1.332800e-02f,
                7.042000e-03f,  7.038000e-03f,  7.030000e-03f,  7.018000e-03f,  7.002000e-03f,  6.982000e-03f,  6.958000e-03f,
                6.258000e-03f,  6.240000e-03f,  6.218000e-03f,  6.192000e-03f,  6.162000e-03f,  6.128000e-03f,  6.090000e-03f,
                1.134000e-02f,  1.139700e-02f,  1.144800e-02f,  1.149300e-02f,  1.153200e-02f,  1.156500e-02f,  1.159200e-02f,
                1.045800e-02f,  1.049400e-02f,  1.052400e-02f,  1.054800e-02f,  1.056600e-02f,  1.057800e-02f,  1.058400e-02f,
                2.221800e-02f,  2.226900e-02f,  2.230800e-02f,  2.233500e-02f,  2.235000e-02f,  2.235300e-02f,  2.234400e-02f,
                1.161300e-02f,  1.162800e-02f,  1.163700e-02f,  1.164000e-02f,  1.163700e-02f,  1.162800e-02f,  1.161300e-02f,
                2.452800e-02f,  2.453700e-02f,  2.453400e-02f,  2.451900e-02f,  2.449200e-02f,  2.445300e-02f,  2.440200e-02f,
                1.276800e-02f,  1.276200e-02f,  1.275000e-02f,  1.273200e-02f,  1.270800e-02f,  1.267800e-02f,  1.264200e-02f,
                2.683800e-02f,  2.680500e-02f,  2.676000e-02f,  2.670300e-02f,  2.663400e-02f,  2.655300e-02f,  2.646000e-02f,
                1.392300e-02f,  1.389600e-02f,  1.386300e-02f,  1.382400e-02f,  1.377900e-02f,  1.372800e-02f,  1.367100e-02f,
                2.914800e-02f,  2.907300e-02f,  2.898600e-02f,  2.888700e-02f,  2.877600e-02f,  2.865300e-02f,  2.851800e-02f,
                1.507800e-02f,  1.503000e-02f,  1.497600e-02f,  1.491600e-02f,  1.485000e-02f,  1.477800e-02f,  1.470000e-02f,
                3.145800e-02f,  3.134100e-02f,  3.121200e-02f,  3.107100e-02f,  3.091800e-02f,  3.075300e-02f,  3.057600e-02f,
                1.623300e-02f,  1.616400e-02f,  1.608900e-02f,  1.600800e-02f,  1.592100e-02f,  1.582800e-02f,  1.572900e-02f,
                1.461600e-02f,  1.452600e-02f,  1.443000e-02f,  1.432800e-02f,  1.422000e-02f,  1.410600e-02f,  1.398600e-02f,
                8.694000e-03f,  8.690000e-03f,  8.682000e-03f,  8.670000e-03f,  8.654000e-03f,  8.634000e-03f,  8.610000e-03f,
                7.812000e-03f,  7.794000e-03f,  7.772000e-03f,  7.746000e-03f,  7.716000e-03f,  7.682000e-03f,  7.644000e-03f,
                1.649200e-02f,  1.644200e-02f,  1.638400e-02f,  1.631800e-02f,  1.624400e-02f,  1.616200e-02f,  1.607200e-02f,
                8.582000e-03f,  8.550000e-03f,  8.514000e-03f,  8.474000e-03f,  8.430000e-03f,  8.382000e-03f,  8.330000e-03f,
                1.803200e-02f,  1.795400e-02f,  1.786800e-02f,  1.777400e-02f,  1.767200e-02f,  1.756200e-02f,  1.744400e-02f,
                9.352000e-03f,  9.306000e-03f,  9.256000e-03f,  9.202000e-03f,  9.144000e-03f,  9.082000e-03f,  9.016000e-03f,
                1.957200e-02f,  1.946600e-02f,  1.935200e-02f,  1.923000e-02f,  1.910000e-02f,  1.896200e-02f,  1.881600e-02f,
                1.012200e-02f,  1.006200e-02f,  9.998000e-03f,  9.930000e-03f,  9.858000e-03f,  9.782000e-03f,  9.702000e-03f,
                2.111200e-02f,  2.097800e-02f,  2.083600e-02f,  2.068600e-02f,  2.052800e-02f,  2.036200e-02f,  2.018800e-02f,
                1.089200e-02f,  1.081800e-02f,  1.074000e-02f,  1.065800e-02f,  1.057200e-02f,  1.048200e-02f,  1.038800e-02f,
                2.265200e-02f,  2.249000e-02f,  2.232000e-02f,  2.214200e-02f,  2.195600e-02f,  2.176200e-02f,  2.156000e-02f,
                1.166200e-02f,  1.157400e-02f,  1.148200e-02f,  1.138600e-02f,  1.128600e-02f,  1.118200e-02f,  1.107400e-02f,
                1.029000e-02f,  1.018800e-02f,  1.008200e-02f,  9.972000e-03f,  9.858000e-03f,  9.740000e-03f,  9.618000e-03f,
                1.915200e-02f,  1.908300e-02f,  1.900800e-02f,  1.892700e-02f,  1.884000e-02f,  1.874700e-02f,  1.864800e-02f,
                1.738800e-02f,  1.729800e-02f,  1.720200e-02f,  1.710000e-02f,  1.699200e-02f,  1.687800e-02f,  1.675800e-02f,
                3.607800e-02f,  3.587700e-02f,  3.566400e-02f,  3.543900e-02f,  3.520200e-02f,  3.495300e-02f,  3.469200e-02f,
                1.854300e-02f,  1.843200e-02f,  1.831500e-02f,  1.819200e-02f,  1.806300e-02f,  1.792800e-02f,  1.778700e-02f,
                3.838800e-02f,  3.814500e-02f,  3.789000e-02f,  3.762300e-02f,  3.734400e-02f,  3.705300e-02f,  3.675000e-02f,
                1.969800e-02f,  1.956600e-02f,  1.942800e-02f,  1.928400e-02f,  1.913400e-02f,  1.897800e-02f,  1.881600e-02f,
                4.069800e-02f,  4.041300e-02f,  4.011600e-02f,  3.980700e-02f,  3.948600e-02f,  3.915300e-02f,  3.880800e-02f,
                2.085300e-02f,  2.070000e-02f,  2.054100e-02f,  2.037600e-02f,  2.020500e-02f,  2.002800e-02f,  1.984500e-02f,
                4.300800e-02f,  4.268100e-02f,  4.234200e-02f,  4.199100e-02f,  4.162800e-02f,  4.125300e-02f,  4.086600e-02f,
                2.200800e-02f,  2.183400e-02f,  2.165400e-02f,  2.146800e-02f,  2.127600e-02f,  2.107800e-02f,  2.087400e-02f,
                4.531800e-02f,  4.494900e-02f,  4.456800e-02f,  4.417500e-02f,  4.377000e-02f,  4.335300e-02f,  4.292400e-02f,
                2.316300e-02f,  2.296800e-02f,  2.276700e-02f,  2.256000e-02f,  2.234700e-02f,  2.212800e-02f,  2.190300e-02f,
                2.066400e-02f,  2.044800e-02f,  2.022600e-02f,  1.999800e-02f,  1.976400e-02f,  1.952400e-02f,  1.927800e-02f,
                1.390200e-02f,  1.381400e-02f,  1.372200e-02f,  1.362600e-02f,  1.352600e-02f,  1.342200e-02f,  1.331400e-02f,
                1.243200e-02f,  1.233000e-02f,  1.222400e-02f,  1.211400e-02f,  1.200000e-02f,  1.188200e-02f,  1.176000e-02f,
                2.573200e-02f,  2.551400e-02f,  2.528800e-02f,  2.505400e-02f,  2.481200e-02f,  2.456200e-02f,  2.430400e-02f,
                1.320200e-02f,  1.308600e-02f,  1.296600e-02f,  1.284200e-02f,  1.271400e-02f,  1.258200e-02f,  1.244600e-02f,
                2.727200e-02f,  2.702600e-02f,  2.677200e-02f,  2.651000e-02f,  2.624000e-02f,  2.596200e-02f,  2.567600e-02f,
                1.397200e-02f,  1.384200e-02f,  1.370800e-02f,  1.357000e-02f,  1.342800e-02f,  1.328200e-02f,  1.313200e-02f,
                2.881200e-02f,  2.853800e-02f,  2.825600e-02f,  2.796600e-02f,  2.766800e-02f,  2.736200e-02f,  2.704800e-02f,
                1.474200e-02f,  1.459800e-02f,  1.445000e-02f,  1.429800e-02f,  1.414200e-02f,  1.398200e-02f,  1.381800e-02f,
                3.035200e-02f,  3.005000e-02f,  2.974000e-02f,  2.942200e-02f,  2.909600e-02f,  2.876200e-02f,  2.842000e-02f,
                1.551200e-02f,  1.535400e-02f,  1.519200e-02f,  1.502600e-02f,  1.485600e-02f,  1.468200e-02f,  1.450400e-02f,
                3.189200e-02f,  3.156200e-02f,  3.122400e-02f,  3.087800e-02f,  3.052400e-02f,  3.016200e-02f,  2.979200e-02f,
                1.628200e-02f,  1.611000e-02f,  1.593400e-02f,  1.575400e-02f,  1.557000e-02f,  1.538200e-02f,  1.519000e-02f,
                1.432200e-02f,  1.413600e-02f,  1.394600e-02f,  1.375200e-02f,  1.355400e-02f,  1.335200e-02f,  1.314600e-02f,
                2.696400e-02f,  2.676900e-02f,  2.656800e-02f,  2.636100e-02f,  2.614800e-02f,  2.592900e-02f,  2.570400e-02f,
                2.431800e-02f,  2.410200e-02f,  2.388000e-02f,  2.365200e-02f,  2.341800e-02f,  2.317800e-02f,  2.293200e-02f,
                4.993800e-02f,  4.948500e-02f,  4.902000e-02f,  4.854300e-02f,  4.805400e-02f,  4.755300e-02f,  4.704000e-02f,
                2.547300e-02f,  2.523600e-02f,  2.499300e-02f,  2.474400e-02f,  2.448900e-02f,  2.422800e-02f,  2.396100e-02f,
                5.224800e-02f,  5.175300e-02f,  5.124600e-02f,  5.072700e-02f,  5.019600e-02f,  4.965300e-02f,  4.909800e-02f,
                2.662800e-02f,  2.637000e-02f,  2.610600e-02f,  2.583600e-02f,  2.556000e-02f,  2.527800e-02f,  2.499000e-02f,
                5.455800e-02f,  5.402100e-02f,  5.347200e-02f,  5.291100e-02f,  5.233800e-02f,  5.175300e-02f,  5.115600e-02f,
                2.778300e-02f,  2.750400e-02f,  2.721900e-02f,  2.692800e-02f,  2.663100e-02f,  2.632800e-02f,  2.601900e-02f,
                5.686800e-02f,  5.628900e-02f,  5.569800e-02f,  5.509500e-02f,  5.448000e-02f,  5.385300e-02f,  5.321400e-02f,
                2.893800e-02f,  2.863800e-02f,  2.833200e-02f,  2.802000e-02f,  2.770200e-02f,  2.737800e-02f,  2.704800e-02f,
                5.917800e-02f,  5.855700e-02f,  5.792400e-02f,  5.727900e-02f,  5.662200e-02f,  5.595300e-02f,  5.527200e-02f,
                3.009300e-02f,  2.977200e-02f,  2.944500e-02f,  2.911200e-02f,  2.877300e-02f,  2.842800e-02f,  2.807700e-02f,
                2.671200e-02f,  2.637000e-02f,  2.602200e-02f,  2.566800e-02f,  2.530800e-02f,  2.494200e-02f,  2.457000e-02f,
                1.911000e-02f,  1.893800e-02f,  1.876200e-02f,  1.858200e-02f,  1.839800e-02f,  1.821000e-02f,  1.801800e-02f,
                1.705200e-02f,  1.686600e-02f,  1.667600e-02f,  1.648200e-02f,  1.628400e-02f,  1.608200e-02f,  1.587600e-02f,
                3.497200e-02f,  3.458600e-02f,  3.419200e-02f,  3.379000e-02f,  3.338000e-02f,  3.296200e-02f,  3.253600e-02f,
                1.782200e-02f,  1.762200e-02f,  1.741800e-02f,  1.721000e-02f,  1.699800e-02f,  1.678200e-02f,  1.656200e-02f,
                3.651200e-02f,  3.609800e-02f,  3.567600e-02f,  3.524600e-02f,  3.480800e-02f,  3.436200e-02f,  3.390800e-02f,
                1.859200e-02f,  1.837800e-02f,  1.816000e-02f,  1.793800e-02f,  1.771200e-02f,  1.748200e-02f,  1.724800e-02f,
                3.805200e-02f,  3.761000e-02f,  3.716000e-02f,  3.670200e-02f,  3.623600e-02f,  3.576200e-02f,  3.528000e-02f,
                1.936200e-02f,  1.913400e-02f,  1.890200e-02f,  1.866600e-02f,  1.842600e-02f,  1.818200e-02f,  1.793400e-02f,
                3.959200e-02f,  3.912200e-02f,  3.864400e-02f,  3.815800e-02f,  3.766400e-02f,  3.716200e-02f,  3.665200e-02f,
                2.013200e-02f,  1.989000e-02f,  1.964400e-02f,  1.939400e-02f,  1.914000e-02f,  1.888200e-02f,  1.862000e-02f,
                4.113200e-02f,  4.063400e-02f,  4.012800e-02f,  3.961400e-02f,  3.909200e-02f,  3.856200e-02f,  3.802400e-02f,
                2.090200e-02f,  2.064600e-02f,  2.038600e-02f,  2.012200e-02f,  1.985400e-02f,  1.958200e-02f,  1.930600e-02f,
                1.835400e-02f,  1.808400e-02f,  1.781000e-02f,  1.753200e-02f,  1.725000e-02f,  1.696400e-02f,  1.667400e-02f,
                3.477600e-02f,  3.445500e-02f,  3.412800e-02f,  3.379500e-02f,  3.345600e-02f,  3.311100e-02f,  3.276000e-02f,
                3.124800e-02f,  3.090600e-02f,  3.055800e-02f,  3.020400e-02f,  2.984400e-02f,  2.947800e-02f,  2.910600e-02f,
                6.379800e-02f,  6.309300e-02f,  6.237600e-02f,  6.164700e-02f,  6.090600e-02f,  6.015300e-02f,  5.938800e-02f,
                3.240300e-02f,  3.204000e-02f,  3.167100e-02f,  3.129600e-02f,  3.091500e-02f,  3.052800e-02f,  3.013500e-02f,
                6.610800e-02f,  6.536100e-02f,  6.460200e-02f,  6.383100e-02f,  6.304800e-02f,  6.225300e-02f,  6.144600e-02f,
                3.355800e-02f,  3.317400e-02f,  3.278400e-02f,  3.238800e-02f,  3.198600e-02f,  3.157800e-02f,  3.116400e-02f,
                6.841800e-02f,  6.762900e-02f,  6.682800e-02f,  6.601500e-02f,  6.519000e-02f,  6.435300e-02f,  6.350400e-02f,
                3.471300e-02f,  3.430800e-02f,  3.389700e-02f,  3.348000e-02f,  3.305700e-02f,  3.262800e-02f,  3.219300e-02f,
                7.072800e-02f,  6.989700e-02f,  6.905400e-02f,  6.819900e-02f,  6.733200e-02f,  6.645300e-02f,  6.556200e-02f,
                3.586800e-02f,  3.544200e-02f,  3.501000e-02f,  3.457200e-02f,  3.412800e-02f,  3.367800e-02f,  3.322200e-02f,
                7.303800e-02f,  7.216500e-02f,  7.128000e-02f,  7.038300e-02f,  6.947400e-02f,  6.855300e-02f,  6.762000e-02f,
                3.702300e-02f,  3.657600e-02f,  3.612300e-02f,  3.566400e-02f,  3.519900e-02f,  3.472800e-02f,  3.425100e-02f,
                3.276000e-02f,  3.229200e-02f,  3.181800e-02f,  3.133800e-02f,  3.085200e-02f,  3.036000e-02f,  2.986200e-02f,
                2.431800e-02f,  2.406200e-02f,  2.380200e-02f,  2.353800e-02f,  2.327000e-02f,  2.299800e-02f,  2.272200e-02f,
                2.167200e-02f,  2.140200e-02f,  2.112800e-02f,  2.085000e-02f,  2.056800e-02f,  2.028200e-02f,  1.999200e-02f,
                4.421200e-02f,  4.365800e-02f,  4.309600e-02f,  4.252600e-02f,  4.194800e-02f,  4.136200e-02f,  4.076800e-02f,
                2.244200e-02f,  2.215800e-02f,  2.187000e-02f,  2.157800e-02f,  2.128200e-02f,  2.098200e-02f,  2.067800e-02f,
                4.575200e-02f,  4.517000e-02f,  4.458000e-02f,  4.398200e-02f,  4.337600e-02f,  4.276200e-02f,  4.214000e-02f,
                2.321200e-02f,  2.291400e-02f,  2.261200e-02f,  2.230600e-02f,  2.199600e-02f,  2.168200e-02f,  2.136400e-02f,
                4.729200e-02f,  4.668200e-02f,  4.606400e-02f,  4.543800e-02f,  4.480400e-02f,  4.416200e-02f,  4.351200e-02f,
                2.398200e-02f,  2.367000e-02f,  2.335400e-02f,  2.303400e-02f,  2.271000e-02f,  2.238200e-02f,  2.205000e-02f,
                4.883200e-02f,  4.819400e-02f,  4.754800e-02f,  4.689400e-02f,  4.623200e-02f,  4.556200e-02f,  4.488400e-02f,
                2.475200e-02f,  2.442600e-02f,  2.409600e-02f,  2.376200e-02f,  2.342400e-02f,  2.308200e-02f,  2.273600e-02f,
                5.037200e-02f,  4.970600e-02f,  4.903200e-02f,  4.835000e-02f,  4.766000e-02f,  4.696200e-02f,  4.625600e-02f,
                2.552200e-02f,  2.518200e-02f,  2.483800e-02f,  2.449000e-02f,  2.413800e-02f,  2.378200e-02f,  2.342200e-02f,
                2.238600e-02f,  2.203200e-02f,  2.167400e-02f,  2.131200e-02f,  2.094600e-02f,  2.057600e-02f,  2.020200e-02f,
                4.258800e-02f,  4.214100e-02f,  4.168800e-02f,  4.122900e-02f,  4.076400e-02f,  4.029300e-02f,  3.981600e-02f,
                3.817800e-02f,  3.771000e-02f,  3.723600e-02f,  3.675600e-02f,  3.627000e-02f,  3.577800e-02f,  3.528000e-02f,
                7.765800e-02f,  7.670100e-02f,  7.573200e-02f,  7.475100e-02f,  7.375800e-02f,  7.275300e-02f,  7.173600e-02f,
                3.933300e-02f,  3.884400e-02f,  3.834900e-02f,  3.784800e-02f,  3.734100e-02f,  3.682800e-02f,  3.630900e-02f,
                7.996800e-02f,  7.896900e-02f,  7.795800e-02f,  7.693500e-02f,  7.590000e-02f,  7.485300e-02f,  7.379400e-02f,
                4.048800e-02f,  3.997800e-02f,  3.946200e-02f,  3.894000e-02f,  3.841200e-02f,  3.787800e-02f,  3.733800e-02f,
                8.227800e-02f,  8.123700e-02f,  8.018400e-02f,  7.911900e-02f,  7.804200e-02f,  7.695300e-02f,  7.585200e-02f,
                4.164300e-02f,  4.111200e-02f,  4.057500e-02f,  4.003200e-02f,  3.948300e-02f,  3.892800e-02f,  3.836700e-02f,
                8.458800e-02f,  8.350500e-02f,  8.241000e-02f,  8.130300e-02f,  8.018400e-02f,  7.905300e-02f,  7.791000e-02f,
                4.279800e-02f,  4.224600e-02f,  4.168800e-02f,  4.112400e-02f,  4.055400e-02f,  3.997800e-02f,  3.939600e-02f,
                8.689800e-02f,  8.577300e-02f,  8.463600e-02f,  8.348700e-02f,  8.232600e-02f,  8.115300e-02f,  7.996800e-02f,
                4.395300e-02f,  4.338000e-02f,  4.280100e-02f,  4.221600e-02f,  4.162500e-02f,  4.102800e-02f,  4.042500e-02f,
                3.880800e-02f,  3.821400e-02f,  3.761400e-02f,  3.700800e-02f,  3.639600e-02f,  3.577800e-02f,  3.515400e-02f,
                2.952600e-02f,  2.918600e-02f,  2.884200e-02f,  2.849400e-02f,  2.814200e-02f,  2.778600e-02f,  2.742600e-02f,
                2.629200e-02f,  2.593800e-02f,  2.558000e-02f,  2.521800e-02f,  2.485200e-02f,  2.448200e-02f,  2.410800e-02f,
                5.345200e-02f,  5.273000e-02f,  5.200000e-02f,  5.126200e-02f,  5.051600e-02f,  4.976200e-02f,  4.900000e-02f,
                2.706200e-02f,  2.669400e-02f,  2.632200e-02f,  2.594600e-02f,  2.556600e-02f,  2.518200e-02f,  2.479400e-02f,
                5.499200e-02f,  5.424200e-02f,  5.348400e-02f,  5.271800e-02f,  5.194400e-02f,  5.116200e-02f,  5.037200e-02f,
                2.783200e-02f,  2.745000e-02f,  2.706400e-02f,  2.667400e-02f,  2.628000e-02f,  2.588200e-02f,  2.548000e-02f,
                5.653200e-02f,  5.575400e-02f,  5.496800e-02f,  5.417400e-02f,  5.337200e-02f,  5.256200e-02f,  5.174400e-02f,
                2.860200e-02f,  2.820600e-02f,  2.780600e-02f,  2.740200e-02f,  2.699400e-02f,  2.658200e-02f,  2.616600e-02f,
                5.807200e-02f,  5.726600e-02f,  5.645200e-02f,  5.563000e-02f,  5.480000e-02f,  5.396200e-02f,  5.311600e-02f,
                2.937200e-02f,  2.896200e-02f,  2.854800e-02f,  2.813000e-02f,  2.770800e-02f,  2.728200e-02f,  2.685200e-02f,
                5.961200e-02f,  5.877800e-02f,  5.793600e-02f,  5.708600e-02f,  5.622800e-02f,  5.536200e-02f,  5.448800e-02f,
                3.014200e-02f,  2.971800e-02f,  2.929000e-02f,  2.885800e-02f,  2.842200e-02f,  2.798200e-02f,  2.753800e-02f,
                2.641800e-02f,  2.598000e-02f,  2.553800e-02f,  2.509200e-02f,  2.464200e-02f,  2.418800e-02f,  2.373000e-02f,
                1.982400e-02f,  1.944200e-02f,  1.905600e-02f,  1.866600e-02f,  1.827200e-02f,  1.787400e-02f,  1.747200e-02f,
                1.659000e-02f,  1.619400e-02f,  1.579400e-02f,  1.539000e-02f,  1.498200e-02f,  1.457000e-02f,  1.415400e-02f,
                3.375400e-02f,  3.294800e-02f,  3.213400e-02f,  3.131200e-02f,  3.048200e-02f,  2.964400e-02f,  2.879800e-02f,
                1.706600e-02f,  1.665600e-02f,  1.624200e-02f,  1.582400e-02f,  1.540200e-02f,  1.497600e-02f,  1.454600e-02f,
                3.470600e-02f,  3.387200e-02f,  3.303000e-02f,  3.218000e-02f,  3.132200e-02f,  3.045600e-02f,  2.958200e-02f,
                1.754200e-02f,  1.711800e-02f,  1.669000e-02f,  1.625800e-02f,  1.582200e-02f,  1.538200e-02f,  1.493800e-02f,
                3.565800e-02f,  3.479600e-02f,  3.392600e-02f,  3.304800e-02f,  3.216200e-02f,  3.126800e-02f,  3.036600e-02f,
                1.801800e-02f,  1.758000e-02f,  1.713800e-02f,  1.669200e-02f,  1.624200e-02f,  1.578800e-02f,  1.533000e-02f,
                3.661000e-02f,  3.572000e-02f,  3.482200e-02f,  3.391600e-02f,  3.300200e-02f,  3.208000e-02f,  3.115000e-02f,
                1.849400e-02f,  1.804200e-02f,  1.758600e-02f,  1.712600e-02f,  1.666200e-02f,  1.619400e-02f,  1.572200e-02f,
                3.756200e-02f,  3.664400e-02f,  3.571800e-02f,  3.478400e-02f,  3.384200e-02f,  3.289200e-02f,  3.193400e-02f,
                1.897000e-02f,  1.850400e-02f,  1.803400e-02f,  1.756000e-02f,  1.708200e-02f,  1.660000e-02f,  1.611400e-02f,
                1.524600e-02f,  1.476600e-02f,  1.428200e-02f,  1.379400e-02f,  1.330200e-02f,  1.280600e-02f,  1.230600e-02f,
                1.033200e-02f,  1.012000e-02f,  9.906000e-03f,  9.690000e-03f,  9.472000e-03f,  9.252000e-03f,  9.030000e-03f,
                8.568000e-03f,  8.349000e-03f,  8.128000e-03f,  7.905000e-03f,  7.680000e-03f,  7.453000e-03f,  7.224000e-03f,
                1.742300e-02f,  1.697800e-02f,  1.652900e-02f,  1.607600e-02f,  1.561900e-02f,  1.515800e-02f,  1.469300e-02f,
                8.806000e-03f,  8.580000e-03f,  8.352000e-03f,  8.122000e-03f,  7.890000e-03f,  7.656000e-03f,  7.420000e-03f,
                1.789900e-02f,  1.744000e-02f,  1.697700e-02f,  1.651000e-02f,  1.603900e-02f,  1.556400e-02f,  1.508500e-02f,
                9.044000e-03f,  8.811000e-03f,  8.576000e-03f,  8.339000e-03f,  8.100000e-03f,  7.859000e-03f,  7.616000e-03f,
                1.837500e-02f,  1.790200e-02f,  1.742500e-02f,  1.694400e-02f,  1.645900e-02f,  1.597000e-02f,  1.547700e-02f,
                9.282000e-03f,  9.042000e-03f,  8.800000e-03f,  8.556000e-03f,  8.310000e-03f,  8.062000e-03f,  7.812000e-03f,
                1.885100e-02f,  1.836400e-02f,  1.787300e-02f,  1.737800e-02f,  1.687900e-02f,  1.637600e-02f,  1.586900e-02f,
                9.520000e-03f,  9.273000e-03f,  9.024000e-03f,  8.773000e-03f,  8.520000e-03f,  8.265000e-03f,  8.008000e-03f,
                1.932700e-02f,  1.882600e-02f,  1.832100e-02f,  1.781200e-02f,  1.729900e-02f,  1.678200e-02f,  1.626100e-02f,
                9.758000e-03f,  9.504000e-03f,  9.248000e-03f,  8.990000e-03f,  8.730000e-03f,  8.468000e-03f,  8.204000e-03f,
                7.749000e-03f,  7.488000e-03f,  7.225000e-03f,  6.960000e-03f,  6.693000e-03f,  6.424000e-03f,  6.153000e-03f,
                5.040000e-03f,  4.807000e-03f,  4.572000e-03f,  4.335000e-03f,  4.096000e-03f,  3.855000e-03f,  3.612000e-03f,
                3.276000e-03f,  3.036000e-03f,  2.794000e-03f,  2.550000e-03f,  2.304000e-03f,  2.056000e-03f,  1.806000e-03f,
                6.692000e-03f,  6.205000e-03f,  5.714000e-03f,  5.219000e-03f,  4.720000e-03f,  4.217000e-03f,  3.710000e-03f,
                3.367000e-03f,  3.120000e-03f,  2.871000e-03f,  2.620000e-03f,  2.367000e-03f,  2.112000e-03f,  1.855000e-03f,
                6.874000e-03f,  6.373000e-03f,  5.868000e-03f,  5.359000e-03f,  4.846000e-03f,  4.329000e-03f,  3.808000e-03f,
                3.458000e-03f,  3.204000e-03f,  2.948000e-03f,  2.690000e-03f,  2.430000e-03f,  2.168000e-03f,  1.904000e-03f,
                7.056000e-03f,  6.541000e-03f,  6.022000e-03f,  5.499000e-03f,  4.972000e-03f,  4.441000e-03f,  3.906000e-03f,
                3.549000e-03f,  3.288000e-03f,  3.025000e-03f,  2.760000e-03f,  2.493000e-03f,  2.224000e-03f,  1.953000e-03f,
                7.238000e-03f,  6.709000e-03f,  6.176000e-03f,  5.639000e-03f,  5.098000e-03f,  4.553000e-03f,  4.004000e-03f,
                3.640000e-03f,  3.372000e-03f,  3.102000e-03f,  2.830000e-03f,  2.556000e-03f,  2.280000e-03f,  2.002000e-03f,
                7.420000e-03f,  6.877000e-03f,  6.330000e-03f,  5.779000e-03f,  5.224000e-03f,  4.665000e-03f,  4.102000e-03f,
                3.731000e-03f,  3.456000e-03f,  3.179000e-03f,  2.900000e-03f,  2.619000e-03f,  2.336000e-03f,  2.051000e-03f,
                1.722000e-03f,  1.440000e-03f,  1.156000e-03f,  8.700000e-04f,  5.820000e-04f,  2.920000e-04f,  0.000000e+00f,
                3.057600e-02f,  3.038500e-02f,  3.019200e-02f,  2.999700e-02f,  2.980000e-02f,  2.960100e-02f,  2.940000e-02f,
                2.851800e-02f,  2.832000e-02f,  2.812000e-02f,  2.791800e-02f,  2.771400e-02f,  2.750800e-02f,  2.730000e-02f,
                5.776400e-02f,  5.736100e-02f,  5.695400e-02f,  5.654300e-02f,  5.612800e-02f,  5.570900e-02f,  5.528600e-02f,
                2.919700e-02f,  2.899200e-02f,  2.878500e-02f,  2.857600e-02f,  2.836500e-02f,  2.815200e-02f,  2.793700e-02f,
                5.912200e-02f,  5.870500e-02f,  5.828400e-02f,  5.785900e-02f,  5.743000e-02f,  5.699700e-02f,  5.656000e-02f,
                2.987600e-02f,  2.966400e-02f,  2.945000e-02f,  2.923400e-02f,  2.901600e-02f,  2.879600e-02f,  2.857400e-02f,
                6.048000e-02f,  6.004900e-02f,  5.961400e-02f,  5.917500e-02f,  5.873200e-02f,  5.828500e-02f,  5.783400e-02f,
                3.055500e-02f,  3.033600e-02f,  3.011500e-02f,  2.989200e-02f,  2.966700e-02f,  2.944000e-02f,  2.921100e-02f,
                6.183800e-02f,  6.139300e-02f,  6.094400e-02f,  6.049100e-02f,  6.003400e-02f,  5.957300e-02f,  5.910800e-02f,
                3.123400e-02f,  3.100800e-02f,  3.078000e-02f,  3.055000e-02f,  3.031800e-02f,  3.008400e-02f,  2.984800e-02f,
                6.319600e-02f,  6.273700e-02f,  6.227400e-02f,  6.180700e-02f,  6.133600e-02f,  6.086100e-02f,  6.038200e-02f,
                3.191300e-02f,  3.168000e-02f,  3.144500e-02f,  3.120800e-02f,  3.096900e-02f,  3.072800e-02f,  3.048500e-02f,
                2.961000e-02f,  2.937000e-02f,  2.912800e-02f,  2.888400e-02f,  2.863800e-02f,  2.839000e-02f,  2.814000e-02f,
                2.440200e-02f,  2.419000e-02f,  2.397600e-02f,  2.376000e-02f,  2.354200e-02f,  2.332200e-02f,  2.310000e-02f,
                2.234400e-02f,  2.212500e-02f,  2.190400e-02f,  2.168100e-02f,  2.145600e-02f,  2.122900e-02f,  2.100000e-02f,
                4.526900e-02f,  4.482400e-02f,  4.437500e-02f,  4.392200e-02f,  4.346500e-02f,  4.300400e-02f,  4.253900e-02f,
                2.287600e-02f,  2.265000e-02f,  2.242200e-02f,  2.219200e-02f,  2.196000e-02f,  2.172600e-02f,  2.149000e-02f,
                4.633300e-02f,  4.587400e-02f,  4.541100e-02f,  4.494400e-02f,  4.447300e-02f,  4.399800e-02f,  4.351900e-02f,
                2.340800e-02f,  2.317500e-02f,  2.294000e-02f,  2.270300e-02f,  2.246400e-02f,  2.222300e-02f,  2.198000e-02f,
                4.739700e-02f,  4.692400e-02f,  4.644700e-02f,  4.596600e-02f,  4.548100e-02f,  4.499200e-02f,  4.449900e-02f,
                2.394000e-02f,  2.370000e-02f,  2.345800e-02f,  2.321400e-02f,  2.296800e-02f,  2.272000e-02f,  2.247000e-02f,
                4.846100e-02f,  4.797400e-02f,  4.748300e-02f,  4.698800e-02f,  4.648900e-02f,  4.598600e-02f,  4.547900e-02f,
                2.447200e-02f,  2.422500e-02f,  2.397600e-02f,  2.372500e-02f,  2.347200e-02f,  2.321700e-02f,  2.296000e-02f,
                4.952500e-02f,  4.902400e-02f,  4.851900e-02f,  4.801000e-02f,  4.749700e-02f,  4.698000e-02f,  4.645900e-02f,
                2.500400e-02f,  2.475000e-02f,  2.449400e-02f,  2.423600e-02f,  2.397600e-02f,  2.371400e-02f,  2.345000e-02f,
                2.270100e-02f,  2.244000e-02f,  2.217700e-02f,  2.191200e-02f,  2.164500e-02f,  2.137600e-02f,  2.110500e-02f,
                5.317200e-02f,  5.270600e-02f,  5.223600e-02f,  5.176200e-02f,  5.128400e-02f,  5.080200e-02f,  5.031600e-02f,
                4.876200e-02f,  4.828200e-02f,  4.779800e-02f,  4.731000e-02f,  4.681800e-02f,  4.632200e-02f,  4.582200e-02f,
                9.868600e-02f,  9.771200e-02f,  9.673000e-02f,  9.574000e-02f,  9.474200e-02f,  9.373600e-02f,  9.272200e-02f,
                4.982600e-02f,  4.933200e-02f,  4.883400e-02f,  4.833200e-02f,  4.782600e-02f,  4.731600e-02f,  4.680200e-02f,
                1.008140e-01f,  9.981200e-02f,  9.880200e-02f,  9.778400e-02f,  9.675800e-02f,  9.572400e-02f,  9.468200e-02f,
                5.089000e-02f,  5.038200e-02f,  4.987000e-02f,  4.935400e-02f,  4.883400e-02f,  4.831000e-02f,  4.778200e-02f,
                1.029420e-01f,  1.019120e-01f,  1.008740e-01f,  9.982800e-02f,  9.877400e-02f,  9.771200e-02f,  9.664200e-02f,
                5.195400e-02f,  5.143200e-02f,  5.090600e-02f,  5.037600e-02f,  4.984200e-02f,  4.930400e-02f,  4.876200e-02f,
                1.050700e-01f,  1.040120e-01f,  1.029460e-01f,  1.018720e-01f,  1.007900e-01f,  9.970000e-02f,  9.860200e-02f,
                5.301800e-02f,  5.248200e-02f,  5.194200e-02f,  5.139800e-02f,  5.085000e-02f,  5.029800e-02f,  4.974200e-02f,
                1.071980e-01f,  1.061120e-01f,  1.050180e-01f,  1.039160e-01f,  1.028060e-01f,  1.016880e-01f,  1.005620e-01f,
                5.408200e-02f,  5.353200e-02f,  5.297800e-02f,  5.242000e-02f,  5.185800e-02f,  5.129200e-02f,  5.072200e-02f,
                4.918200e-02f,  4.861800e-02f,  4.805000e-02f,  4.747800e-02f,  4.690200e-02f,  4.632200e-02f,  4.573800e-02f,
                3.994200e-02f,  3.943400e-02f,  3.892200e-02f,  3.840600e-02f,  3.788600e-02f,  3.736200e-02f,  3.683400e-02f,
                3.553200e-02f,  3.501000e-02f,  3.448400e-02f,  3.395400e-02f,  3.342000e-02f,  3.288200e-02f,  3.234000e-02f,
                7.193200e-02f,  7.087400e-02f,  6.980800e-02f,  6.873400e-02f,  6.765200e-02f,  6.656200e-02f,  6.546400e-02f,
                3.630200e-02f,  3.576600e-02f,  3.522600e-02f,  3.468200e-02f,  3.413400e-02f,  3.358200e-02f,  3.302600e-02f,
                7.347200e-02f,  7.238600e-02f,  7.129200e-02f,  7.019000e-02f,  6.908000e-02f,  6.796200e-02f,  6.683600e-02f,
                3.707200e-02f,  3.652200e-02f,  3.596800e-02f,  3.541000e-02f,  3.484800e-02f,  3.428200e-02f,  3.371200e-02f,
                7.501200e-02f,  7.389800e-02f,  7.277600e-02f,  7.164600e-02f,  7.050800e-02f,  6.936200e-02f,  6.820800e-02f,
                3.784200e-02f,  3.727800e-02f,  3.671000e-02f,  3.613800e-02f,  3.556200e-02f,  3.498200e-02f,  3.439800e-02f,
                7.655200e-02f,  7.541000e-02f,  7.426000e-02f,  7.310200e-02f,  7.193600e-02f,  7.076200e-02f,  6.958000e-02f,
                3.861200e-02f,  3.803400e-02f,  3.745200e-02f,  3.686600e-02f,  3.627600e-02f,  3.568200e-02f,  3.508400e-02f,
                7.809200e-02f,  7.692200e-02f,  7.574400e-02f,  7.455800e-02f,  7.336400e-02f,  7.216200e-02f,  7.095200e-02f,
                3.938200e-02f,  3.879000e-02f,  3.819400e-02f,  3.759400e-02f,  3.699000e-02f,  3.638200e-02f,  3.577000e-02f,
                3.448200e-02f,  3.387600e-02f,  3.326600e-02f,  3.265200e-02f,  3.203400e-02f,  3.141200e-02f,  3.078600e-02f,
                6.602400e-02f,  6.519900e-02f,  6.436800e-02f,  6.353100e-02f,  6.268800e-02f,  6.183900e-02f,  6.098400e-02f,
                5.896800e-02f,  5.812200e-02f,  5.727000e-02f,  5.641200e-02f,  5.554800e-02f,  5.467800e-02f,  5.380200e-02f,
                1.192380e-01f,  1.175250e-01f,  1.158000e-01f,  1.140630e-01f,  1.123140e-01f,  1.105530e-01f,  1.087800e-01f,
                6.012300e-02f,  5.925600e-02f,  5.838300e-02f,  5.750400e-02f,  5.661900e-02f,  5.572800e-02f,  5.483100e-02f,
                1.215480e-01f,  1.197930e-01f,  1.180260e-01f,  1.162470e-01f,  1.144560e-01f,  1.126530e-01f,  1.108380e-01f,
                6.127800e-02f,  6.039000e-02f,  5.949600e-02f,  5.859600e-02f,  5.769000e-02f,  5.677800e-02f,  5.586000e-02f,
                1.238580e-01f,  1.220610e-01f,  1.202520e-01f,  1.184310e-01f,  1.165980e-01f,  1.147530e-01f,  1.128960e-01f,
                6.243300e-02f,  6.152400e-02f,  6.060900e-02f,  5.968800e-02f,  5.876100e-02f,  5.782800e-02f,  5.688900e-02f,
                1.261680e-01f,  1.243290e-01f,  1.224780e-01f,  1.206150e-01f,  1.187400e-01f,  1.168530e-01f,  1.149540e-01f,
                6.358800e-02f,  6.265800e-02f,  6.172200e-02f,  6.078000e-02f,  5.983200e-02f,  5.887800e-02f,  5.791800e-02f,
                1.284780e-01f,  1.265970e-01f,  1.247040e-01f,  1.227990e-01f,  1.208820e-01f,  1.189530e-01f,  1.170120e-01f,
                6.474300e-02f,  6.379200e-02f,  6.283500e-02f,  6.187200e-02f,  6.090300e-02f,  5.992800e-02f,  5.894700e-02f,
                5.695200e-02f,  5.598000e-02f,  5.500200e-02f,  5.401800e-02f,  5.302800e-02f,  5.203200e-02f,  5.103000e-02f,
                4.515000e-02f,  4.455800e-02f,  4.396200e-02f,  4.336200e-02f,  4.275800e-02f,  4.215000e-02f,  4.153800e-02f,
                4.015200e-02f,  3.954600e-02f,  3.893600e-02f,  3.832200e-02f,  3.770400e-02f,  3.708200e-02f,  3.645600e-02f,
                8.117200e-02f,  7.994600e-02f,  7.871200e-02f,  7.747000e-02f,  7.622000e-02f,  7.496200e-02f,  7.369600e-02f,
                4.092200e-02f,  4.030200e-02f,  3.967800e-02f,  3.905000e-02f,  3.841800e-02f,  3.778200e-02f,  3.714200e-02f,
                8.271200e-02f,  8.145800e-02f,  8.019600e-02f,  7.892600e-02f,  7.764800e-02f,  7.636200e-02f,  7.506800e-02f,
                4.169200e-02f,  4.105800e-02f,  4.042000e-02f,  3.977800e-02f,  3.913200e-02f,  3.848200e-02f,  3.782800e-02f,
                8.425200e-02f,  8.297000e-02f,  8.168000e-02f,  8.038200e-02f,  7.907600e-02f,  7.776200e-02f,  7.644000e-02f,
                4.246200e-02f,  4.181400e-02f,  4.116200e-02f,  4.050600e-02f,  3.984600e-02f,  3.918200e-02f,  3.851400e-02f,
                8.579200e-02f,  8.448200e-02f,  8.316400e-02f,  8.183800e-02f,  8.050400e-02f,  7.916200e-02f,  7.781200e-02f,
                4.323200e-02f,  4.257000e-02f,  4.190400e-02f,  4.123400e-02f,  4.056000e-02f,  3.988200e-02f,  3.920000e-02f,
                8.733200e-02f,  8.599400e-02f,  8.464800e-02f,  8.329400e-02f,  8.193200e-02f,  8.056200e-02f,  7.918400e-02f,
                4.400200e-02f,  4.332600e-02f,  4.264600e-02f,  4.196200e-02f,  4.127400e-02f,  4.058200e-02f,  3.988600e-02f,
                3.851400e-02f,  3.782400e-02f,  3.713000e-02f,  3.643200e-02f,  3.573000e-02f,  3.502400e-02f,  3.431400e-02f,
                7.383600e-02f,  7.288500e-02f,  7.192800e-02f,  7.096500e-02f,  6.999600e-02f,  6.902100e-02f,  6.804000e-02f,
                6.589800e-02f,  6.492600e-02f,  6.394800e-02f,  6.296400e-02f,  6.197400e-02f,  6.097800e-02f,  5.997600e-02f,
                1.330980e-01f,  1.311330e-01f,  1.291560e-01f,  1.271670e-01f,  1.251660e-01f,  1.231530e-01f,  1.211280e-01f,
                6.705300e-02f,  6.606000e-02f,  6.506100e-02f,  6.405600e-02f,  6.304500e-02f,  6.202800e-02f,  6.100500e-02f,
                1.354080e-01f,  1.334010e-01f,  1.313820e-01f,  1.293510e-01f,  1.273080e-01f,  1.252530e-01f,  1.231860e-01f,
                6.820800e-02f,  6.719400e-02f,  6.617400e-02f,  6.514800e-02f,  6.411600e-02f,  6.307800e-02f,  6.203400e-02f,
                1.377180e-01f,  1.356690e-01f,  1.336080e-01f,  1.315350e-01f,  1.294500e-01f,  1.273530e-01f,  1.252440e-01f,
                6.936300e-02f,  6.832800e-02f,  6.728700e-02f,  6.624000e-02f,  6.518700e-02f,  6.412800e-02f,  6.306300e-02f,
                1.400280e-01f,  1.379370e-01f,  1.358340e-01f,  1.337190e-01f,  1.315920e-01f,  1.294530e-01f,  1.273020e-01f,
                7.051800e-02f,  6.946200e-02f,  6.840000e-02f,  6.733200e-02f,  6.625800e-02f,  6.517800e-02f,  6.409200e-02f,
                1.423380e-01f,  1.402050e-01f,  1.380600e-01f,  1.359030e-01f,  1.337340e-01f,  1.315530e-01f,  1.293600e-01f,
                7.167300e-02f,  7.059600e-02f,  6.951300e-02f,  6.842400e-02f,  6.732900e-02f,  6.622800e-02f,  6.512100e-02f,
                6.300000e-02f,  6.190200e-02f,  6.079800e-02f,  5.968800e-02f,  5.857200e-02f,  5.745000e-02f,  5.632200e-02f,
                5.035800e-02f,  4.968200e-02f,  4.900200e-02f,  4.831800e-02f,  4.763000e-02f,  4.693800e-02f,  4.624200e-02f,
                4.477200e-02f,  4.408200e-02f,  4.338800e-02f,  4.269000e-02f,  4.198800e-02f,  4.128200e-02f,  4.057200e-02f,
                9.041200e-02f,  8.901800e-02f,  8.761600e-02f,  8.620600e-02f,  8.478800e-02f,  8.336200e-02f,  8.192800e-02f,
                4.554200e-02f,  4.483800e-02f,  4.413000e-02f,  4.341800e-02f,  4.270200e-02f,  4.198200e-02f,  4.125800e-02f,
                9.195200e-02f,  9.053000e-02f,  8.910000e-02f,  8.766200e-02f,  8.621600e-02f,  8.476200e-02f,  8.330000e-02f,
                4.631200e-02f,  4.559400e-02f,  4.487200e-02f,  4.414600e-02f,  4.341600e-02f,  4.268200e-02f,  4.194400e-02f,
                9.349200e-02f,  9.204200e-02f,  9.058400e-02f,  8.911800e-02f,  8.764400e-02f,  8.616200e-02f,  8.467200e-02f,
                4.708200e-02f,  4.635000e-02f,  4.561400e-02f,  4.487400e-02f,  4.413000e-02f,  4.338200e-02f,  4.263000e-02f,
                9.503200e-02f,  9.355400e-02f,  9.206800e-02f,  9.057400e-02f,  8.907200e-02f,  8.756200e-02f,  8.604400e-02f,
                4.785200e-02f,  4.710600e-02f,  4.635600e-02f,  4.560200e-02f,  4.484400e-02f,  4.408200e-02f,  4.331600e-02f,
                9.657200e-02f,  9.506600e-02f,  9.355200e-02f,  9.203000e-02f,  9.050000e-02f,  8.896200e-02f,  8.741600e-02f,
                4.862200e-02f,  4.786200e-02f,  4.709800e-02f,  4.633000e-02f,  4.555800e-02f,  4.478200e-02f,  4.400200e-02f,
                4.254600e-02f,  4.177200e-02f,  4.099400e-02f,  4.021200e-02f,  3.942600e-02f,  3.863600e-02f,  3.784200e-02f,
                8.164800e-02f,  8.057100e-02f,  7.948800e-02f,  7.839900e-02f,  7.730400e-02f,  7.620300e-02f,  7.509600e-02f,
                7.282800e-02f,  7.173000e-02f,  7.062600e-02f,  6.951600e-02f,  6.840000e-02f,  6.727800e-02f,  6.615000e-02f,
                1.469580e-01f,  1.447410e-01f,  1.425120e-01f,  1.402710e-01f,  1.380180e-01f,  1.357530e-01f,  1.334760e-01f,
                7.398300e-02f,  7.286400e-02f,  7.173900e-02f,  7.060800e-02f,  6.947100e-02f,  6.832800e-02f,  6.717900e-02f,
                1.492680e-01f,  1.470090e-01f,  1.447380e-01f,  1.424550e-01f,  1.401600e-01f,  1.378530e-01f,  1.355340e-01f,
                7.513800e-02f,  7.399800e-02f,  7.285200e-02f,  7.170000e-02f,  7.054200e-02f,  6.937800e-02f,  6.820800e-02f,
                1.515780e-01f,  1.492770e-01f,  1.469640e-01f,  1.446390e-01f,  1.423020e-01f,  1.399530e-01f,  1.375920e-01f,
                7.629300e-02f,  7.513200e-02f,  7.396500e-02f,  7.279200e-02f,  7.161300e-02f,  7.042800e-02f,  6.923700e-02f,
                1.538880e-01f,  1.515450e-01f,  1.491900e-01f,  1.468230e-01f,  1.444440e-01f,  1.420530e-01f,  1.396500e-01f,
                7.744800e-02f,  7.626600e-02f,  7.507800e-02f,  7.388400e-02f,  7.268400e-02f,  7.147800e-02f,  7.026600e-02f,
                1.561980e-01f,  1.538130e-01f,  1.514160e-01f,  1.490070e-01f,  1.465860e-01f,  1.441530e-01f,  1.417080e-01f,
                7.860300e-02f,  7.740000e-02f,  7.619100e-02f,  7.497600e-02f,  7.375500e-02f,  7.252800e-02f,  7.129500e-02f,
                6.904800e-02f,  6.782400e-02f,  6.659400e-02f,  6.535800e-02f,  6.411600e-02f,  6.286800e-02f,  6.161400e-02f,
                5.556600e-02f,  5.480600e-02f,  5.404200e-02f,  5.327400e-02f,  5.250200e-02f,  5.172600e-02f,  5.094600e-02f,
                4.939200e-02f,  4.861800e-02f,  4.784000e-02f,  4.705800e-02f,  4.627200e-02f,  4.548200e-02f,  4.468800e-02f,
                9.965200e-02f,  9.809000e-02f,  9.652000e-02f,  9.494200e-02f,  9.335600e-02f,  9.176200e-02f,  9.016000e-02f,
                5.016200e-02f,  4.937400e-02f,  4.858200e-02f,  4.778600e-02f,  4.698600e-02f,  4.618200e-02f,  4.537400e-02f,
                1.011920e-01f,  9.960200e-02f,  9.800400e-02f,  9.639800e-02f,  9.478400e-02f,  9.316200e-02f,  9.153200e-02f,
                5.093200e-02f,  5.013000e-02f,  4.932400e-02f,  4.851400e-02f,  4.770000e-02f,  4.688200e-02f,  4.606000e-02f,
                1.027320e-01f,  1.011140e-01f,  9.948800e-02f,  9.785400e-02f,  9.621200e-02f,  9.456200e-02f,  9.290400e-02f,
                5.170200e-02f,  5.088600e-02f,  5.006600e-02f,  4.924200e-02f,  4.841400e-02f,  4.758200e-02f,  4.674600e-02f,
                1.042720e-01f,  1.026260e-01f,  1.009720e-01f,  9.931000e-02f,  9.764000e-02f,  9.596200e-02f,  9.427600e-02f,
                5.247200e-02f,  5.164200e-02f,  5.080800e-02f,  4.997000e-02f,  4.912800e-02f,  4.828200e-02f,  4.743200e-02f,
                1.058120e-01f,  1.041380e-01f,  1.024560e-01f,  1.007660e-01f,  9.906800e-02f,  9.736200e-02f,  9.564800e-02f,
                5.324200e-02f,  5.239800e-02f,  5.155000e-02f,  5.069800e-02f,  4.984200e-02f,  4.898200e-02f,  4.811800e-02f,
                4.657800e-02f,  4.572000e-02f,  4.485800e-02f,  4.399200e-02f,  4.312200e-02f,  4.224800e-02f,  4.137000e-02f,
                8.946000e-02f,  8.825700e-02f,  8.704800e-02f,  8.583300e-02f,  8.461200e-02f,  8.338500e-02f,  8.215200e-02f,
                7.975800e-02f,  7.853400e-02f,  7.730400e-02f,  7.606800e-02f,  7.482600e-02f,  7.357800e-02f,  7.232400e-02f,
                1.608180e-01f,  1.583490e-01f,  1.558680e-01f,  1.533750e-01f,  1.508700e-01f,  1.483530e-01f,  1.458240e-01f,
                8.091300e-02f,  7.966800e-02f,  7.841700e-02f,  7.716000e-02f,  7.589700e-02f,  7.462800e-02f,  7.335300e-02f,
                1.631280e-01f,  1.606170e-01f,  1.580940e-01f,  1.555590e-01f,  1.530120e-01f,  1.504530e-01f,  1.478820e-01f,
                8.206800e-02f,  8.080200e-02f,  7.953000e-02f,  7.825200e-02f,  7.696800e-02f,  7.567800e-02f,  7.438200e-02f,
                1.654380e-01f,  1.628850e-01f,  1.603200e-01f,  1.577430e-01f,  1.551540e-01f,  1.525530e-01f,  1.499400e-01f,
                8.322300e-02f,  8.193600e-02f,  8.064300e-02f,  7.934400e-02f,  7.803900e-02f,  7.672800e-02f,  7.541100e-02f,
                1.677480e-01f,  1.651530e-01f,  1.625460e-01f,  1.599270e-01f,  1.572960e-01f,  1.546530e-01f,  1.519980e-01f,
                8.437800e-02f,  8.307000e-02f,  8.175600e-02f,  8.043600e-02f,  7.911000e-02f,  7.777800e-02f,  7.644000e-02f,
                1.700580e-01f,  1.674210e-01f,  1.647720e-01f,  1.621110e-01f,  1.594380e-01f,  1.567530e-01f,  1.540560e-01f,
                8.553300e-02f,  8.420400e-02f,  8.286900e-02f,  8.152800e-02f,  8.018100e-02f,  7.882800e-02f,  7.746900e-02f,
                7.509600e-02f,  7.374600e-02f,  7.239000e-02f,  7.102800e-02f,  6.966000e-02f,  6.828600e-02f,  6.690600e-02f,
                6.077400e-02f,  5.993000e-02f,  5.908200e-02f,  5.823000e-02f,  5.737400e-02f,  5.651400e-02f,  5.565000e-02f,
                5.401200e-02f,  5.315400e-02f,  5.229200e-02f,  5.142600e-02f,  5.055600e-02f,  4.968200e-02f,  4.880400e-02f,
                1.088920e-01f,  1.071620e-01f,  1.054240e-01f,  1.036780e-01f,  1.019240e-01f,  1.001620e-01f,  9.839200e-02f,
                5.478200e-02f,  5.391000e-02f,  5.303400e-02f,  5.215400e-02f,  5.127000e-02f,  5.038200e-02f,  4.949000e-02f,
                1.104320e-01f,  1.086740e-01f,  1.069080e-01f,  1.051340e-01f,  1.033520e-01f,  1.015620e-01f,  9.976400e-02f,
                5.555200e-02f,  5.466600e-02f,  5.377600e-02f,  5.288200e-02f,  5.198400e-02f,  5.108200e-02f,  5.017600e-02f,
                1.119720e-01f,  1.101860e-01f,  1.083920e-01f,  1.065900e-01f,  1.047800e-01f,  1.029620e-01f,  1.011360e-01f,
                5.632200e-02f,  5.542200e-02f,  5.451800e-02f,  5.361000e-02f,  5.269800e-02f,  5.178200e-02f,  5.086200e-02f,
                1.135120e-01f,  1.116980e-01f,  1.098760e-01f,  1.080460e-01f,  1.062080e-01f,  1.043620e-01f,  1.025080e-01f,
                5.709200e-02f,  5.617800e-02f,  5.526000e-02f,  5.433800e-02f,  5.341200e-02f,  5.248200e-02f,  5.154800e-02f,
                1.150520e-01f,  1.132100e-01f,  1.113600e-01f,  1.095020e-01f,  1.076360e-01f,  1.057620e-01f,  1.038800e-01f,
                5.786200e-02f,  5.693400e-02f,  5.600200e-02f,  5.506600e-02f,  5.412600e-02f,  5.318200e-02f,  5.223400e-02f,
                5.061000e-02f,  4.966800e-02f,  4.872200e-02f,  4.777200e-02f,  4.681800e-02f,  4.586000e-02f,  4.489800e-02f,
                9.727200e-02f,  9.594300e-02f,  9.460800e-02f,  9.326700e-02f,  9.192000e-02f,  9.056700e-02f,  8.920800e-02f,
                8.668800e-02f,  8.533800e-02f,  8.398200e-02f,  8.262000e-02f,  8.125200e-02f,  7.987800e-02f,  7.849800e-02f,
                1.746780e-01f,  1.719570e-01f,  1.692240e-01f,  1.664790e-01f,  1.637220e-01f,  1.609530e-01f,  1.581720e-01f,
                8.784300e-02f,  8.647200e-02f,  8.509500e-02f,  8.371200e-02f,  8.232300e-02f,  8.092800e-02f,  7.952700e-02f,
                1.769880e-01f,  1.742250e-01f,  1.714500e-01f,  1.686630e-01f,  1.658640e-01f,  1.630530e-01f,  1.602300e-01f,
                8.899800e-02f,  8.760600e-02f,  8.620800e-02f,  8.480400e-02f,  8.339400e-02f,  8.197800e-02f,  8.055600e-02f,
                1.792980e-01f,  1.764930e-01f,  1.736760e-01f,  1.708470e-01f,  1.680060e-01f,  1.651530e-01f,  1.622880e-01f,
                9.015300e-02f,  8.874000e-02f,  8.732100e-02f,  8.589600e-02f,  8.446500e-02f,  8.302800e-02f,  8.158500e-02f,
                1.816080e-01f,  1.787610e-01f,  1.759020e-01f,  1.730310e-01f,  1.701480e-01f,  1.672530e-01f,  1.643460e-01f,
                9.130800e-02f,  8.987400e-02f,  8.843400e-02f,  8.698800e-02f,  8.553600e-02f,  8.407800e-02f,  8.261400e-02f,
                1.839180e-01f,  1.810290e-01f,  1.781280e-01f,  1.752150e-01f,  1.722900e-01f,  1.693530e-01f,  1.664040e-01f,
                9.246300e-02f,  9.100800e-02f,  8.954700e-02f,  8.808000e-02f,  8.660700e-02f,  8.512800e-02f,  8.364300e-02f,
                8.114400e-02f,  7.966800e-02f,  7.818600e-02f,  7.669800e-02f,  7.520400e-02f,  7.370400e-02f,  7.219800e-02f,
                6.598200e-02f,  6.505400e-02f,  6.412200e-02f,  6.318600e-02f,  6.224600e-02f,  6.130200e-02f,  6.035400e-02f,
                5.863200e-02f,  5.769000e-02f,  5.674400e-02f,  5.579400e-02f,  5.484000e-02f,  5.388200e-02f,  5.292000e-02f,
                1.181320e-01f,  1.162340e-01f,  1.143280e-01f,  1.124140e-01f,  1.104920e-01f,  1.085620e-01f,  1.066240e-01f,
                5.940200e-02f,  5.844600e-02f,  5.748600e-02f,  5.652200e-02f,  5.555400e-02f,  5.458200e-02f,  5.360600e-02f,
                1.196720e-01f,  1.177460e-01f,  1.158120e-01f,  1.138700e-01f,  1.119200e-01f,  1.099620e-01f,  1.079960e-01f,
                6.017200e-02f,  5.920200e-02f,  5.822800e-02f,  5.725000e-02f,  5.626800e-02f,  5.528200e-02f,  5.429200e-02f,
                1.212120e-01f,  1.192580e-01f,  1.172960e-01f,  1.153260e-01f,  1.133480e-01f,  1.113620e-01f,  1.093680e-01f,
                6.094200e-02f,  5.995800e-02f,  5.897000e-02f,  5.797800e-02f,  5.698200e-02f,  5.598200e-02f,  5.497800e-02f,
                1.227520e-01f,  1.207700e-01f,  1.187800e-01f,  1.167820e-01f,  1.147760e-01f,  1.127620e-01f,  1.107400e-01f,
                6.171200e-02f,  6.071400e-02f,  5.971200e-02f,  5.870600e-02f,  5.769600e-02f,  5.668200e-02f,  5.566400e-02f,
                1.242920e-01f,  1.222820e-01f,  1.202640e-01f,  1.182380e-01f,  1.162040e-01f,  1.141620e-01f,  1.121120e-01f,
                6.248200e-02f,  6.147000e-02f,  6.045400e-02f,  5.943400e-02f,  5.841000e-02f,  5.738200e-02f,  5.635000e-02f,
                5.464200e-02f,  5.361600e-02f,  5.258600e-02f,  5.155200e-02f,  5.051400e-02f,  4.947200e-02f,  4.842600e-02f,
                4.393200e-02f,  4.296200e-02f,  4.198800e-02f,  4.101000e-02f,  4.002800e-02f,  3.904200e-02f,  3.805200e-02f,
                3.658200e-02f,  3.559800e-02f,  3.461000e-02f,  3.361800e-02f,  3.262200e-02f,  3.162200e-02f,  3.061800e-02f,
                7.373800e-02f,  7.175600e-02f,  6.976600e-02f,  6.776800e-02f,  6.576200e-02f,  6.374800e-02f,  6.172600e-02f,
                3.705800e-02f,  3.606000e-02f,  3.505800e-02f,  3.405200e-02f,  3.304200e-02f,  3.202800e-02f,  3.101000e-02f,
                7.469000e-02f,  7.268000e-02f,  7.066200e-02f,  6.863600e-02f,  6.660200e-02f,  6.456000e-02f,  6.251000e-02f,
                3.753400e-02f,  3.652200e-02f,  3.550600e-02f,  3.448600e-02f,  3.346200e-02f,  3.243400e-02f,  3.140200e-02f,
                7.564200e-02f,  7.360400e-02f,  7.155800e-02f,  6.950400e-02f,  6.744200e-02f,  6.537200e-02f,  6.329400e-02f,
                3.801000e-02f,  3.698400e-02f,  3.595400e-02f,  3.492000e-02f,  3.388200e-02f,  3.284000e-02f,  3.179400e-02f,
                7.659400e-02f,  7.452800e-02f,  7.245400e-02f,  7.037200e-02f,  6.828200e-02f,  6.618400e-02f,  6.407800e-02f,
                3.848600e-02f,  3.744600e-02f,  3.640200e-02f,  3.535400e-02f,  3.430200e-02f,  3.324600e-02f,  3.218600e-02f,
                7.754600e-02f,  7.545200e-02f,  7.335000e-02f,  7.124000e-02f,  6.912200e-02f,  6.699600e-02f,  6.486200e-02f,
                3.896200e-02f,  3.790800e-02f,  3.685000e-02f,  3.578800e-02f,  3.472200e-02f,  3.365200e-02f,  3.257800e-02f,
                3.112200e-02f,  3.005400e-02f,  2.898200e-02f,  2.790600e-02f,  2.682600e-02f,  2.574200e-02f,  2.465400e-02f,
                2.238600e-02f,  2.188000e-02f,  2.137200e-02f,  2.086200e-02f,  2.035000e-02f,  1.983600e-02f,  1.932000e-02f,
                1.856400e-02f,  1.805100e-02f,  1.753600e-02f,  1.701900e-02f,  1.650000e-02f,  1.597900e-02f,  1.545600e-02f,
                3.741500e-02f,  3.638200e-02f,  3.534500e-02f,  3.430400e-02f,  3.325900e-02f,  3.221000e-02f,  3.115700e-02f,
                1.880200e-02f,  1.828200e-02f,  1.776000e-02f,  1.723600e-02f,  1.671000e-02f,  1.618200e-02f,  1.565200e-02f,
                3.789100e-02f,  3.684400e-02f,  3.579300e-02f,  3.473800e-02f,  3.367900e-02f,  3.261600e-02f,  3.154900e-02f,
                1.904000e-02f,  1.851300e-02f,  1.798400e-02f,  1.745300e-02f,  1.692000e-02f,  1.638500e-02f,  1.584800e-02f,
                3.836700e-02f,  3.730600e-02f,  3.624100e-02f,  3.517200e-02f,  3.409900e-02f,  3.302200e-02f,  3.194100e-02f,
                1.927800e-02f,  1.874400e-02f,  1.820800e-02f,  1.767000e-02f,  1.713000e-02f,  1.658800e-02f,  1.604400e-02f,
                3.884300e-02f,  3.776800e-02f,  3.668900e-02f,  3.560600e-02f,  3.451900e-02f,  3.342800e-02f,  3.233300e-02f,
                1.951600e-02f,  1.897500e-02f,  1.843200e-02f,  1.788700e-02f,  1.734000e-02f,  1.679100e-02f,  1.624000e-02f,
                3.931900e-02f,  3.823000e-02f,  3.713700e-02f,  3.604000e-02f,  3.493900e-02f,  3.383400e-02f,  3.272500e-02f,
                1.975400e-02f,  1.920600e-02f,  1.865600e-02f,  1.810400e-02f,  1.755000e-02f,  1.699400e-02f,  1.643600e-02f,
                1.568700e-02f,  1.513200e-02f,  1.457500e-02f,  1.401600e-02f,  1.345500e-02f,  1.289200e-02f,  1.232700e-02f,
                1.092000e-02f,  1.039300e-02f,  9.864000e-03f,  9.333000e-03f,  8.800000e-03f,  8.265000e-03f,  7.728000e-03f,
                7.098000e-03f,  6.564000e-03f,  6.028000e-03f,  5.490000e-03f,  4.950000e-03f,  4.408000e-03f,  3.864000e-03f,
                1.433600e-02f,  1.326100e-02f,  1.218200e-02f,  1.109900e-02f,  1.001200e-02f,  8.921000e-03f,  7.826000e-03f,
                7.189000e-03f,  6.648000e-03f,  6.105000e-03f,  5.560000e-03f,  5.013000e-03f,  4.464000e-03f,  3.913000e-03f,
                1.451800e-02f,  1.342900e-02f,  1.233600e-02f,  1.123900e-02f,  1.013800e-02f,  9.033000e-03f,  7.924000e-03f,
                7.280000e-03f,  6.732000e-03f,  6.182000e-03f,  5.630000e-03f,  5.076000e-03f,  4.520000e-03f,  3.962000e-03f,
                1.470000e-02f,  1.359700e-02f,  1.249000e-02f,  1.137900e-02f,  1.026400e-02f,  9.145000e-03f,  8.022000e-03f,
                7.371000e-03f,  6.816000e-03f,  6.259000e-03f,  5.700000e-03f,  5.139000e-03f,  4.576000e-03f,  4.011000e-03f,
                1.488200e-02f,  1.376500e-02f,  1.264400e-02f,  1.151900e-02f,  1.039000e-02f,  9.257000e-03f,  8.120000e-03f,
                7.462000e-03f,  6.900000e-03f,  6.336000e-03f,  5.770000e-03f,  5.202000e-03f,  4.632000e-03f,  4.060000e-03f,
                1.506400e-02f,  1.393300e-02f,  1.279800e-02f,  1.165900e-02f,  1.051600e-02f,  9.369000e-03f,  8.218000e-03f,
                7.553000e-03f,  6.984000e-03f,  6.413000e-03f,  5.840000e-03f,  5.265000e-03f,  4.688000e-03f,  4.109000e-03f,
                3.486000e-03f,  2.910000e-03f,  2.332000e-03f,  1.752000e-03f,  1.170000e-03f,  5.860000e-04f,  0.000000e+00f,
            };

            float[] x_actual = x.ToArray();

            AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, $"mismatch value {channels},{kwidth},{kheight},{inwidth},{inheight},{batch}");
        }

        [TestMethod]
        public void OptimizeTest() {
            float max_err = 0;

            foreach (int batch in new int[] { 1, 2 }) {
                foreach (int channels in new int[] { 1, 2, 3, 4, 5, 10, 15, 20 }) {
                    foreach (int kheight in new int[] { 1, 3, 5 }) {
                        foreach (int kwidth in new int[] { 1, 3, 5 }) {
                            foreach (int inwidth in new int[] { 8, 9, 13, 17 }) {
                                foreach (int inheight in new int[] { 8, 9, 19, 23 }) {
                                    int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1;

                                    float[] yval = (new float[outwidth * outheight * channels * batch]).Select((_, idx) => idx * 1e-4f).ToArray();
                                    float[] wval = (new float[kwidth * kheight * channels]).Select((_, idx) => idx * 1e-4f).Reverse().ToArray();

                                    Map2D y = new Map2D(channels, outwidth, outheight, batch, yval);
                                    Filter2D w = new Filter2D(channels, 1, kwidth, kheight, wval);

                                    Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight);
                                    Map2D x_optimized = OptimizedReference(y, w, inwidth, inheight, kwidth, kheight);

                                    float[] x_expect = x.ToArray();
                                    float[] x_actual = x_optimized.ToArray();

                                    AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, ref max_err, $"mismatch value {channels},{kwidth},{kheight},{inwidth},{inheight},{batch}");

                                    Console.WriteLine($"pass: {channels},{kwidth},{kheight},{inwidth},{inheight},{batch}");
                                }
                            }
                        }
                    }
                }
            }

            Console.WriteLine($"maxerr:{max_err}");
        }
    }
}
