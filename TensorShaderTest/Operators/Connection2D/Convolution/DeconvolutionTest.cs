using System;
using System.Diagnostics;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TensorShader;
using TensorShader.Operators.Connection2D;
using TensorShaderCudaBackend.API;

namespace TensorShaderTest.Operators.Connection2D {
    [TestClass]
    public class DeconvolutionTest {
        [TestMethod]
        public void ExecuteTest() {
            float max_err = 0;

            foreach (int batch in new int[] { 1, 2 }) {
                foreach (int inchannels in new int[] { 1, 2, 3, 4, 5, 10, 15, 20 }) {
                    foreach (int outchannels in new int[] { 7, 13 }) {
                        foreach (int kheight in new int[] { 1, 3, 5 }) {
                            foreach (int kwidth in new int[] { 1, 3, 5 }) {
                                foreach (int stride in new int[] { 1 }) {
                                    foreach (int inwidth in new int[] { 8, 9, 13, 17 }) {
                                        foreach (int inheight in new int[] { 8, 9, 19, 23 }) {
                                            int outwidth = (inwidth - kwidth) / stride + 1, outheight = (inheight - kheight) / stride + 1;

                                            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-4f).ToArray();
                                            float[] wval = (new float[kwidth * kheight * inchannels * outchannels]).Select((_, idx) => idx * 1e-4f).Reverse().ToArray();

                                            Map2D y = new Map2D(outchannels, outwidth, outheight, batch, yval);
                                            Filter2D w = new Filter2D(inchannels, outchannels, kwidth, kheight, wval);

                                            Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight, stride);

                                            OverflowCheckedTensor y_tensor = new OverflowCheckedTensor(Shape.Map2D(outchannels, outwidth, outheight, batch), yval);
                                            OverflowCheckedTensor w_tensor = new OverflowCheckedTensor(Shape.Kernel2D(inchannels, outchannels, kwidth, kheight), wval);

                                            OverflowCheckedTensor x_tensor = new OverflowCheckedTensor(Shape.Map2D(inchannels, inwidth, inheight, batch));

                                            Deconvolution ope = new Deconvolution(inwidth, inheight, outchannels, inchannels, kwidth, kheight, stride, batch);

                                            ope.Execute(y_tensor, w_tensor, x_tensor);

                                            float[] x_expect = x.ToArray();
                                            float[] x_actual = x_tensor.State;

                                            CollectionAssert.AreEqual(yval, y_tensor.State);
                                            CollectionAssert.AreEqual(wval, w_tensor.State);

                                            AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, ref max_err, $"mismatch value {inchannels},{outchannels},{kwidth},{kheight},{stride},{inwidth},{inheight},{batch}");

                                            Console.WriteLine($"pass: {inchannels},{outchannels},{kwidth},{kheight},{stride},{inwidth},{inheight},{batch}");
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            Console.WriteLine($"maxerr:{max_err}");
        }

        [TestMethod]
        public void SpeedTest() {
            int inwidth = 512, inheight = 512, inchannels = 31, outchannels = 31, ksize = 3, stride = 1;
            int outwidth = (inwidth - ksize) / stride + 1, outheight = (inheight - ksize) / stride + 1;

            OverflowCheckedTensor y_tensor = new OverflowCheckedTensor(Shape.Map2D(outchannels, outwidth, outheight));
            OverflowCheckedTensor w_tensor = new OverflowCheckedTensor(Shape.Kernel2D(inchannels, outchannels, ksize, ksize));

            OverflowCheckedTensor x_tensor = new OverflowCheckedTensor(Shape.Map2D(inchannels, inwidth, inheight));

            Deconvolution ope = new Deconvolution(inwidth, inheight, outchannels, inchannels, ksize, ksize, stride);

            ope.Execute(y_tensor, w_tensor, x_tensor);

            Cuda.Profiler.Initialize("../../../profiler.nvsetting", "../../nvprofiles/deconvolution2d.nvvp");
            Cuda.Profiler.Start();

            ope.Execute(y_tensor, w_tensor, x_tensor);

            Cuda.Profiler.Stop();
        }

        public static Map2D Reference(Map2D y, Filter2D w, int inw, int inh, int kwidth, int kheight, int stride) {
            int inchannels = w.InChannels, outchannels = w.OutChannels, batch = y.Batch;
            int outw = (inw - kwidth) / stride + 1, outh = (inh - kheight) / stride + 1;

            if (y.Width != outw || y.Height != outh) {
                throw new ArgumentException("mismatch shape");
            }

            Map2D x = new Map2D(inchannels, inw, inh, batch);

            for (int kx, ky = 0; ky < kheight; ky++) {
                for (kx = 0; kx < kwidth; kx++) {
                    for (int th = 0; th < batch; th++) {
                        for (int ox, oy = 0; oy < outh; oy++) {
                            for (ox = 0; ox < outw; ox++) {
                                for (int outch = 0; outch < outchannels; outch++) {
                                    double v = y[outch, ox, oy, th];

                                    for (int inch = 0; inch < inchannels; inch++) {
                                        x[inch, kx + ox * stride, ky + oy * stride, th] += v * w[inch, outch, kx, ky];
                                    }
                                }
                            }
                        }
                    }
                }
            }

            return x;
        }

        public static Map2D Reference2(Map2D y, Filter2D w, int inw, int inh, int kwidth, int kheight, int stride) {
            int inchannels = w.InChannels, outchannels = w.OutChannels, batch = y.Batch;
            int outw = (inw - kwidth) / stride + 1, outh = (inh - kheight) / stride + 1;

            if (y.Width != outw || y.Height != outh) {
                throw new ArgumentException("mismatch shape");
            }

            Map2D x = new Map2D(inchannels, inw, inh, batch);

            for (int kx, ky = 0; ky < kheight; ky++) {
                for (kx = 0; kx < kwidth; kx++) {
                    for (int th = 0; th < batch; th++) {
                        for (int ox, oy = 0; oy < outh; oy++) {
                            for (ox = 0; ox < outw; ox++) {
                                int inch;
                                double[] temp = new double[4];

                                for (inch = 0; inch < inchannels - inchannels % 4; inch += 4) {
                                    for (int i = 0; i < 4; i++) {
                                        temp[i] = x[inch + i, kx + ox * stride, ky + oy * stride, th];
                                    }

                                    for (int outch = 0; outch < outchannels; outch++) {
                                        double yv = y[outch, ox, oy, th];

                                        for (int i = 0; i < 4; i++) {
                                            temp[i] += yv * w[inch + i, outch, kx, ky];
                                        }
                                    }

                                    for (int i = 0; i < 4; i++) {
                                        x[inch + i, kx + ox * stride, ky + oy * stride, th] = temp[i];
                                    }
                                }

                                if (inchannels % 4 != 0) {
                                    int sets = inchannels % 4;

                                    for (int i = 0; i < sets; i++) {
                                        temp[i] = x[inch + i, kx + ox * stride, ky + oy * stride, th];
                                    }

                                    for (int outch = 0; outch < outchannels; outch++) {
                                        double yv = y[outch, ox, oy, th];

                                        for (int i = 0; i < sets; i++) {
                                            temp[i] += yv * w[inch + i, outch, kx, ky];
                                        }
                                    }

                                    for (int i = 0; i < sets; i++) {
                                        x[inch + i, kx + ox * stride, ky + oy * stride, th] = temp[i];
                                    }
                                }
                            }
                        }
                    }
                }
            }

            return x;
        }

        public static Map2D OptimizedReference(Map2D y, Filter2D w, int inw, int inh, int kwidth, int kheight, int stride) {
            int inchannels = w.InChannels, outchannels = w.OutChannels, batch = y.Batch;
            int outw = (inw - kwidth) / stride + 1, outh = (inh - kheight) / stride + 1;

            if (y.Width != outw || y.Height != outh) {
                throw new ArgumentException("mismatch shape");
            }

            Map2D x = new Map2D(inchannels, inw, inh, batch);

            for (int kx, ky = 0; ky < kheight; ky++) {
                for (kx = 0; kx < kwidth; kx++) {
                    int outmap_offset = (kx + ky * inw) * inchannels;
                    int kernel_offset = (kx + ky * kwidth) * inchannels * outchannels;

                    for (int th = 0; th < batch; th++) {
                        for (int ox, oy = 0; oy < outh; oy++) {
                            for (ox = 0; ox < outw; ox++) {
                                int inmap_org = (ox + oy * outw) * outchannels + th * outw * outh * outchannels;
                                int outmap_idx = outmap_offset + (ox + oy * inw) * inchannels * stride + th * inw * inh * inchannels;
                                int kernel_org = kernel_offset;
                                double[] temp = new double[4];

                                int inch;

                                for (inch = 0; inch < inchannels - inchannels % 4; inch += 4) {
                                    temp[0] = x[outmap_idx];
                                    temp[1] = x[outmap_idx + 1];
                                    temp[2] = x[outmap_idx + 2];
                                    temp[3] = x[outmap_idx + 3];

                                    int inmap_idx = inmap_org;
                                    int kernel_idx = kernel_org;

                                    for (int outch = 0; outch < outchannels; outch++) {
                                        double v = y[inmap_idx];

                                        temp[0] += v * w[kernel_idx];
                                        temp[1] += v * w[kernel_idx + 1];
                                        temp[2] += v * w[kernel_idx + 2];
                                        temp[3] += v * w[kernel_idx + 3];

                                        inmap_idx++;
                                        kernel_idx += inchannels;
                                    }

                                    x[outmap_idx] = temp[0];
                                    x[outmap_idx + 1] = temp[1];
                                    x[outmap_idx + 2] = temp[2];
                                    x[outmap_idx + 3] = temp[3];

                                    outmap_idx += 4;
                                    kernel_org += 4;
                                }

                                if (inchannels % 4 != 0) {
                                    int sets = inchannels % 4;

                                    for (int i = 0; i < sets; i++) {
                                        temp[i] = x[outmap_idx + i];
                                    }

                                    int inmap_idx = inmap_org;
                                    int kernel_idx = kernel_org;

                                    for (int outch = 0; outch < outchannels; outch++) {
                                        double v = y[inmap_idx];

                                        for (int i = 0; i < sets; i++) {
                                            temp[i] += v * w[kernel_idx + i];
                                        }

                                        inmap_idx++;
                                        kernel_idx += inchannels;
                                    }

                                    for (int i = 0; i < sets; i++) {
                                        x[outmap_idx + i] = temp[i];
                                    }
                                }
                            }
                        }
                    }
                }
            }

            return x;
        }

        [TestMethod]
        public void ReferenceTest() {
            int inchannels = 7, outchannels = 11, kwidth = 3, kheight = 5, stride = 2, inwidth = 13, inheight = 17, batch = 2;
            int outwidth = (inwidth - kwidth) / stride + 1, outheight = (inheight - kheight) / stride + 1;

            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * outchannels * inchannels]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            Map2D y = new Map2D(outchannels, outwidth, outheight, batch, yval);
            Filter2D w = new Filter2D(inchannels, outchannels, kwidth, kheight, wval);

            Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight, stride);

            float[] x_expect = {
                6.077500000e-02f, 6.072000000e-02f, 6.066500000e-02f, 6.061000000e-02f, 6.055500000e-02f,
                6.050000000e-02f, 6.044500000e-02f, 5.654000000e-02f, 5.648500000e-02f, 5.643000000e-02f,
                5.637500000e-02f, 5.632000000e-02f, 5.626500000e-02f, 5.621000000e-02f, 2.484790000e-01f,
                2.482480000e-01f, 2.480170000e-01f, 2.477860000e-01f, 2.475550000e-01f, 2.473240000e-01f,
                2.470930000e-01f, 1.826220000e-01f, 1.824460000e-01f, 1.822700000e-01f, 1.820940000e-01f,
                1.819180000e-01f, 1.817420000e-01f, 1.815660000e-01f, 5.006430000e-01f, 5.001700000e-01f,
                4.996970000e-01f, 4.992240000e-01f, 4.987510000e-01f, 4.982780000e-01f, 4.978050000e-01f,
                3.087040000e-01f, 3.084070000e-01f, 3.081100000e-01f, 3.078130000e-01f, 3.075160000e-01f,
                3.072190000e-01f, 3.069220000e-01f, 7.528070000e-01f, 7.520920000e-01f, 7.513770000e-01f,
                7.506620000e-01f, 7.499470000e-01f, 7.492320000e-01f, 7.485170000e-01f, 4.347860000e-01f,
                4.343680000e-01f, 4.339500000e-01f, 4.335320000e-01f, 4.331140000e-01f, 4.326960000e-01f,
                4.322780000e-01f, 1.004971000e+00f, 1.004014000e+00f, 1.003057000e+00f, 1.002100000e+00f,
                1.001143000e+00f, 1.000186000e+00f, 9.992290000e-01f, 5.608680000e-01f, 5.603290000e-01f,
                5.597900000e-01f, 5.592510000e-01f, 5.587120000e-01f, 5.581730000e-01f, 5.576340000e-01f,
                1.257135000e+00f, 1.255936000e+00f, 1.254737000e+00f, 1.253538000e+00f, 1.252339000e+00f,
                1.251140000e+00f, 1.249941000e+00f, 6.869500000e-01f, 6.862900000e-01f, 6.856300000e-01f,
                6.849700000e-01f, 6.843100000e-01f, 6.836500000e-01f, 6.829900000e-01f, 6.361300000e-01f,
                6.354700000e-01f, 6.348100000e-01f, 6.341500000e-01f, 6.334900000e-01f, 6.328300000e-01f,
                6.321700000e-01f, 4.807000000e-02f, 4.801500000e-02f, 4.796000000e-02f, 4.790500000e-02f,
                4.785000000e-02f, 4.779500000e-02f, 4.774000000e-02f, 4.383500000e-02f, 4.378000000e-02f,
                4.372500000e-02f, 4.367000000e-02f, 4.361500000e-02f, 4.356000000e-02f, 4.350500000e-02f,
                1.951180000e-01f, 1.948870000e-01f, 1.946560000e-01f, 1.944250000e-01f, 1.941940000e-01f,
                1.939630000e-01f, 1.937320000e-01f, 1.419660000e-01f, 1.417900000e-01f, 1.416140000e-01f,
                1.414380000e-01f, 1.412620000e-01f, 1.410860000e-01f, 1.409100000e-01f, 3.913800000e-01f,
                3.909070000e-01f, 3.904340000e-01f, 3.899610000e-01f, 3.894880000e-01f, 3.890150000e-01f,
                3.885420000e-01f, 2.400970000e-01f, 2.398000000e-01f, 2.395030000e-01f, 2.392060000e-01f,
                2.389090000e-01f, 2.386120000e-01f, 2.383150000e-01f, 5.876420000e-01f, 5.869270000e-01f,
                5.862120000e-01f, 5.854970000e-01f, 5.847820000e-01f, 5.840670000e-01f, 5.833520000e-01f,
                3.382280000e-01f, 3.378100000e-01f, 3.373920000e-01f, 3.369740000e-01f, 3.365560000e-01f,
                3.361380000e-01f, 3.357200000e-01f, 7.839040000e-01f, 7.829470000e-01f, 7.819900000e-01f,
                7.810330000e-01f, 7.800760000e-01f, 7.791190000e-01f, 7.781620000e-01f, 4.363590000e-01f,
                4.358200000e-01f, 4.352810000e-01f, 4.347420000e-01f, 4.342030000e-01f, 4.336640000e-01f,
                4.331250000e-01f, 9.801660000e-01f, 9.789670000e-01f, 9.777680000e-01f, 9.765690000e-01f,
                9.753700000e-01f, 9.741710000e-01f, 9.729720000e-01f, 5.344900000e-01f, 5.338300000e-01f,
                5.331700000e-01f, 5.325100000e-01f, 5.318500000e-01f, 5.311900000e-01f, 5.305300000e-01f,
                4.836700000e-01f, 4.830100000e-01f, 4.823500000e-01f, 4.816900000e-01f, 4.810300000e-01f,
                4.803700000e-01f, 4.797100000e-01f, 9.085340000e-01f, 9.076980000e-01f, 9.068620000e-01f,
                9.060260000e-01f, 9.051900000e-01f, 9.043540000e-01f, 9.035180000e-01f, 8.441620000e-01f,
                8.433260000e-01f, 8.424900000e-01f, 8.416540000e-01f, 8.408180000e-01f, 8.399820000e-01f,
                8.391460000e-01f, 1.903220000e+00f, 1.901306000e+00f, 1.899392000e+00f, 1.897478000e+00f,
                1.895564000e+00f, 1.893650000e+00f, 1.891736000e+00f, 1.040424000e+00f, 1.039346000e+00f,
                1.038268000e+00f, 1.037190000e+00f, 1.036112000e+00f, 1.035034000e+00f, 1.033956000e+00f,
                2.295744000e+00f, 2.293346000e+00f, 2.290948000e+00f, 2.288550000e+00f, 2.286152000e+00f,
                2.283754000e+00f, 2.281356000e+00f, 1.236686000e+00f, 1.235366000e+00f, 1.234046000e+00f,
                1.232726000e+00f, 1.231406000e+00f, 1.230086000e+00f, 1.228766000e+00f, 2.688268000e+00f,
                2.685386000e+00f, 2.682504000e+00f, 2.679622000e+00f, 2.676740000e+00f, 2.673858000e+00f,
                2.670976000e+00f, 1.432948000e+00f, 1.431386000e+00f, 1.429824000e+00f, 1.428262000e+00f,
                1.426700000e+00f, 1.425138000e+00f, 1.423576000e+00f, 3.080792000e+00f, 3.077426000e+00f,
                3.074060000e+00f, 3.070694000e+00f, 3.067328000e+00f, 3.063962000e+00f, 3.060596000e+00f,
                1.629210000e+00f, 1.627406000e+00f, 1.625602000e+00f, 1.623798000e+00f, 1.621994000e+00f,
                1.620190000e+00f, 1.618386000e+00f, 3.473316000e+00f, 3.469466000e+00f, 3.465616000e+00f,
                3.461766000e+00f, 3.457916000e+00f, 3.454066000e+00f, 3.450216000e+00f, 1.825472000e+00f,
                1.823426000e+00f, 1.821380000e+00f, 1.819334000e+00f, 1.817288000e+00f, 1.815242000e+00f,
                1.813196000e+00f, 1.667930000e+00f, 1.665884000e+00f, 1.663838000e+00f, 1.661792000e+00f,
                1.659746000e+00f, 1.657700000e+00f, 1.655654000e+00f, 7.154180000e-01f, 7.145820000e-01f,
                7.137460000e-01f, 7.129100000e-01f, 7.120740000e-01f, 7.112380000e-01f, 7.104020000e-01f,
                6.510460000e-01f, 6.502100000e-01f, 6.493740000e-01f, 6.485380000e-01f, 6.477020000e-01f,
                6.468660000e-01f, 6.460300000e-01f, 1.461086000e+00f, 1.459172000e+00f, 1.457258000e+00f,
                1.455344000e+00f, 1.453430000e+00f, 1.451516000e+00f, 1.449602000e+00f, 7.914060000e-01f,
                7.903280000e-01f, 7.892500000e-01f, 7.881720000e-01f, 7.870940000e-01f, 7.860160000e-01f,
                7.849380000e-01f, 1.741806000e+00f, 1.739408000e+00f, 1.737010000e+00f, 1.734612000e+00f,
                1.732214000e+00f, 1.729816000e+00f, 1.727418000e+00f, 9.317660000e-01f, 9.304460000e-01f,
                9.291260000e-01f, 9.278060000e-01f, 9.264860000e-01f, 9.251660000e-01f, 9.238460000e-01f,
                2.022526000e+00f, 2.019644000e+00f, 2.016762000e+00f, 2.013880000e+00f, 2.010998000e+00f,
                2.008116000e+00f, 2.005234000e+00f, 1.072126000e+00f, 1.070564000e+00f, 1.069002000e+00f,
                1.067440000e+00f, 1.065878000e+00f, 1.064316000e+00f, 1.062754000e+00f, 2.303246000e+00f,
                2.299880000e+00f, 2.296514000e+00f, 2.293148000e+00f, 2.289782000e+00f, 2.286416000e+00f,
                2.283050000e+00f, 1.212486000e+00f, 1.210682000e+00f, 1.208878000e+00f, 1.207074000e+00f,
                1.205270000e+00f, 1.203466000e+00f, 1.201662000e+00f, 2.583966000e+00f, 2.580116000e+00f,
                2.576266000e+00f, 2.572416000e+00f, 2.568566000e+00f, 2.564716000e+00f, 2.560866000e+00f,
                1.352846000e+00f, 1.350800000e+00f, 1.348754000e+00f, 1.346708000e+00f, 1.344662000e+00f,
                1.342616000e+00f, 1.340570000e+00f, 1.195304000e+00f, 1.193258000e+00f, 1.191212000e+00f,
                1.189166000e+00f, 1.187120000e+00f, 1.185074000e+00f, 1.183028000e+00f, 2.207865000e+00f,
                2.205522000e+00f, 2.203179000e+00f, 2.200836000e+00f, 2.198493000e+00f, 2.196150000e+00f,
                2.193807000e+00f, 2.027454000e+00f, 2.025111000e+00f, 2.022768000e+00f, 2.020425000e+00f,
                2.018082000e+00f, 2.015739000e+00f, 2.013396000e+00f, 4.293399000e+00f, 4.288350000e+00f,
                4.283301000e+00f, 4.278252000e+00f, 4.273203000e+00f, 4.268154000e+00f, 4.263105000e+00f,
                2.237994000e+00f, 2.235288000e+00f, 2.232582000e+00f, 2.229876000e+00f, 2.227170000e+00f,
                2.224464000e+00f, 2.221758000e+00f, 4.714479000e+00f, 4.708704000e+00f, 4.702929000e+00f,
                4.697154000e+00f, 4.691379000e+00f, 4.685604000e+00f, 4.679829000e+00f, 2.448534000e+00f,
                2.445465000e+00f, 2.442396000e+00f, 2.439327000e+00f, 2.436258000e+00f, 2.433189000e+00f,
                2.430120000e+00f, 5.135559000e+00f, 5.129058000e+00f, 5.122557000e+00f, 5.116056000e+00f,
                5.109555000e+00f, 5.103054000e+00f, 5.096553000e+00f, 2.659074000e+00f, 2.655642000e+00f,
                2.652210000e+00f, 2.648778000e+00f, 2.645346000e+00f, 2.641914000e+00f, 2.638482000e+00f,
                5.556639000e+00f, 5.549412000e+00f, 5.542185000e+00f, 5.534958000e+00f, 5.527731000e+00f,
                5.520504000e+00f, 5.513277000e+00f, 2.869614000e+00f, 2.865819000e+00f, 2.862024000e+00f,
                2.858229000e+00f, 2.854434000e+00f, 2.850639000e+00f, 2.846844000e+00f, 5.977719000e+00f,
                5.969766000e+00f, 5.961813000e+00f, 5.953860000e+00f, 5.945907000e+00f, 5.937954000e+00f,
                5.930001000e+00f, 3.080154000e+00f, 3.075996000e+00f, 3.071838000e+00f, 3.067680000e+00f,
                3.063522000e+00f, 3.059364000e+00f, 3.055206000e+00f, 2.759988000e+00f, 2.755830000e+00f,
                2.751672000e+00f, 2.747514000e+00f, 2.743356000e+00f, 2.739198000e+00f, 2.735040000e+00f,
                1.669382000e+00f, 1.667094000e+00f, 1.664806000e+00f, 1.662518000e+00f, 1.660230000e+00f,
                1.657942000e+00f, 1.655654000e+00f, 1.493206000e+00f, 1.490918000e+00f, 1.488630000e+00f,
                1.486342000e+00f, 1.484054000e+00f, 1.481766000e+00f, 1.479478000e+00f, 3.145406000e+00f,
                3.140588000e+00f, 3.135770000e+00f, 3.130952000e+00f, 3.126134000e+00f, 3.121316000e+00f,
                3.116498000e+00f, 1.633566000e+00f, 1.631036000e+00f, 1.628506000e+00f, 1.625976000e+00f,
                1.623446000e+00f, 1.620916000e+00f, 1.618386000e+00f, 3.426126000e+00f, 3.420824000e+00f,
                3.415522000e+00f, 3.410220000e+00f, 3.404918000e+00f, 3.399616000e+00f, 3.394314000e+00f,
                1.773926000e+00f, 1.771154000e+00f, 1.768382000e+00f, 1.765610000e+00f, 1.762838000e+00f,
                1.760066000e+00f, 1.757294000e+00f, 3.706846000e+00f, 3.701060000e+00f, 3.695274000e+00f,
                3.689488000e+00f, 3.683702000e+00f, 3.677916000e+00f, 3.672130000e+00f, 1.914286000e+00f,
                1.911272000e+00f, 1.908258000e+00f, 1.905244000e+00f, 1.902230000e+00f, 1.899216000e+00f,
                1.896202000e+00f, 3.987566000e+00f, 3.981296000e+00f, 3.975026000e+00f, 3.968756000e+00f,
                3.962486000e+00f, 3.956216000e+00f, 3.949946000e+00f, 2.054646000e+00f, 2.051390000e+00f,
                2.048134000e+00f, 2.044878000e+00f, 2.041622000e+00f, 2.038366000e+00f, 2.035110000e+00f,
                4.268286000e+00f, 4.261532000e+00f, 4.254778000e+00f, 4.248024000e+00f, 4.241270000e+00f,
                4.234516000e+00f, 4.227762000e+00f, 2.195006000e+00f, 2.191508000e+00f, 2.188010000e+00f,
                2.184512000e+00f, 2.181014000e+00f, 2.177516000e+00f, 2.174018000e+00f, 1.925660000e+00f,
                1.922162000e+00f, 1.918664000e+00f, 1.915166000e+00f, 1.911668000e+00f, 1.908170000e+00f,
                1.904672000e+00f, 3.638811000e+00f, 3.634290000e+00f, 3.629769000e+00f, 3.625248000e+00f,
                3.620727000e+00f, 3.616206000e+00f, 3.611685000e+00f, 3.290694000e+00f, 3.286173000e+00f,
                3.281652000e+00f, 3.277131000e+00f, 3.272610000e+00f, 3.268089000e+00f, 3.263568000e+00f,
                6.819879000e+00f, 6.810474000e+00f, 6.801069000e+00f, 6.791664000e+00f, 6.782259000e+00f,
                6.772854000e+00f, 6.763449000e+00f, 3.501234000e+00f, 3.496350000e+00f, 3.491466000e+00f,
                3.486582000e+00f, 3.481698000e+00f, 3.476814000e+00f, 3.471930000e+00f, 7.240959000e+00f,
                7.230828000e+00f, 7.220697000e+00f, 7.210566000e+00f, 7.200435000e+00f, 7.190304000e+00f,
                7.180173000e+00f, 3.711774000e+00f, 3.706527000e+00f, 3.701280000e+00f, 3.696033000e+00f,
                3.690786000e+00f, 3.685539000e+00f, 3.680292000e+00f, 7.662039000e+00f, 7.651182000e+00f,
                7.640325000e+00f, 7.629468000e+00f, 7.618611000e+00f, 7.607754000e+00f, 7.596897000e+00f,
                3.922314000e+00f, 3.916704000e+00f, 3.911094000e+00f, 3.905484000e+00f, 3.899874000e+00f,
                3.894264000e+00f, 3.888654000e+00f, 8.083119000e+00f, 8.071536000e+00f, 8.059953000e+00f,
                8.048370000e+00f, 8.036787000e+00f, 8.025204000e+00f, 8.013621000e+00f, 4.132854000e+00f,
                4.126881000e+00f, 4.120908000e+00f, 4.114935000e+00f, 4.108962000e+00f, 4.102989000e+00f,
                4.097016000e+00f, 8.504199000e+00f, 8.491890000e+00f, 8.479581000e+00f, 8.467272000e+00f,
                8.454963000e+00f, 8.442654000e+00f, 8.430345000e+00f, 4.343394000e+00f, 4.337058000e+00f,
                4.330722000e+00f, 4.324386000e+00f, 4.318050000e+00f, 4.311714000e+00f, 4.305378000e+00f,
                3.855522000e+00f, 3.849186000e+00f, 3.842850000e+00f, 3.836514000e+00f, 3.830178000e+00f,
                3.823842000e+00f, 3.817506000e+00f, 2.623346000e+00f, 2.619606000e+00f, 2.615866000e+00f,
                2.612126000e+00f, 2.608386000e+00f, 2.604646000e+00f, 2.600906000e+00f, 2.335366000e+00f,
                2.331626000e+00f, 2.327886000e+00f, 2.324146000e+00f, 2.320406000e+00f, 2.316666000e+00f,
                2.312926000e+00f, 4.829726000e+00f, 4.822004000e+00f, 4.814282000e+00f, 4.806560000e+00f,
                4.798838000e+00f, 4.791116000e+00f, 4.783394000e+00f, 2.475726000e+00f, 2.471744000e+00f,
                2.467762000e+00f, 2.463780000e+00f, 2.459798000e+00f, 2.455816000e+00f, 2.451834000e+00f,
                5.110446000e+00f, 5.102240000e+00f, 5.094034000e+00f, 5.085828000e+00f, 5.077622000e+00f,
                5.069416000e+00f, 5.061210000e+00f, 2.616086000e+00f, 2.611862000e+00f, 2.607638000e+00f,
                2.603414000e+00f, 2.599190000e+00f, 2.594966000e+00f, 2.590742000e+00f, 5.391166000e+00f,
                5.382476000e+00f, 5.373786000e+00f, 5.365096000e+00f, 5.356406000e+00f, 5.347716000e+00f,
                5.339026000e+00f, 2.756446000e+00f, 2.751980000e+00f, 2.747514000e+00f, 2.743048000e+00f,
                2.738582000e+00f, 2.734116000e+00f, 2.729650000e+00f, 5.671886000e+00f, 5.662712000e+00f,
                5.653538000e+00f, 5.644364000e+00f, 5.635190000e+00f, 5.626016000e+00f, 5.616842000e+00f,
                2.896806000e+00f, 2.892098000e+00f, 2.887390000e+00f, 2.882682000e+00f, 2.877974000e+00f,
                2.873266000e+00f, 2.868558000e+00f, 5.952606000e+00f, 5.942948000e+00f, 5.933290000e+00f,
                5.923632000e+00f, 5.913974000e+00f, 5.904316000e+00f, 5.894658000e+00f, 3.037166000e+00f,
                3.032216000e+00f, 3.027266000e+00f, 3.022316000e+00f, 3.017366000e+00f, 3.012416000e+00f,
                3.007466000e+00f, 2.656016000e+00f, 2.651066000e+00f, 2.646116000e+00f, 2.641166000e+00f,
                2.636216000e+00f, 2.631266000e+00f, 2.626316000e+00f, 5.069757000e+00f, 5.063058000e+00f,
                5.056359000e+00f, 5.049660000e+00f, 5.042961000e+00f, 5.036262000e+00f, 5.029563000e+00f,
                4.553934000e+00f, 4.547235000e+00f, 4.540536000e+00f, 4.533837000e+00f, 4.527138000e+00f,
                4.520439000e+00f, 4.513740000e+00f, 9.346359000e+00f, 9.332598000e+00f, 9.318837000e+00f,
                9.305076000e+00f, 9.291315000e+00f, 9.277554000e+00f, 9.263793000e+00f, 4.764474000e+00f,
                4.757412000e+00f, 4.750350000e+00f, 4.743288000e+00f, 4.736226000e+00f, 4.729164000e+00f,
                4.722102000e+00f, 9.767439000e+00f, 9.752952000e+00f, 9.738465000e+00f, 9.723978000e+00f,
                9.709491000e+00f, 9.695004000e+00f, 9.680517000e+00f, 4.975014000e+00f, 4.967589000e+00f,
                4.960164000e+00f, 4.952739000e+00f, 4.945314000e+00f, 4.937889000e+00f, 4.930464000e+00f,
                1.018851900e+01f, 1.017330600e+01f, 1.015809300e+01f, 1.014288000e+01f, 1.012766700e+01f,
                1.011245400e+01f, 1.009724100e+01f, 5.185554000e+00f, 5.177766000e+00f, 5.169978000e+00f,
                5.162190000e+00f, 5.154402000e+00f, 5.146614000e+00f, 5.138826000e+00f, 1.060959900e+01f,
                1.059366000e+01f, 1.057772100e+01f, 1.056178200e+01f, 1.054584300e+01f, 1.052990400e+01f,
                1.051396500e+01f, 5.396094000e+00f, 5.387943000e+00f, 5.379792000e+00f, 5.371641000e+00f,
                5.363490000e+00f, 5.355339000e+00f, 5.347188000e+00f, 1.103067900e+01f, 1.101401400e+01f,
                1.099734900e+01f, 1.098068400e+01f, 1.096401900e+01f, 1.094735400e+01f, 1.093068900e+01f,
                5.606634000e+00f, 5.598120000e+00f, 5.589606000e+00f, 5.581092000e+00f, 5.572578000e+00f,
                5.564064000e+00f, 5.555550000e+00f, 4.951056000e+00f, 4.942542000e+00f, 4.934028000e+00f,
                4.925514000e+00f, 4.917000000e+00f, 4.908486000e+00f, 4.899972000e+00f, 3.577310000e+00f,
                3.572118000e+00f, 3.566926000e+00f, 3.561734000e+00f, 3.556542000e+00f, 3.551350000e+00f,
                3.546158000e+00f, 3.177526000e+00f, 3.172334000e+00f, 3.167142000e+00f, 3.161950000e+00f,
                3.156758000e+00f, 3.151566000e+00f, 3.146374000e+00f, 6.514046000e+00f, 6.503420000e+00f,
                6.492794000e+00f, 6.482168000e+00f, 6.471542000e+00f, 6.460916000e+00f, 6.450290000e+00f,
                3.317886000e+00f, 3.312452000e+00f, 3.307018000e+00f, 3.301584000e+00f, 3.296150000e+00f,
                3.290716000e+00f, 3.285282000e+00f, 6.794766000e+00f, 6.783656000e+00f, 6.772546000e+00f,
                6.761436000e+00f, 6.750326000e+00f, 6.739216000e+00f, 6.728106000e+00f, 3.458246000e+00f,
                3.452570000e+00f, 3.446894000e+00f, 3.441218000e+00f, 3.435542000e+00f, 3.429866000e+00f,
                3.424190000e+00f, 7.075486000e+00f, 7.063892000e+00f, 7.052298000e+00f, 7.040704000e+00f,
                7.029110000e+00f, 7.017516000e+00f, 7.005922000e+00f, 3.598606000e+00f, 3.592688000e+00f,
                3.586770000e+00f, 3.580852000e+00f, 3.574934000e+00f, 3.569016000e+00f, 3.563098000e+00f,
                7.356206000e+00f, 7.344128000e+00f, 7.332050000e+00f, 7.319972000e+00f, 7.307894000e+00f,
                7.295816000e+00f, 7.283738000e+00f, 3.738966000e+00f, 3.732806000e+00f, 3.726646000e+00f,
                3.720486000e+00f, 3.714326000e+00f, 3.708166000e+00f, 3.702006000e+00f, 7.636926000e+00f,
                7.624364000e+00f, 7.611802000e+00f, 7.599240000e+00f, 7.586678000e+00f, 7.574116000e+00f,
                7.561554000e+00f, 3.879326000e+00f, 3.872924000e+00f, 3.866522000e+00f, 3.860120000e+00f,
                3.853718000e+00f, 3.847316000e+00f, 3.840914000e+00f, 3.386372000e+00f, 3.379970000e+00f,
                3.373568000e+00f, 3.367166000e+00f, 3.360764000e+00f, 3.354362000e+00f, 3.347960000e+00f,
                6.500703000e+00f, 6.491826000e+00f, 6.482949000e+00f, 6.474072000e+00f, 6.465195000e+00f,
                6.456318000e+00f, 6.447441000e+00f, 5.817174000e+00f, 5.808297000e+00f, 5.799420000e+00f,
                5.790543000e+00f, 5.781666000e+00f, 5.772789000e+00f, 5.763912000e+00f, 1.187283900e+01f,
                1.185472200e+01f, 1.183660500e+01f, 1.181848800e+01f, 1.180037100e+01f, 1.178225400e+01f,
                1.176413700e+01f, 6.027714000e+00f, 6.018474000e+00f, 6.009234000e+00f, 5.999994000e+00f,
                5.990754000e+00f, 5.981514000e+00f, 5.972274000e+00f, 1.229391900e+01f, 1.227507600e+01f,
                1.225623300e+01f, 1.223739000e+01f, 1.221854700e+01f, 1.219970400e+01f, 1.218086100e+01f,
                6.238254000e+00f, 6.228651000e+00f, 6.219048000e+00f, 6.209445000e+00f, 6.199842000e+00f,
                6.190239000e+00f, 6.180636000e+00f, 1.271499900e+01f, 1.269543000e+01f, 1.267586100e+01f,
                1.265629200e+01f, 1.263672300e+01f, 1.261715400e+01f, 1.259758500e+01f, 6.448794000e+00f,
                6.438828000e+00f, 6.428862000e+00f, 6.418896000e+00f, 6.408930000e+00f, 6.398964000e+00f,
                6.388998000e+00f, 1.313607900e+01f, 1.311578400e+01f, 1.309548900e+01f, 1.307519400e+01f,
                1.305489900e+01f, 1.303460400e+01f, 1.301430900e+01f, 6.659334000e+00f, 6.649005000e+00f,
                6.638676000e+00f, 6.628347000e+00f, 6.618018000e+00f, 6.607689000e+00f, 6.597360000e+00f,
                1.355715900e+01f, 1.353613800e+01f, 1.351511700e+01f, 1.349409600e+01f, 1.347307500e+01f,
                1.345205400e+01f, 1.343103300e+01f, 6.869874000e+00f, 6.859182000e+00f, 6.848490000e+00f,
                6.837798000e+00f, 6.827106000e+00f, 6.816414000e+00f, 6.805722000e+00f, 6.046590000e+00f,
                6.035898000e+00f, 6.025206000e+00f, 6.014514000e+00f, 6.003822000e+00f, 5.993130000e+00f,
                5.982438000e+00f, 4.531274000e+00f, 4.524630000e+00f, 4.517986000e+00f, 4.511342000e+00f,
                4.504698000e+00f, 4.498054000e+00f, 4.491410000e+00f, 4.019686000e+00f, 4.013042000e+00f,
                4.006398000e+00f, 3.999754000e+00f, 3.993110000e+00f, 3.986466000e+00f, 3.979822000e+00f,
                8.198366000e+00f, 8.184836000e+00f, 8.171306000e+00f, 8.157776000e+00f, 8.144246000e+00f,
                8.130716000e+00f, 8.117186000e+00f, 4.160046000e+00f, 4.153160000e+00f, 4.146274000e+00f,
                4.139388000e+00f, 4.132502000e+00f, 4.125616000e+00f, 4.118730000e+00f, 8.479086000e+00f,
                8.465072000e+00f, 8.451058000e+00f, 8.437044000e+00f, 8.423030000e+00f, 8.409016000e+00f,
                8.395002000e+00f, 4.300406000e+00f, 4.293278000e+00f, 4.286150000e+00f, 4.279022000e+00f,
                4.271894000e+00f, 4.264766000e+00f, 4.257638000e+00f, 8.759806000e+00f, 8.745308000e+00f,
                8.730810000e+00f, 8.716312000e+00f, 8.701814000e+00f, 8.687316000e+00f, 8.672818000e+00f,
                4.440766000e+00f, 4.433396000e+00f, 4.426026000e+00f, 4.418656000e+00f, 4.411286000e+00f,
                4.403916000e+00f, 4.396546000e+00f, 9.040526000e+00f, 9.025544000e+00f, 9.010562000e+00f,
                8.995580000e+00f, 8.980598000e+00f, 8.965616000e+00f, 8.950634000e+00f, 4.581126000e+00f,
                4.573514000e+00f, 4.565902000e+00f, 4.558290000e+00f, 4.550678000e+00f, 4.543066000e+00f,
                4.535454000e+00f, 9.321246000e+00f, 9.305780000e+00f, 9.290314000e+00f, 9.274848000e+00f,
                9.259382000e+00f, 9.243916000e+00f, 9.228450000e+00f, 4.721486000e+00f, 4.713632000e+00f,
                4.705778000e+00f, 4.697924000e+00f, 4.690070000e+00f, 4.682216000e+00f, 4.674362000e+00f,
                4.116728000e+00f, 4.108874000e+00f, 4.101020000e+00f, 4.093166000e+00f, 4.085312000e+00f,
                4.077458000e+00f, 4.069604000e+00f, 7.931649000e+00f, 7.920594000e+00f, 7.909539000e+00f,
                7.898484000e+00f, 7.887429000e+00f, 7.876374000e+00f, 7.865319000e+00f, 7.080414000e+00f,
                7.069359000e+00f, 7.058304000e+00f, 7.047249000e+00f, 7.036194000e+00f, 7.025139000e+00f,
                7.014084000e+00f, 1.439931900e+01f, 1.437684600e+01f, 1.435437300e+01f, 1.433190000e+01f,
                1.430942700e+01f, 1.428695400e+01f, 1.426448100e+01f, 7.290954000e+00f, 7.279536000e+00f,
                7.268118000e+00f, 7.256700000e+00f, 7.245282000e+00f, 7.233864000e+00f, 7.222446000e+00f,
                1.482039900e+01f, 1.479720000e+01f, 1.477400100e+01f, 1.475080200e+01f, 1.472760300e+01f,
                1.470440400e+01f, 1.468120500e+01f, 7.501494000e+00f, 7.489713000e+00f, 7.477932000e+00f,
                7.466151000e+00f, 7.454370000e+00f, 7.442589000e+00f, 7.430808000e+00f, 1.524147900e+01f,
                1.521755400e+01f, 1.519362900e+01f, 1.516970400e+01f, 1.514577900e+01f, 1.512185400e+01f,
                1.509792900e+01f, 7.712034000e+00f, 7.699890000e+00f, 7.687746000e+00f, 7.675602000e+00f,
                7.663458000e+00f, 7.651314000e+00f, 7.639170000e+00f, 1.566255900e+01f, 1.563790800e+01f,
                1.561325700e+01f, 1.558860600e+01f, 1.556395500e+01f, 1.553930400e+01f, 1.551465300e+01f,
                7.922574000e+00f, 7.910067000e+00f, 7.897560000e+00f, 7.885053000e+00f, 7.872546000e+00f,
                7.860039000e+00f, 7.847532000e+00f, 1.608363900e+01f, 1.605826200e+01f, 1.603288500e+01f,
                1.600750800e+01f, 1.598213100e+01f, 1.595675400e+01f, 1.593137700e+01f, 8.133114000e+00f,
                8.120244000e+00f, 8.107374000e+00f, 8.094504000e+00f, 8.081634000e+00f, 8.068764000e+00f,
                8.055894000e+00f, 7.142124000e+00f, 7.129254000e+00f, 7.116384000e+00f, 7.103514000e+00f,
                7.090644000e+00f, 7.077774000e+00f, 7.064904000e+00f, 5.485238000e+00f, 5.477142000e+00f,
                5.469046000e+00f, 5.460950000e+00f, 5.452854000e+00f, 5.444758000e+00f, 5.436662000e+00f,
                4.861846000e+00f, 4.853750000e+00f, 4.845654000e+00f, 4.837558000e+00f, 4.829462000e+00f,
                4.821366000e+00f, 4.813270000e+00f, 9.882686000e+00f, 9.866252000e+00f, 9.849818000e+00f,
                9.833384000e+00f, 9.816950000e+00f, 9.800516000e+00f, 9.784082000e+00f, 5.002206000e+00f,
                4.993868000e+00f, 4.985530000e+00f, 4.977192000e+00f, 4.968854000e+00f, 4.960516000e+00f,
                4.952178000e+00f, 1.016340600e+01f, 1.014648800e+01f, 1.012957000e+01f, 1.011265200e+01f,
                1.009573400e+01f, 1.007881600e+01f, 1.006189800e+01f, 5.142566000e+00f, 5.133986000e+00f,
                5.125406000e+00f, 5.116826000e+00f, 5.108246000e+00f, 5.099666000e+00f, 5.091086000e+00f,
                1.044412600e+01f, 1.042672400e+01f, 1.040932200e+01f, 1.039192000e+01f, 1.037451800e+01f,
                1.035711600e+01f, 1.033971400e+01f, 5.282926000e+00f, 5.274104000e+00f, 5.265282000e+00f,
                5.256460000e+00f, 5.247638000e+00f, 5.238816000e+00f, 5.229994000e+00f, 1.072484600e+01f,
                1.070696000e+01f, 1.068907400e+01f, 1.067118800e+01f, 1.065330200e+01f, 1.063541600e+01f,
                1.061753000e+01f, 5.423286000e+00f, 5.414222000e+00f, 5.405158000e+00f, 5.396094000e+00f,
                5.387030000e+00f, 5.377966000e+00f, 5.368902000e+00f, 1.100556600e+01f, 1.098719600e+01f,
                1.096882600e+01f, 1.095045600e+01f, 1.093208600e+01f, 1.091371600e+01f, 1.089534600e+01f,
                5.563646000e+00f, 5.554340000e+00f, 5.545034000e+00f, 5.535728000e+00f, 5.526422000e+00f,
                5.517116000e+00f, 5.507810000e+00f, 4.847084000e+00f, 4.837778000e+00f, 4.828472000e+00f,
                4.819166000e+00f, 4.809860000e+00f, 4.800554000e+00f, 4.791248000e+00f, 3.615062000e+00f,
                3.606966000e+00f, 3.598870000e+00f, 3.590774000e+00f, 3.582678000e+00f, 3.574582000e+00f,
                3.566486000e+00f, 2.991670000e+00f, 2.983574000e+00f, 2.975478000e+00f, 2.967382000e+00f,
                2.959286000e+00f, 2.951190000e+00f, 2.943094000e+00f, 6.086432000e+00f, 6.069998000e+00f,
                6.053564000e+00f, 6.037130000e+00f, 6.020696000e+00f, 6.004262000e+00f, 5.987828000e+00f,
                3.076128000e+00f, 3.067790000e+00f, 3.059452000e+00f, 3.051114000e+00f, 3.042776000e+00f,
                3.034438000e+00f, 3.026100000e+00f, 6.255348000e+00f, 6.238430000e+00f, 6.221512000e+00f,
                6.204594000e+00f, 6.187676000e+00f, 6.170758000e+00f, 6.153840000e+00f, 3.160586000e+00f,
                3.152006000e+00f, 3.143426000e+00f, 3.134846000e+00f, 3.126266000e+00f, 3.117686000e+00f,
                3.109106000e+00f, 6.424264000e+00f, 6.406862000e+00f, 6.389460000e+00f, 6.372058000e+00f,
                6.354656000e+00f, 6.337254000e+00f, 6.319852000e+00f, 3.245044000e+00f, 3.236222000e+00f,
                3.227400000e+00f, 3.218578000e+00f, 3.209756000e+00f, 3.200934000e+00f, 3.192112000e+00f,
                6.593180000e+00f, 6.575294000e+00f, 6.557408000e+00f, 6.539522000e+00f, 6.521636000e+00f,
                6.503750000e+00f, 6.485864000e+00f, 3.329502000e+00f, 3.320438000e+00f, 3.311374000e+00f,
                3.302310000e+00f, 3.293246000e+00f, 3.284182000e+00f, 3.275118000e+00f, 6.762096000e+00f,
                6.743726000e+00f, 6.725356000e+00f, 6.706986000e+00f, 6.688616000e+00f, 6.670246000e+00f,
                6.651876000e+00f, 3.413960000e+00f, 3.404654000e+00f, 3.395348000e+00f, 3.386042000e+00f,
                3.376736000e+00f, 3.367430000e+00f, 3.358124000e+00f, 2.697398000e+00f, 2.688092000e+00f,
                2.678786000e+00f, 2.669480000e+00f, 2.660174000e+00f, 2.650868000e+00f, 2.641562000e+00f,
                1.878316000e+00f, 1.873905000e+00f, 1.869494000e+00f, 1.865083000e+00f, 1.860672000e+00f,
                1.856261000e+00f, 1.851850000e+00f, 1.538669000e+00f, 1.534258000e+00f, 1.529847000e+00f,
                1.525436000e+00f, 1.521025000e+00f, 1.516614000e+00f, 1.512203000e+00f, 3.128884000e+00f,
                3.119941000e+00f, 3.110998000e+00f, 3.102055000e+00f, 3.093112000e+00f, 3.084169000e+00f,
                3.075226000e+00f, 1.580898000e+00f, 1.576366000e+00f, 1.571834000e+00f, 1.567302000e+00f,
                1.562770000e+00f, 1.558238000e+00f, 1.553706000e+00f, 3.213342000e+00f, 3.204157000e+00f,
                3.194972000e+00f, 3.185787000e+00f, 3.176602000e+00f, 3.167417000e+00f, 3.158232000e+00f,
                1.623127000e+00f, 1.618474000e+00f, 1.613821000e+00f, 1.609168000e+00f, 1.604515000e+00f,
                1.599862000e+00f, 1.595209000e+00f, 3.297800000e+00f, 3.288373000e+00f, 3.278946000e+00f,
                3.269519000e+00f, 3.260092000e+00f, 3.250665000e+00f, 3.241238000e+00f, 1.665356000e+00f,
                1.660582000e+00f, 1.655808000e+00f, 1.651034000e+00f, 1.646260000e+00f, 1.641486000e+00f,
                1.636712000e+00f, 3.382258000e+00f, 3.372589000e+00f, 3.362920000e+00f, 3.353251000e+00f,
                3.343582000e+00f, 3.333913000e+00f, 3.324244000e+00f, 1.707585000e+00f, 1.702690000e+00f,
                1.697795000e+00f, 1.692900000e+00f, 1.688005000e+00f, 1.683110000e+00f, 1.678215000e+00f,
                3.466716000e+00f, 3.456805000e+00f, 3.446894000e+00f, 3.436983000e+00f, 3.427072000e+00f,
                3.417161000e+00f, 3.407250000e+00f, 1.749814000e+00f, 1.744798000e+00f, 1.739782000e+00f,
                1.734766000e+00f, 1.729750000e+00f, 1.724734000e+00f, 1.719718000e+00f, 1.363582000e+00f,
                1.358566000e+00f, 1.353550000e+00f, 1.348534000e+00f, 1.343518000e+00f, 1.338502000e+00f,
                1.333486000e+00f, 8.593750000e-01f, 8.549640000e-01f, 8.505530000e-01f, 8.461420000e-01f,
                8.417310000e-01f, 8.373200000e-01f, 8.329090000e-01f, 5.197280000e-01f, 5.153170000e-01f,
                5.109060000e-01f, 5.064950000e-01f, 5.020840000e-01f, 4.976730000e-01f, 4.932620000e-01f,
                1.063051000e+00f, 1.054108000e+00f, 1.045165000e+00f, 1.036222000e+00f, 1.027279000e+00f,
                1.018336000e+00f, 1.009393000e+00f, 5.340060000e-01f, 5.294740000e-01f, 5.249420000e-01f,
                5.204100000e-01f, 5.158780000e-01f, 5.113460000e-01f, 5.068140000e-01f, 1.091607000e+00f,
                1.082422000e+00f, 1.073237000e+00f, 1.064052000e+00f, 1.054867000e+00f, 1.045682000e+00f,
                1.036497000e+00f, 5.482840000e-01f, 5.436310000e-01f, 5.389780000e-01f, 5.343250000e-01f,
                5.296720000e-01f, 5.250190000e-01f, 5.203660000e-01f, 1.120163000e+00f, 1.110736000e+00f,
                1.101309000e+00f, 1.091882000e+00f, 1.082455000e+00f, 1.073028000e+00f, 1.063601000e+00f,
                5.625620000e-01f, 5.577880000e-01f, 5.530140000e-01f, 5.482400000e-01f, 5.434660000e-01f,
                5.386920000e-01f, 5.339180000e-01f, 1.148719000e+00f, 1.139050000e+00f, 1.129381000e+00f,
                1.119712000e+00f, 1.110043000e+00f, 1.100374000e+00f, 1.090705000e+00f, 5.768400000e-01f,
                5.719450000e-01f, 5.670500000e-01f, 5.621550000e-01f, 5.572600000e-01f, 5.523650000e-01f,
                5.474700000e-01f, 1.177275000e+00f, 1.167364000e+00f, 1.157453000e+00f, 1.147542000e+00f,
                1.137631000e+00f, 1.127720000e+00f, 1.117809000e+00f, 5.911180000e-01f, 5.861020000e-01f,
                5.810860000e-01f, 5.760700000e-01f, 5.710540000e-01f, 5.660380000e-01f, 5.610220000e-01f,
                2.048860000e-01f, 1.998700000e-01f, 1.948540000e-01f, 1.898380000e-01f, 1.848220000e-01f,
                1.798060000e-01f, 1.747900000e-01f, 5.747533000e+00f, 5.742396000e+00f, 5.737259000e+00f,
                5.732122000e+00f, 5.726985000e+00f, 5.721848000e+00f, 5.716711000e+00f, 5.351984000e+00f,
                5.346847000e+00f, 5.341710000e+00f, 5.336573000e+00f, 5.331436000e+00f, 5.326299000e+00f,
                5.321162000e+00f, 1.083936700e+01f, 1.082897200e+01f, 1.081857700e+01f, 1.080818200e+01f,
                1.079778700e+01f, 1.078739200e+01f, 1.077699700e+01f, 5.478066000e+00f, 5.472808000e+00f,
                5.467550000e+00f, 5.462292000e+00f, 5.457034000e+00f, 5.451776000e+00f, 5.446518000e+00f,
                1.109153100e+01f, 1.108089400e+01f, 1.107025700e+01f, 1.105962000e+01f, 1.104898300e+01f,
                1.103834600e+01f, 1.102770900e+01f, 5.604148000e+00f, 5.598769000e+00f, 5.593390000e+00f,
                5.588011000e+00f, 5.582632000e+00f, 5.577253000e+00f, 5.571874000e+00f, 1.134369500e+01f,
                1.133281600e+01f, 1.132193700e+01f, 1.131105800e+01f, 1.130017900e+01f, 1.128930000e+01f,
                1.127842100e+01f, 5.730230000e+00f, 5.724730000e+00f, 5.719230000e+00f, 5.713730000e+00f,
                5.708230000e+00f, 5.702730000e+00f, 5.697230000e+00f, 1.159585900e+01f, 1.158473800e+01f,
                1.157361700e+01f, 1.156249600e+01f, 1.155137500e+01f, 1.154025400e+01f, 1.152913300e+01f,
                5.856312000e+00f, 5.850691000e+00f, 5.845070000e+00f, 5.839449000e+00f, 5.833828000e+00f,
                5.828207000e+00f, 5.822586000e+00f, 1.184802300e+01f, 1.183666000e+01f, 1.182529700e+01f,
                1.181393400e+01f, 1.180257100e+01f, 1.179120800e+01f, 1.177984500e+01f, 5.982394000e+00f,
                5.976652000e+00f, 5.970910000e+00f, 5.965168000e+00f, 5.959426000e+00f, 5.953684000e+00f,
                5.947942000e+00f, 5.540260000e+00f, 5.534518000e+00f, 5.528776000e+00f, 5.523034000e+00f,
                5.517292000e+00f, 5.511550000e+00f, 5.505808000e+00f, 4.560886000e+00f, 4.555749000e+00f,
                4.550612000e+00f, 4.545475000e+00f, 4.540338000e+00f, 4.535201000e+00f, 4.530064000e+00f,
                4.165337000e+00f, 4.160200000e+00f, 4.155063000e+00f, 4.149926000e+00f, 4.144789000e+00f,
                4.139652000e+00f, 4.134515000e+00f, 8.438122000e+00f, 8.427727000e+00f, 8.417332000e+00f,
                8.406937000e+00f, 8.396542000e+00f, 8.386147000e+00f, 8.375752000e+00f, 4.263468000e+00f,
                4.258210000e+00f, 4.252952000e+00f, 4.247694000e+00f, 4.242436000e+00f, 4.237178000e+00f,
                4.231920000e+00f, 8.634384000e+00f, 8.623747000e+00f, 8.613110000e+00f, 8.602473000e+00f,
                8.591836000e+00f, 8.581199000e+00f, 8.570562000e+00f, 4.361599000e+00f, 4.356220000e+00f,
                4.350841000e+00f, 4.345462000e+00f, 4.340083000e+00f, 4.334704000e+00f, 4.329325000e+00f,
                8.830646000e+00f, 8.819767000e+00f, 8.808888000e+00f, 8.798009000e+00f, 8.787130000e+00f,
                8.776251000e+00f, 8.765372000e+00f, 4.459730000e+00f, 4.454230000e+00f, 4.448730000e+00f,
                4.443230000e+00f, 4.437730000e+00f, 4.432230000e+00f, 4.426730000e+00f, 9.026908000e+00f,
                9.015787000e+00f, 9.004666000e+00f, 8.993545000e+00f, 8.982424000e+00f, 8.971303000e+00f,
                8.960182000e+00f, 4.557861000e+00f, 4.552240000e+00f, 4.546619000e+00f, 4.540998000e+00f,
                4.535377000e+00f, 4.529756000e+00f, 4.524135000e+00f, 9.223170000e+00f, 9.211807000e+00f,
                9.200444000e+00f, 9.189081000e+00f, 9.177718000e+00f, 9.166355000e+00f, 9.154992000e+00f,
                4.655992000e+00f, 4.650250000e+00f, 4.644508000e+00f, 4.638766000e+00f, 4.633024000e+00f,
                4.627282000e+00f, 4.621540000e+00f, 4.213858000e+00f, 4.208116000e+00f, 4.202374000e+00f,
                4.196632000e+00f, 4.190890000e+00f, 4.185148000e+00f, 4.179406000e+00f, 9.934166000e+00f,
                9.923166000e+00f, 9.912166000e+00f, 9.901166000e+00f, 9.890166000e+00f, 9.879166000e+00f,
                9.868166000e+00f, 9.087166000e+00f, 9.076166000e+00f, 9.065166000e+00f, 9.054166000e+00f,
                9.043166000e+00f, 9.032166000e+00f, 9.021166000e+00f, 1.838922800e+01f, 1.836698600e+01f,
                1.834474400e+01f, 1.832250200e+01f, 1.830026000e+01f, 1.827801800e+01f, 1.825577600e+01f,
                9.283428000e+00f, 9.272186000e+00f, 9.260944000e+00f, 9.249702000e+00f, 9.238460000e+00f,
                9.227218000e+00f, 9.215976000e+00f, 1.878175200e+01f, 1.875902600e+01f, 1.873630000e+01f,
                1.871357400e+01f, 1.869084800e+01f, 1.866812200e+01f, 1.864539600e+01f, 9.479690000e+00f,
                9.468206000e+00f, 9.456722000e+00f, 9.445238000e+00f, 9.433754000e+00f, 9.422270000e+00f,
                9.410786000e+00f, 1.917427600e+01f, 1.915106600e+01f, 1.912785600e+01f, 1.910464600e+01f,
                1.908143600e+01f, 1.905822600e+01f, 1.903501600e+01f, 9.675952000e+00f, 9.664226000e+00f,
                9.652500000e+00f, 9.640774000e+00f, 9.629048000e+00f, 9.617322000e+00f, 9.605596000e+00f,
                1.956680000e+01f, 1.954310600e+01f, 1.951941200e+01f, 1.949571800e+01f, 1.947202400e+01f,
                1.944833000e+01f, 1.942463600e+01f, 9.872214000e+00f, 9.860246000e+00f, 9.848278000e+00f,
                9.836310000e+00f, 9.824342000e+00f, 9.812374000e+00f, 9.800406000e+00f, 1.995932400e+01f,
                1.993514600e+01f, 1.991096800e+01f, 1.988679000e+01f, 1.986261200e+01f, 1.983843400e+01f,
                1.981425600e+01f, 1.006847600e+01f, 1.005626600e+01f, 1.004405600e+01f, 1.003184600e+01f,
                1.001963600e+01f, 1.000742600e+01f, 9.995216000e+00f, 9.128306000e+00f, 9.116096000e+00f,
                9.103886000e+00f, 9.091676000e+00f, 9.079466000e+00f, 9.067256000e+00f, 9.055046000e+00f,
                7.393166000e+00f, 7.382166000e+00f, 7.371166000e+00f, 7.360166000e+00f, 7.349166000e+00f,
                7.338166000e+00f, 7.327166000e+00f, 6.546166000e+00f, 6.535166000e+00f, 6.524166000e+00f,
                6.513166000e+00f, 6.502166000e+00f, 6.491166000e+00f, 6.480166000e+00f, 1.325132600e+01f,
                1.322908400e+01f, 1.320684200e+01f, 1.318460000e+01f, 1.316235800e+01f, 1.314011600e+01f,
                1.311787400e+01f, 6.686526000e+00f, 6.675284000e+00f, 6.664042000e+00f, 6.652800000e+00f,
                6.641558000e+00f, 6.630316000e+00f, 6.619074000e+00f, 1.353204600e+01f, 1.350932000e+01f,
                1.348659400e+01f, 1.346386800e+01f, 1.344114200e+01f, 1.341841600e+01f, 1.339569000e+01f,
                6.826886000e+00f, 6.815402000e+00f, 6.803918000e+00f, 6.792434000e+00f, 6.780950000e+00f,
                6.769466000e+00f, 6.757982000e+00f, 1.381276600e+01f, 1.378955600e+01f, 1.376634600e+01f,
                1.374313600e+01f, 1.371992600e+01f, 1.369671600e+01f, 1.367350600e+01f, 6.967246000e+00f,
                6.955520000e+00f, 6.943794000e+00f, 6.932068000e+00f, 6.920342000e+00f, 6.908616000e+00f,
                6.896890000e+00f, 1.409348600e+01f, 1.406979200e+01f, 1.404609800e+01f, 1.402240400e+01f,
                1.399871000e+01f, 1.397501600e+01f, 1.395132200e+01f, 7.107606000e+00f, 7.095638000e+00f,
                7.083670000e+00f, 7.071702000e+00f, 7.059734000e+00f, 7.047766000e+00f, 7.035798000e+00f,
                1.437420600e+01f, 1.435002800e+01f, 1.432585000e+01f, 1.430167200e+01f, 1.427749400e+01f,
                1.425331600e+01f, 1.422913800e+01f, 7.247966000e+00f, 7.235756000e+00f, 7.223546000e+00f,
                7.211336000e+00f, 7.199126000e+00f, 7.186916000e+00f, 7.174706000e+00f, 6.307796000e+00f,
                6.295586000e+00f, 6.283376000e+00f, 6.271166000e+00f, 6.258956000e+00f, 6.246746000e+00f,
                6.234536000e+00f, 1.222448700e+01f, 1.220689800e+01f, 1.218930900e+01f, 1.217172000e+01f,
                1.215413100e+01f, 1.213654200e+01f, 1.211895300e+01f, 1.087013400e+01f, 1.085254500e+01f,
                1.083495600e+01f, 1.081736700e+01f, 1.079977800e+01f, 1.078218900e+01f, 1.076460000e+01f,
                2.197875900e+01f, 2.194321800e+01f, 2.190767700e+01f, 2.187213600e+01f, 2.183659500e+01f,
                2.180105400e+01f, 2.176551300e+01f, 1.108067400e+01f, 1.106272200e+01f, 1.104477000e+01f,
                1.102681800e+01f, 1.100886600e+01f, 1.099091400e+01f, 1.097296200e+01f, 2.239983900e+01f,
                2.236357200e+01f, 2.232730500e+01f, 2.229103800e+01f, 2.225477100e+01f, 2.221850400e+01f,
                2.218223700e+01f, 1.129121400e+01f, 1.127289900e+01f, 1.125458400e+01f, 1.123626900e+01f,
                1.121795400e+01f, 1.119963900e+01f, 1.118132400e+01f, 2.282091900e+01f, 2.278392600e+01f,
                2.274693300e+01f, 2.270994000e+01f, 2.267294700e+01f, 2.263595400e+01f, 2.259896100e+01f,
                1.150175400e+01f, 1.148307600e+01f, 1.146439800e+01f, 1.144572000e+01f, 1.142704200e+01f,
                1.140836400e+01f, 1.138968600e+01f, 2.324199900e+01f, 2.320428000e+01f, 2.316656100e+01f,
                2.312884200e+01f, 2.309112300e+01f, 2.305340400e+01f, 2.301568500e+01f, 1.171229400e+01f,
                1.169325300e+01f, 1.167421200e+01f, 1.165517100e+01f, 1.163613000e+01f, 1.161708900e+01f,
                1.159804800e+01f, 2.366307900e+01f, 2.362463400e+01f, 2.358618900e+01f, 2.354774400e+01f,
                2.350929900e+01f, 2.347085400e+01f, 2.343240900e+01f, 1.192283400e+01f, 1.190343000e+01f,
                1.188402600e+01f, 1.186462200e+01f, 1.184521800e+01f, 1.182581400e+01f, 1.180641000e+01f,
                1.042872600e+01f, 1.040932200e+01f, 1.038991800e+01f, 1.037051400e+01f, 1.035111000e+01f,
                1.033170600e+01f, 1.031230200e+01f, 8.347130000e+00f, 8.334678000e+00f, 8.322226000e+00f,
                8.309774000e+00f, 8.297322000e+00f, 8.284870000e+00f, 8.272418000e+00f, 7.388326000e+00f,
                7.375874000e+00f, 7.363422000e+00f, 7.350970000e+00f, 7.338518000e+00f, 7.326066000e+00f,
                7.313614000e+00f, 1.493564600e+01f, 1.491050000e+01f, 1.488535400e+01f, 1.486020800e+01f,
                1.483506200e+01f, 1.480991600e+01f, 1.478477000e+01f, 7.528686000e+00f, 7.515992000e+00f,
                7.503298000e+00f, 7.490604000e+00f, 7.477910000e+00f, 7.465216000e+00f, 7.452522000e+00f,
                1.521636600e+01f, 1.519073600e+01f, 1.516510600e+01f, 1.513947600e+01f, 1.511384600e+01f,
                1.508821600e+01f, 1.506258600e+01f, 7.669046000e+00f, 7.656110000e+00f, 7.643174000e+00f,
                7.630238000e+00f, 7.617302000e+00f, 7.604366000e+00f, 7.591430000e+00f, 1.549708600e+01f,
                1.547097200e+01f, 1.544485800e+01f, 1.541874400e+01f, 1.539263000e+01f, 1.536651600e+01f,
                1.534040200e+01f, 7.809406000e+00f, 7.796228000e+00f, 7.783050000e+00f, 7.769872000e+00f,
                7.756694000e+00f, 7.743516000e+00f, 7.730338000e+00f, 1.577780600e+01f, 1.575120800e+01f,
                1.572461000e+01f, 1.569801200e+01f, 1.567141400e+01f, 1.564481600e+01f, 1.561821800e+01f,
                7.949766000e+00f, 7.936346000e+00f, 7.922926000e+00f, 7.909506000e+00f, 7.896086000e+00f,
                7.882666000e+00f, 7.869246000e+00f, 1.605852600e+01f, 1.603144400e+01f, 1.600436200e+01f,
                1.597728000e+01f, 1.595019800e+01f, 1.592311600e+01f, 1.589603400e+01f, 8.090126000e+00f,
                8.076464000e+00f, 8.062802000e+00f, 8.049140000e+00f, 8.035478000e+00f, 8.021816000e+00f,
                8.008154000e+00f, 7.038152000e+00f, 7.024490000e+00f, 7.010828000e+00f, 6.997166000e+00f,
                6.983504000e+00f, 6.969842000e+00f, 6.956180000e+00f, 1.365543300e+01f, 1.363566600e+01f,
                1.361589900e+01f, 1.359613200e+01f, 1.357636500e+01f, 1.355659800e+01f, 1.353683100e+01f,
                1.213337400e+01f, 1.211360700e+01f, 1.209384000e+01f, 1.207407300e+01f, 1.205430600e+01f,
                1.203453900e+01f, 1.201477200e+01f, 2.450523900e+01f, 2.446534200e+01f, 2.442544500e+01f,
                2.438554800e+01f, 2.434565100e+01f, 2.430575400e+01f, 2.426585700e+01f, 1.234391400e+01f,
                1.232378400e+01f, 1.230365400e+01f, 1.228352400e+01f, 1.226339400e+01f, 1.224326400e+01f,
                1.222313400e+01f, 2.492631900e+01f, 2.488569600e+01f, 2.484507300e+01f, 2.480445000e+01f,
                2.476382700e+01f, 2.472320400e+01f, 2.468258100e+01f, 1.255445400e+01f, 1.253396100e+01f,
                1.251346800e+01f, 1.249297500e+01f, 1.247248200e+01f, 1.245198900e+01f, 1.243149600e+01f,
                2.534739900e+01f, 2.530605000e+01f, 2.526470100e+01f, 2.522335200e+01f, 2.518200300e+01f,
                2.514065400e+01f, 2.509930500e+01f, 1.276499400e+01f, 1.274413800e+01f, 1.272328200e+01f,
                1.270242600e+01f, 1.268157000e+01f, 1.266071400e+01f, 1.263985800e+01f, 2.576847900e+01f,
                2.572640400e+01f, 2.568432900e+01f, 2.564225400e+01f, 2.560017900e+01f, 2.555810400e+01f,
                2.551602900e+01f, 1.297553400e+01f, 1.295431500e+01f, 1.293309600e+01f, 1.291187700e+01f,
                1.289065800e+01f, 1.286943900e+01f, 1.284822000e+01f, 2.618955900e+01f, 2.614675800e+01f,
                2.610395700e+01f, 2.606115600e+01f, 2.601835500e+01f, 2.597555400e+01f, 2.593275300e+01f,
                1.318607400e+01f, 1.316449200e+01f, 1.314291000e+01f, 1.312132800e+01f, 1.309974600e+01f,
                1.307816400e+01f, 1.305658200e+01f, 1.152426000e+01f, 1.150267800e+01f, 1.148109600e+01f,
                1.145951400e+01f, 1.143793200e+01f, 1.141635000e+01f, 1.139476800e+01f, 9.301094000e+00f,
                9.287190000e+00f, 9.273286000e+00f, 9.259382000e+00f, 9.245478000e+00f, 9.231574000e+00f,
                9.217670000e+00f, 8.230486000e+00f, 8.216582000e+00f, 8.202678000e+00f, 8.188774000e+00f,
                8.174870000e+00f, 8.160966000e+00f, 8.147062000e+00f, 1.661996600e+01f, 1.659191600e+01f,
                1.656386600e+01f, 1.653581600e+01f, 1.650776600e+01f, 1.647971600e+01f, 1.645166600e+01f,
                8.370846000e+00f, 8.356700000e+00f, 8.342554000e+00f, 8.328408000e+00f, 8.314262000e+00f,
                8.300116000e+00f, 8.285970000e+00f, 1.690068600e+01f, 1.687215200e+01f, 1.684361800e+01f,
                1.681508400e+01f, 1.678655000e+01f, 1.675801600e+01f, 1.672948200e+01f, 8.511206000e+00f,
                8.496818000e+00f, 8.482430000e+00f, 8.468042000e+00f, 8.453654000e+00f, 8.439266000e+00f,
                8.424878000e+00f, 1.718140600e+01f, 1.715238800e+01f, 1.712337000e+01f, 1.709435200e+01f,
                1.706533400e+01f, 1.703631600e+01f, 1.700729800e+01f, 8.651566000e+00f, 8.636936000e+00f,
                8.622306000e+00f, 8.607676000e+00f, 8.593046000e+00f, 8.578416000e+00f, 8.563786000e+00f,
                1.746212600e+01f, 1.743262400e+01f, 1.740312200e+01f, 1.737362000e+01f, 1.734411800e+01f,
                1.731461600e+01f, 1.728511400e+01f, 8.791926000e+00f, 8.777054000e+00f, 8.762182000e+00f,
                8.747310000e+00f, 8.732438000e+00f, 8.717566000e+00f, 8.702694000e+00f, 1.774284600e+01f,
                1.771286000e+01f, 1.768287400e+01f, 1.765288800e+01f, 1.762290200e+01f, 1.759291600e+01f,
                1.756293000e+01f, 8.932286000e+00f, 8.917172000e+00f, 8.902058000e+00f, 8.886944000e+00f,
                8.871830000e+00f, 8.856716000e+00f, 8.841602000e+00f, 7.768508000e+00f, 7.753394000e+00f,
                7.738280000e+00f, 7.723166000e+00f, 7.708052000e+00f, 7.692938000e+00f, 7.677824000e+00f,
                1.508637900e+01f, 1.506443400e+01f, 1.504248900e+01f, 1.502054400e+01f, 1.499859900e+01f,
                1.497665400e+01f, 1.495470900e+01f, 1.339661400e+01f, 1.337466900e+01f, 1.335272400e+01f,
                1.333077900e+01f, 1.330883400e+01f, 1.328688900e+01f, 1.326494400e+01f, 2.703171900e+01f,
                2.698746600e+01f, 2.694321300e+01f, 2.689896000e+01f, 2.685470700e+01f, 2.681045400e+01f,
                2.676620100e+01f, 1.360715400e+01f, 1.358484600e+01f, 1.356253800e+01f, 1.354023000e+01f,
                1.351792200e+01f, 1.349561400e+01f, 1.347330600e+01f, 2.745279900e+01f, 2.740782000e+01f,
                2.736284100e+01f, 2.731786200e+01f, 2.727288300e+01f, 2.722790400e+01f, 2.718292500e+01f,
                1.381769400e+01f, 1.379502300e+01f, 1.377235200e+01f, 1.374968100e+01f, 1.372701000e+01f,
                1.370433900e+01f, 1.368166800e+01f, 2.787387900e+01f, 2.782817400e+01f, 2.778246900e+01f,
                2.773676400e+01f, 2.769105900e+01f, 2.764535400e+01f, 2.759964900e+01f, 1.402823400e+01f,
                1.400520000e+01f, 1.398216600e+01f, 1.395913200e+01f, 1.393609800e+01f, 1.391306400e+01f,
                1.389003000e+01f, 2.829495900e+01f, 2.824852800e+01f, 2.820209700e+01f, 2.815566600e+01f,
                2.810923500e+01f, 2.806280400e+01f, 2.801637300e+01f, 1.423877400e+01f, 1.421537700e+01f,
                1.419198000e+01f, 1.416858300e+01f, 1.414518600e+01f, 1.412178900e+01f, 1.409839200e+01f,
                2.871603900e+01f, 2.866888200e+01f, 2.862172500e+01f, 2.857456800e+01f, 2.852741100e+01f,
                2.848025400e+01f, 2.843309700e+01f, 1.444931400e+01f, 1.442555400e+01f, 1.440179400e+01f,
                1.437803400e+01f, 1.435427400e+01f, 1.433051400e+01f, 1.430675400e+01f, 1.261979400e+01f,
                1.259603400e+01f, 1.257227400e+01f, 1.254851400e+01f, 1.252475400e+01f, 1.250099400e+01f,
                1.247723400e+01f, 1.025505800e+01f, 1.023970200e+01f, 1.022434600e+01f, 1.020899000e+01f,
                1.019363400e+01f, 1.017827800e+01f, 1.016292200e+01f, 9.072646000e+00f, 9.057290000e+00f,
                9.041934000e+00f, 9.026578000e+00f, 9.011222000e+00f, 8.995866000e+00f, 8.980510000e+00f,
                1.830428600e+01f, 1.827333200e+01f, 1.824237800e+01f, 1.821142400e+01f, 1.818047000e+01f,
                1.814951600e+01f, 1.811856200e+01f, 9.213006000e+00f, 9.197408000e+00f, 9.181810000e+00f,
                9.166212000e+00f, 9.150614000e+00f, 9.135016000e+00f, 9.119418000e+00f, 1.858500600e+01f,
                1.855356800e+01f, 1.852213000e+01f, 1.849069200e+01f, 1.845925400e+01f, 1.842781600e+01f,
                1.839637800e+01f, 9.353366000e+00f, 9.337526000e+00f, 9.321686000e+00f, 9.305846000e+00f,
                9.290006000e+00f, 9.274166000e+00f, 9.258326000e+00f, 1.886572600e+01f, 1.883380400e+01f,
                1.880188200e+01f, 1.876996000e+01f, 1.873803800e+01f, 1.870611600e+01f, 1.867419400e+01f,
                9.493726000e+00f, 9.477644000e+00f, 9.461562000e+00f, 9.445480000e+00f, 9.429398000e+00f,
                9.413316000e+00f, 9.397234000e+00f, 1.914644600e+01f, 1.911404000e+01f, 1.908163400e+01f,
                1.904922800e+01f, 1.901682200e+01f, 1.898441600e+01f, 1.895201000e+01f, 9.634086000e+00f,
                9.617762000e+00f, 9.601438000e+00f, 9.585114000e+00f, 9.568790000e+00f, 9.552466000e+00f,
                9.536142000e+00f, 1.942716600e+01f, 1.939427600e+01f, 1.936138600e+01f, 1.932849600e+01f,
                1.929560600e+01f, 1.926271600e+01f, 1.922982600e+01f, 9.774446000e+00f, 9.757880000e+00f,
                9.741314000e+00f, 9.724748000e+00f, 9.708182000e+00f, 9.691616000e+00f, 9.675050000e+00f,
                8.498864000e+00f, 8.482298000e+00f, 8.465732000e+00f, 8.449166000e+00f, 8.432600000e+00f,
                8.416034000e+00f, 8.399468000e+00f, 1.651732500e+01f, 1.649320200e+01f, 1.646907900e+01f,
                1.644495600e+01f, 1.642083300e+01f, 1.639671000e+01f, 1.637258700e+01f, 1.465985400e+01f,
                1.463573100e+01f, 1.461160800e+01f, 1.458748500e+01f, 1.456336200e+01f, 1.453923900e+01f,
                1.451511600e+01f, 2.955819900e+01f, 2.950959000e+01f, 2.946098100e+01f, 2.941237200e+01f,
                2.936376300e+01f, 2.931515400e+01f, 2.926654500e+01f, 1.487039400e+01f, 1.484590800e+01f,
                1.482142200e+01f, 1.479693600e+01f, 1.477245000e+01f, 1.474796400e+01f, 1.472347800e+01f,
                2.997927900e+01f, 2.992994400e+01f, 2.988060900e+01f, 2.983127400e+01f, 2.978193900e+01f,
                2.973260400e+01f, 2.968326900e+01f, 1.508093400e+01f, 1.505608500e+01f, 1.503123600e+01f,
                1.500638700e+01f, 1.498153800e+01f, 1.495668900e+01f, 1.493184000e+01f, 3.040035900e+01f,
                3.035029800e+01f, 3.030023700e+01f, 3.025017600e+01f, 3.020011500e+01f, 3.015005400e+01f,
                3.009999300e+01f, 1.529147400e+01f, 1.526626200e+01f, 1.524105000e+01f, 1.521583800e+01f,
                1.519062600e+01f, 1.516541400e+01f, 1.514020200e+01f, 3.082143900e+01f, 3.077065200e+01f,
                3.071986500e+01f, 3.066907800e+01f, 3.061829100e+01f, 3.056750400e+01f, 3.051671700e+01f,
                1.550201400e+01f, 1.547643900e+01f, 1.545086400e+01f, 1.542528900e+01f, 1.539971400e+01f,
                1.537413900e+01f, 1.534856400e+01f, 3.124251900e+01f, 3.119100600e+01f, 3.113949300e+01f,
                3.108798000e+01f, 3.103646700e+01f, 3.098495400e+01f, 3.093344100e+01f, 1.571255400e+01f,
                1.568661600e+01f, 1.566067800e+01f, 1.563474000e+01f, 1.560880200e+01f, 1.558286400e+01f,
                1.555692600e+01f, 1.371532800e+01f, 1.368939000e+01f, 1.366345200e+01f, 1.363751400e+01f,
                1.361157600e+01f, 1.358563800e+01f, 1.355970000e+01f, 1.120902200e+01f, 1.119221400e+01f,
                1.117540600e+01f, 1.115859800e+01f, 1.114179000e+01f, 1.112498200e+01f, 1.110817400e+01f,
                9.914806000e+00f, 9.897998000e+00f, 9.881190000e+00f, 9.864382000e+00f, 9.847574000e+00f,
                9.830766000e+00f, 9.813958000e+00f, 1.998860600e+01f, 1.995474800e+01f, 1.992089000e+01f,
                1.988703200e+01f, 1.985317400e+01f, 1.981931600e+01f, 1.978545800e+01f, 1.005516600e+01f,
                1.003811600e+01f, 1.002106600e+01f, 1.000401600e+01f, 9.986966000e+00f, 9.969916000e+00f,
                9.952866000e+00f, 2.026932600e+01f, 2.023498400e+01f, 2.020064200e+01f, 2.016630000e+01f,
                2.013195800e+01f, 2.009761600e+01f, 2.006327400e+01f, 1.019552600e+01f, 1.017823400e+01f,
                1.016094200e+01f, 1.014365000e+01f, 1.012635800e+01f, 1.010906600e+01f, 1.009177400e+01f,
                2.055004600e+01f, 2.051522000e+01f, 2.048039400e+01f, 2.044556800e+01f, 2.041074200e+01f,
                2.037591600e+01f, 2.034109000e+01f, 1.033588600e+01f, 1.031835200e+01f, 1.030081800e+01f,
                1.028328400e+01f, 1.026575000e+01f, 1.024821600e+01f, 1.023068200e+01f, 2.083076600e+01f,
                2.079545600e+01f, 2.076014600e+01f, 2.072483600e+01f, 2.068952600e+01f, 2.065421600e+01f,
                2.061890600e+01f, 1.047624600e+01f, 1.045847000e+01f, 1.044069400e+01f, 1.042291800e+01f,
                1.040514200e+01f, 1.038736600e+01f, 1.036959000e+01f, 2.111148600e+01f, 2.107569200e+01f,
                2.103989800e+01f, 2.100410400e+01f, 2.096831000e+01f, 2.093251600e+01f, 2.089672200e+01f,
                1.061660600e+01f, 1.059858800e+01f, 1.058057000e+01f, 1.056255200e+01f, 1.054453400e+01f,
                1.052651600e+01f, 1.050849800e+01f, 9.229220000e+00f, 9.211202000e+00f, 9.193184000e+00f,
                9.175166000e+00f, 9.157148000e+00f, 9.139130000e+00f, 9.121112000e+00f, 1.794827100e+01f,
                1.792197000e+01f, 1.789566900e+01f, 1.786936800e+01f, 1.784306700e+01f, 1.781676600e+01f,
                1.779046500e+01f, 1.592309400e+01f, 1.589679300e+01f, 1.587049200e+01f, 1.584419100e+01f,
                1.581789000e+01f, 1.579158900e+01f, 1.576528800e+01f, 3.208467900e+01f, 3.203171400e+01f,
                3.197874900e+01f, 3.192578400e+01f, 3.187281900e+01f, 3.181985400e+01f, 3.176688900e+01f,
                1.613363400e+01f, 1.610697000e+01f, 1.608030600e+01f, 1.605364200e+01f, 1.602697800e+01f,
                1.600031400e+01f, 1.597365000e+01f, 3.250575900e+01f, 3.245206800e+01f, 3.239837700e+01f,
                3.234468600e+01f, 3.229099500e+01f, 3.223730400e+01f, 3.218361300e+01f, 1.634417400e+01f,
                1.631714700e+01f, 1.629012000e+01f, 1.626309300e+01f, 1.623606600e+01f, 1.620903900e+01f,
                1.618201200e+01f, 3.292683900e+01f, 3.287242200e+01f, 3.281800500e+01f, 3.276358800e+01f,
                3.270917100e+01f, 3.265475400e+01f, 3.260033700e+01f, 1.655471400e+01f, 1.652732400e+01f,
                1.649993400e+01f, 1.647254400e+01f, 1.644515400e+01f, 1.641776400e+01f, 1.639037400e+01f,
                3.334791900e+01f, 3.329277600e+01f, 3.323763300e+01f, 3.318249000e+01f, 3.312734700e+01f,
                3.307220400e+01f, 3.301706100e+01f, 1.676525400e+01f, 1.673750100e+01f, 1.670974800e+01f,
                1.668199500e+01f, 1.665424200e+01f, 1.662648900e+01f, 1.659873600e+01f, 3.376899900e+01f,
                3.371313000e+01f, 3.365726100e+01f, 3.360139200e+01f, 3.354552300e+01f, 3.348965400e+01f,
                3.343378500e+01f, 1.697579400e+01f, 1.694767800e+01f, 1.691956200e+01f, 1.689144600e+01f,
                1.686333000e+01f, 1.683521400e+01f, 1.680709800e+01f, 1.481086200e+01f, 1.478274600e+01f,
                1.475463000e+01f, 1.472651400e+01f, 1.469839800e+01f, 1.467028200e+01f, 1.464216600e+01f,
                1.216298600e+01f, 1.214472600e+01f, 1.212646600e+01f, 1.210820600e+01f, 1.208994600e+01f,
                1.207168600e+01f, 1.205342600e+01f, 1.075696600e+01f, 1.073870600e+01f, 1.072044600e+01f,
                1.070218600e+01f, 1.068392600e+01f, 1.066566600e+01f, 1.064740600e+01f, 2.167292600e+01f,
                2.163616400e+01f, 2.159940200e+01f, 2.156264000e+01f, 2.152587800e+01f, 2.148911600e+01f,
                2.145235400e+01f, 1.089732600e+01f, 1.087882400e+01f, 1.086032200e+01f, 1.084182000e+01f,
                1.082331800e+01f, 1.080481600e+01f, 1.078631400e+01f, 2.195364600e+01f, 2.191640000e+01f,
                2.187915400e+01f, 2.184190800e+01f, 2.180466200e+01f, 2.176741600e+01f, 2.173017000e+01f,
                1.103768600e+01f, 1.101894200e+01f, 1.100019800e+01f, 1.098145400e+01f, 1.096271000e+01f,
                1.094396600e+01f, 1.092522200e+01f, 2.223436600e+01f, 2.219663600e+01f, 2.215890600e+01f,
                2.212117600e+01f, 2.208344600e+01f, 2.204571600e+01f, 2.200798600e+01f, 1.117804600e+01f,
                1.115906000e+01f, 1.114007400e+01f, 1.112108800e+01f, 1.110210200e+01f, 1.108311600e+01f,
                1.106413000e+01f, 2.251508600e+01f, 2.247687200e+01f, 2.243865800e+01f, 2.240044400e+01f,
                2.236223000e+01f, 2.232401600e+01f, 2.228580200e+01f, 1.131840600e+01f, 1.129917800e+01f,
                1.127995000e+01f, 1.126072200e+01f, 1.124149400e+01f, 1.122226600e+01f, 1.120303800e+01f,
                2.279580600e+01f, 2.275710800e+01f, 2.271841000e+01f, 2.267971200e+01f, 2.264101400e+01f,
                2.260231600e+01f, 2.256361800e+01f, 1.145876600e+01f, 1.143929600e+01f, 1.141982600e+01f,
                1.140035600e+01f, 1.138088600e+01f, 1.136141600e+01f, 1.134194600e+01f, 9.959576000e+00f,
                9.940106000e+00f, 9.920636000e+00f, 9.901166000e+00f, 9.881696000e+00f, 9.862226000e+00f,
                9.842756000e+00f, 7.944926000e+00f, 7.926666000e+00f, 7.908406000e+00f, 7.890146000e+00f,
                7.871886000e+00f, 7.853626000e+00f, 7.835366000e+00f, 6.538906000e+00f, 6.520646000e+00f,
                6.502386000e+00f, 6.484126000e+00f, 6.465866000e+00f, 6.447606000e+00f, 6.429346000e+00f,
                1.318090400e+01f, 1.314414200e+01f, 1.310738000e+01f, 1.307061800e+01f, 1.303385600e+01f,
                1.299709400e+01f, 1.296033200e+01f, 6.623364000e+00f, 6.604862000e+00f, 6.586360000e+00f,
                6.567858000e+00f, 6.549356000e+00f, 6.530854000e+00f, 6.512352000e+00f, 1.334982000e+01f,
                1.331257400e+01f, 1.327532800e+01f, 1.323808200e+01f, 1.320083600e+01f, 1.316359000e+01f,
                1.312634400e+01f, 6.707822000e+00f, 6.689078000e+00f, 6.670334000e+00f, 6.651590000e+00f,
                6.632846000e+00f, 6.614102000e+00f, 6.595358000e+00f, 1.351873600e+01f, 1.348100600e+01f,
                1.344327600e+01f, 1.340554600e+01f, 1.336781600e+01f, 1.333008600e+01f, 1.329235600e+01f,
                6.792280000e+00f, 6.773294000e+00f, 6.754308000e+00f, 6.735322000e+00f, 6.716336000e+00f,
                6.697350000e+00f, 6.678364000e+00f, 1.368765200e+01f, 1.364943800e+01f, 1.361122400e+01f,
                1.357301000e+01f, 1.353479600e+01f, 1.349658200e+01f, 1.345836800e+01f, 6.876738000e+00f,
                6.857510000e+00f, 6.838282000e+00f, 6.819054000e+00f, 6.799826000e+00f, 6.780598000e+00f,
                6.761370000e+00f, 1.385656800e+01f, 1.381787000e+01f, 1.377917200e+01f, 1.374047400e+01f,
                1.370177600e+01f, 1.366307800e+01f, 1.362438000e+01f, 6.961196000e+00f, 6.941726000e+00f,
                6.922256000e+00f, 6.902786000e+00f, 6.883316000e+00f, 6.863846000e+00f, 6.844376000e+00f,
                5.462006000e+00f, 5.442536000e+00f, 5.423066000e+00f, 5.403596000e+00f, 5.384126000e+00f,
                5.364656000e+00f, 5.345186000e+00f, 4.043248000e+00f, 4.033755000e+00f, 4.024262000e+00f,
                4.014769000e+00f, 4.005276000e+00f, 3.995783000e+00f, 3.986290000e+00f, 3.312287000e+00f,
                3.302794000e+00f, 3.293301000e+00f, 3.283808000e+00f, 3.274315000e+00f, 3.264822000e+00f,
                3.255329000e+00f, 6.676120000e+00f, 6.657013000e+00f, 6.637906000e+00f, 6.618799000e+00f,
                6.599692000e+00f, 6.580585000e+00f, 6.561478000e+00f, 3.354516000e+00f, 3.344902000e+00f,
                3.335288000e+00f, 3.325674000e+00f, 3.316060000e+00f, 3.306446000e+00f, 3.296832000e+00f,
                6.760578000e+00f, 6.741229000e+00f, 6.721880000e+00f, 6.702531000e+00f, 6.683182000e+00f,
                6.663833000e+00f, 6.644484000e+00f, 3.396745000e+00f, 3.387010000e+00f, 3.377275000e+00f,
                3.367540000e+00f, 3.357805000e+00f, 3.348070000e+00f, 3.338335000e+00f, 6.845036000e+00f,
                6.825445000e+00f, 6.805854000e+00f, 6.786263000e+00f, 6.766672000e+00f, 6.747081000e+00f,
                6.727490000e+00f, 3.438974000e+00f, 3.429118000e+00f, 3.419262000e+00f, 3.409406000e+00f,
                3.399550000e+00f, 3.389694000e+00f, 3.379838000e+00f, 6.929494000e+00f, 6.909661000e+00f,
                6.889828000e+00f, 6.869995000e+00f, 6.850162000e+00f, 6.830329000e+00f, 6.810496000e+00f,
                3.481203000e+00f, 3.471226000e+00f, 3.461249000e+00f, 3.451272000e+00f, 3.441295000e+00f,
                3.431318000e+00f, 3.421341000e+00f, 7.013952000e+00f, 6.993877000e+00f, 6.973802000e+00f,
                6.953727000e+00f, 6.933652000e+00f, 6.913577000e+00f, 6.893502000e+00f, 3.523432000e+00f,
                3.513334000e+00f, 3.503236000e+00f, 3.493138000e+00f, 3.483040000e+00f, 3.472942000e+00f,
                3.462844000e+00f, 2.745886000e+00f, 2.735788000e+00f, 2.725690000e+00f, 2.715592000e+00f,
                2.705494000e+00f, 2.695396000e+00f, 2.685298000e+00f, 1.850365000e+00f, 1.840872000e+00f,
                1.831379000e+00f, 1.821886000e+00f, 1.812393000e+00f, 1.802900000e+00f, 1.793407000e+00f,
                1.119404000e+00f, 1.109911000e+00f, 1.100418000e+00f, 1.090925000e+00f, 1.081432000e+00f,
                1.071939000e+00f, 1.062446000e+00f, 2.262403000e+00f, 2.243296000e+00f, 2.224189000e+00f,
                2.205082000e+00f, 2.185975000e+00f, 2.166868000e+00f, 2.147761000e+00f, 1.133682000e+00f,
                1.124068000e+00f, 1.114454000e+00f, 1.104840000e+00f, 1.095226000e+00f, 1.085612000e+00f,
                1.075998000e+00f, 2.290959000e+00f, 2.271610000e+00f, 2.252261000e+00f, 2.232912000e+00f,
                2.213563000e+00f, 2.194214000e+00f, 2.174865000e+00f, 1.147960000e+00f, 1.138225000e+00f,
                1.128490000e+00f, 1.118755000e+00f, 1.109020000e+00f, 1.099285000e+00f, 1.089550000e+00f,
                2.319515000e+00f, 2.299924000e+00f, 2.280333000e+00f, 2.260742000e+00f, 2.241151000e+00f,
                2.221560000e+00f, 2.201969000e+00f, 1.162238000e+00f, 1.152382000e+00f, 1.142526000e+00f,
                1.132670000e+00f, 1.122814000e+00f, 1.112958000e+00f, 1.103102000e+00f, 2.348071000e+00f,
                2.328238000e+00f, 2.308405000e+00f, 2.288572000e+00f, 2.268739000e+00f, 2.248906000e+00f,
                2.229073000e+00f, 1.176516000e+00f, 1.166539000e+00f, 1.156562000e+00f, 1.146585000e+00f,
                1.136608000e+00f, 1.126631000e+00f, 1.116654000e+00f, 2.376627000e+00f, 2.356552000e+00f,
                2.336477000e+00f, 2.316402000e+00f, 2.296327000e+00f, 2.276252000e+00f, 2.256177000e+00f,
                1.190794000e+00f, 1.180696000e+00f, 1.170598000e+00f, 1.160500000e+00f, 1.150402000e+00f,
                1.140304000e+00f, 1.130206000e+00f, 4.132480000e-01f, 4.031500000e-01f, 3.930520000e-01f,
                3.829540000e-01f, 3.728560000e-01f, 3.627580000e-01f, 3.526600000e-01f
            };

            float[] x_actual = x.ToArray();

            AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, $"mismatch value {inchannels},{outchannels},{kwidth},{kheight},{stride},{inwidth},{inheight},{batch}");
        }

        [TestMethod]
        public void OptimizeTest() {
            float max_err = 0;

            foreach (int batch in new int[] { 1, 2 }) {
                foreach (int inchannels in new int[] { 1, 2, 3, 4, 5, 10, 15, 20 }) {
                    foreach (int outchannels in new int[] { 7, 13 }) {
                        foreach (int kheight in new int[] { 1, 3, 5 }) {
                            foreach (int kwidth in new int[] { 1, 3, 5 }) {
                                foreach (int stride in new int[] { 1, 2, 3 }) {
                                    foreach (int inwidth in new int[] { 8, 9, 13, 17 }) {
                                        foreach (int inheight in new int[] { 8, 9, 19, 23 }) {
                                            int outwidth = (inwidth - kwidth) / stride + 1, outheight = (inheight - kheight) / stride + 1;

                                            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-4f).ToArray();
                                            float[] wval = (new float[kwidth * kheight * inchannels * outchannels]).Select((_, idx) => idx * 1e-4f).Reverse().ToArray();

                                            Map2D y = new Map2D(outchannels, outwidth, outheight, batch, yval);
                                            Filter2D w = new Filter2D(inchannels, outchannels, kwidth, kheight, wval);

                                            Map2D x = Reference(y, w, inwidth, inheight, kwidth, kheight, stride);
                                            Map2D x_optimized = OptimizedReference(y, w, inwidth, inheight, kwidth, kheight, stride);

                                            float[] x_expect = x.ToArray();
                                            float[] x_actual = x_optimized.ToArray();

                                            AssertError.Tolerance(x_expect, x_actual, 1e-7f, 1e-5f, ref max_err, $"mismatch value {inchannels},{outchannels},{kwidth},{kheight},{stride},{inwidth},{inheight},{batch}");

                                            Console.WriteLine($"pass: {inchannels},{outchannels},{kwidth},{kheight},{stride},{inwidth},{inheight},{batch}");
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            Console.WriteLine($"maxerr:{max_err}");
        }
    }
}
