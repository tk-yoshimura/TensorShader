using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TensorShader;
using static TensorShader.Field;

namespace TensorShaderTest.Links.Connection3D {
    [TestClass]
    public class PointwisewiseConvolutionTest {
        [TestMethod]
        public void ReferenceTest() {
            int inchannels = 2, outchannels = 3, width = 7, height = 6, depth = 5, batch = 2;

            float[] xval = (new float[width * height * depth * inchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] yval = (new float[width * height * depth * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[outchannels * inchannels]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            ParameterField x = new Tensor(Shape.Map3D(inchannels, width, height, depth, batch), xval);
            ParameterField w = new Tensor(Shape.Kernel0D(inchannels, outchannels), wval);
            VariableField y_actual = new Tensor(Shape.Map3D(outchannels, width, height, depth, batch), yval);

            Field y_expect = PointwiseConvolution3D(x, w);
            Field err = Abs(y_expect - y_actual);

            (Flow flow, Parameters parameters) = Flow.Optimize(err);

            flow.Execute();

            float[] gx_actual = x.GradState;
            float[] gw_actual = w.GradState;

            AssertError.Tolerance(gw_expect, gw_actual, 1e-7f, 1e-5f, $"not equal gw");

            AssertError.Tolerance(gx_expect, gx_actual, 1e-7f, 1e-5f, $"not equal gx");
        }

        float[] gx_expect = new float[] {
            -4.974000000e-06f,  -1.980000000e-06f,  -3.185200000e-05f,  -1.988800000e-05f,  -5.873000000e-05f,  -3.779600000e-05f,
            -8.560800000e-05f,  -5.570400000e-05f,  -1.124860000e-04f,  -7.361200000e-05f,  -1.393640000e-04f,  -9.152000000e-05f,
            -1.662420000e-04f,  -1.094280000e-04f,  -1.931200000e-04f,  -1.273360000e-04f,  -2.199980000e-04f,  -1.452440000e-04f,
            -2.468760000e-04f,  -1.631520000e-04f,  -2.737540000e-04f,  -1.810600000e-04f,  -3.006320000e-04f,  -1.989680000e-04f,
            -3.275100000e-04f,  -2.168760000e-04f,  -3.543880000e-04f,  -2.347840000e-04f,  -3.812660000e-04f,  -2.526920000e-04f,
            -4.081440000e-04f,  -2.706000000e-04f,  -4.350220000e-04f,  -2.885080000e-04f,  -4.619000000e-04f,  -3.064160000e-04f,
            -4.887780000e-04f,  -3.243240000e-04f,  -5.156560000e-04f,  -3.422320000e-04f,  -5.425340000e-04f,  -3.601400000e-04f,
            -5.694120000e-04f,  -3.780480000e-04f,  -5.962900000e-04f,  -3.959560000e-04f,  -6.231680000e-04f,  -4.138640000e-04f,
            -6.500460000e-04f,  -4.317720000e-04f,  -6.769240000e-04f,  -4.496800000e-04f,  -7.038020000e-04f,  -4.675880000e-04f,
            -7.306800000e-04f,  -4.854960000e-04f,  -7.575580000e-04f,  -5.034040000e-04f,  -7.844360000e-04f,  -5.213120000e-04f,
            -8.113140000e-04f,  -5.392200000e-04f,  -8.381920000e-04f,  -5.571280000e-04f,  -8.650700000e-04f,  -5.750360000e-04f,
            -8.919480000e-04f,  -5.929440000e-04f,  -9.188260000e-04f,  -6.108520000e-04f,  -9.457040000e-04f,  -6.287600000e-04f,
            -9.725820000e-04f,  -6.466680000e-04f,  -9.994600000e-04f,  -6.645760000e-04f,  -1.026338000e-03f,  -6.824840000e-04f,
            -1.053216000e-03f,  -7.003920000e-04f,  -1.080094000e-03f,  -7.183000000e-04f,  -1.106972000e-03f,  -7.362080000e-04f,
            -1.133850000e-03f,  -7.541160000e-04f,  -1.160728000e-03f,  -7.720240000e-04f,  -1.187606000e-03f,  -7.899320000e-04f,
            -1.214484000e-03f,  -8.078400000e-04f,  -1.241362000e-03f,  -8.257480000e-04f,  -1.268240000e-03f,  -8.436560000e-04f,
            -1.295118000e-03f,  -8.615640000e-04f,  -1.321996000e-03f,  -8.794720000e-04f,  -1.348874000e-03f,  -8.973800000e-04f,
            -1.375752000e-03f,  -9.152880000e-04f,  -1.402630000e-03f,  -9.331960000e-04f,  -1.429508000e-03f,  -9.511040000e-04f,
            -1.456386000e-03f,  -9.690120000e-04f,  -1.483264000e-03f,  -9.869200000e-04f,  -1.510142000e-03f,  -1.004828000e-03f,
            -1.537020000e-03f,  -1.022736000e-03f,  -1.563898000e-03f,  -1.040644000e-03f,  -1.590776000e-03f,  -1.058552000e-03f,
            -1.617654000e-03f,  -1.076460000e-03f,  -1.644532000e-03f,  -1.094368000e-03f,  -1.671410000e-03f,  -1.112276000e-03f,
            -1.698288000e-03f,  -1.130184000e-03f,  -1.725166000e-03f,  -1.148092000e-03f,  -1.752044000e-03f,  -1.166000000e-03f,
            -1.778922000e-03f,  -1.183908000e-03f,  -1.805800000e-03f,  -1.201816000e-03f,  -1.832678000e-03f,  -1.219724000e-03f,
            -1.859556000e-03f,  -1.237632000e-03f,  -1.886434000e-03f,  -1.255540000e-03f,  -1.913312000e-03f,  -1.273448000e-03f,
            -1.940190000e-03f,  -1.291356000e-03f,  -1.967068000e-03f,  -1.309264000e-03f,  -1.993946000e-03f,  -1.327172000e-03f,
            -2.020824000e-03f,  -1.345080000e-03f,  -2.047702000e-03f,  -1.362988000e-03f,  -2.074580000e-03f,  -1.380896000e-03f,
            -2.101458000e-03f,  -1.398804000e-03f,  -2.128336000e-03f,  -1.416712000e-03f,  -2.155214000e-03f,  -1.434620000e-03f,
            -2.182092000e-03f,  -1.452528000e-03f,  -2.208970000e-03f,  -1.470436000e-03f,  -2.235848000e-03f,  -1.488344000e-03f,
            -2.262726000e-03f,  -1.506252000e-03f,  -2.289604000e-03f,  -1.524160000e-03f,  -2.316482000e-03f,  -1.542068000e-03f,
            -2.343360000e-03f,  -1.559976000e-03f,  -2.370238000e-03f,  -1.577884000e-03f,  -2.397116000e-03f,  -1.595792000e-03f,
            -2.423994000e-03f,  -1.613700000e-03f,  -2.450872000e-03f,  -1.631608000e-03f,  -2.477750000e-03f,  -1.649516000e-03f,
            -2.504628000e-03f,  -1.667424000e-03f,  -2.531506000e-03f,  -1.685332000e-03f,  -2.558384000e-03f,  -1.703240000e-03f,
            -2.585262000e-03f,  -1.721148000e-03f,  -2.612140000e-03f,  -1.739056000e-03f,  -2.639018000e-03f,  -1.756964000e-03f,
            -2.665896000e-03f,  -1.774872000e-03f,  -2.692774000e-03f,  -1.792780000e-03f,  -2.719652000e-03f,  -1.810688000e-03f,
            -2.746530000e-03f,  -1.828596000e-03f,  -2.773408000e-03f,  -1.846504000e-03f,  -2.800286000e-03f,  -1.864412000e-03f,
            -2.827164000e-03f,  -1.882320000e-03f,  -2.854042000e-03f,  -1.900228000e-03f,  -2.880920000e-03f,  -1.918136000e-03f,
            -2.907798000e-03f,  -1.936044000e-03f,  -2.934676000e-03f,  -1.953952000e-03f,  -2.961554000e-03f,  -1.971860000e-03f,
            -2.988432000e-03f,  -1.989768000e-03f,  -3.015310000e-03f,  -2.007676000e-03f,  -3.042188000e-03f,  -2.025584000e-03f,
            -3.069066000e-03f,  -2.043492000e-03f,  -3.095944000e-03f,  -2.061400000e-03f,  -3.122822000e-03f,  -2.079308000e-03f,
            -3.149700000e-03f,  -2.097216000e-03f,  -3.176578000e-03f,  -2.115124000e-03f,  -3.203456000e-03f,  -2.133032000e-03f,
            -3.230334000e-03f,  -2.150940000e-03f,  -3.257212000e-03f,  -2.168848000e-03f,  -3.284090000e-03f,  -2.186756000e-03f,
            -3.310968000e-03f,  -2.204664000e-03f,  -3.337846000e-03f,  -2.222572000e-03f,  -3.364724000e-03f,  -2.240480000e-03f,
            -3.391602000e-03f,  -2.258388000e-03f,  -3.418480000e-03f,  -2.276296000e-03f,  -3.445358000e-03f,  -2.294204000e-03f,
            -3.472236000e-03f,  -2.312112000e-03f,  -3.499114000e-03f,  -2.330020000e-03f,  -3.525992000e-03f,  -2.347928000e-03f,
            -3.552870000e-03f,  -2.365836000e-03f,  -3.579748000e-03f,  -2.383744000e-03f,  -3.606626000e-03f,  -2.401652000e-03f,
            -3.633504000e-03f,  -2.419560000e-03f,  -3.660382000e-03f,  -2.437468000e-03f,  -3.687260000e-03f,  -2.455376000e-03f,
            -3.714138000e-03f,  -2.473284000e-03f,  -3.741016000e-03f,  -2.491192000e-03f,  -3.767894000e-03f,  -2.509100000e-03f,
            -3.794772000e-03f,  -2.527008000e-03f,  -3.821650000e-03f,  -2.544916000e-03f,  -3.848528000e-03f,  -2.562824000e-03f,
            -3.875406000e-03f,  -2.580732000e-03f,  -3.902284000e-03f,  -2.598640000e-03f,  -3.929162000e-03f,  -2.616548000e-03f,
            -3.956040000e-03f,  -2.634456000e-03f,  -3.982918000e-03f,  -2.652364000e-03f,  -4.009796000e-03f,  -2.670272000e-03f,
            -4.036674000e-03f,  -2.688180000e-03f,  -4.063552000e-03f,  -2.706088000e-03f,  -4.090430000e-03f,  -2.723996000e-03f,
            -4.117308000e-03f,  -2.741904000e-03f,  -4.144186000e-03f,  -2.759812000e-03f,  -4.171064000e-03f,  -2.777720000e-03f,
            -4.197942000e-03f,  -2.795628000e-03f,  -4.224820000e-03f,  -2.813536000e-03f,  -4.251698000e-03f,  -2.831444000e-03f,
            -4.278576000e-03f,  -2.849352000e-03f,  -4.305454000e-03f,  -2.867260000e-03f,  -4.332332000e-03f,  -2.885168000e-03f,
            -4.359210000e-03f,  -2.903076000e-03f,  -4.386088000e-03f,  -2.920984000e-03f,  -4.412966000e-03f,  -2.938892000e-03f,
            -4.439844000e-03f,  -2.956800000e-03f,  -4.466722000e-03f,  -2.974708000e-03f,  -4.493600000e-03f,  -2.992616000e-03f,
            -4.520478000e-03f,  -3.010524000e-03f,  -4.547356000e-03f,  -3.028432000e-03f,  -4.574234000e-03f,  -3.046340000e-03f,
            -4.601112000e-03f,  -3.064248000e-03f,  -4.627990000e-03f,  -3.082156000e-03f,  -4.654868000e-03f,  -3.100064000e-03f,
            -4.681746000e-03f,  -3.117972000e-03f,  -4.708624000e-03f,  -3.135880000e-03f,  -4.735502000e-03f,  -3.153788000e-03f,
            -4.762380000e-03f,  -3.171696000e-03f,  -4.789258000e-03f,  -3.189604000e-03f,  -4.816136000e-03f,  -3.207512000e-03f,
            -4.843014000e-03f,  -3.225420000e-03f,  -4.869892000e-03f,  -3.243328000e-03f,  -4.896770000e-03f,  -3.261236000e-03f,
            -4.923648000e-03f,  -3.279144000e-03f,  -4.950526000e-03f,  -3.297052000e-03f,  -4.977404000e-03f,  -3.314960000e-03f,
            -5.004282000e-03f,  -3.332868000e-03f,  -5.031160000e-03f,  -3.350776000e-03f,  -5.058038000e-03f,  -3.368684000e-03f,
            -5.084916000e-03f,  -3.386592000e-03f,  -5.111794000e-03f,  -3.404500000e-03f,  -5.138672000e-03f,  -3.422408000e-03f,
            -5.165550000e-03f,  -3.440316000e-03f,  -5.192428000e-03f,  -3.458224000e-03f,  -5.219306000e-03f,  -3.476132000e-03f,
            -5.246184000e-03f,  -3.494040000e-03f,  -5.273062000e-03f,  -3.511948000e-03f,  -5.299940000e-03f,  -3.529856000e-03f,
            -5.326818000e-03f,  -3.547764000e-03f,  -5.353696000e-03f,  -3.565672000e-03f,  -5.380574000e-03f,  -3.583580000e-03f,
            -5.407452000e-03f,  -3.601488000e-03f,  -5.434330000e-03f,  -3.619396000e-03f,  -5.461208000e-03f,  -3.637304000e-03f,
            -5.488086000e-03f,  -3.655212000e-03f,  -5.514964000e-03f,  -3.673120000e-03f,  -5.541842000e-03f,  -3.691028000e-03f,
            -5.568720000e-03f,  -3.708936000e-03f,  -5.595598000e-03f,  -3.726844000e-03f,  -5.622476000e-03f,  -3.744752000e-03f,
            -5.649354000e-03f,  -3.762660000e-03f,  -5.676232000e-03f,  -3.780568000e-03f,  -5.703110000e-03f,  -3.798476000e-03f,
            -5.729988000e-03f,  -3.816384000e-03f,  -5.756866000e-03f,  -3.834292000e-03f,  -5.783744000e-03f,  -3.852200000e-03f,
            -5.810622000e-03f,  -3.870108000e-03f,  -5.837500000e-03f,  -3.888016000e-03f,  -5.864378000e-03f,  -3.905924000e-03f,
            -5.891256000e-03f,  -3.923832000e-03f,  -5.918134000e-03f,  -3.941740000e-03f,  -5.945012000e-03f,  -3.959648000e-03f,
            -5.971890000e-03f,  -3.977556000e-03f,  -5.998768000e-03f,  -3.995464000e-03f,  -6.025646000e-03f,  -4.013372000e-03f,
            -6.052524000e-03f,  -4.031280000e-03f,  -6.079402000e-03f,  -4.049188000e-03f,  -6.106280000e-03f,  -4.067096000e-03f,
            -6.133158000e-03f,  -4.085004000e-03f,  -6.160036000e-03f,  -4.102912000e-03f,  -6.186914000e-03f,  -4.120820000e-03f,
            -6.213792000e-03f,  -4.138728000e-03f,  -6.240670000e-03f,  -4.156636000e-03f,  -6.267548000e-03f,  -4.174544000e-03f,
            -6.294426000e-03f,  -4.192452000e-03f,  -6.321304000e-03f,  -4.210360000e-03f,  -6.348182000e-03f,  -4.228268000e-03f,
            -6.375060000e-03f,  -4.246176000e-03f,  -6.401938000e-03f,  -4.264084000e-03f,  -6.428816000e-03f,  -4.281992000e-03f,
            -6.455694000e-03f,  -4.299900000e-03f,  -6.482572000e-03f,  -4.317808000e-03f,  -6.509450000e-03f,  -4.335716000e-03f,
            -6.536328000e-03f,  -4.353624000e-03f,  -6.563206000e-03f,  -4.371532000e-03f,  -6.590084000e-03f,  -4.389440000e-03f,
            -6.616962000e-03f,  -4.407348000e-03f,  -6.643840000e-03f,  -4.425256000e-03f,  -6.670718000e-03f,  -4.443164000e-03f,
            -6.697596000e-03f,  -4.461072000e-03f,  -6.724474000e-03f,  -4.478980000e-03f,  -6.751352000e-03f,  -4.496888000e-03f,
            -6.778230000e-03f,  -4.514796000e-03f,  -6.805108000e-03f,  -4.532704000e-03f,  -6.831986000e-03f,  -4.550612000e-03f,
            -6.858864000e-03f,  -4.568520000e-03f,  -6.885742000e-03f,  -4.586428000e-03f,  -6.912620000e-03f,  -4.604336000e-03f,
            -6.939498000e-03f,  -4.622244000e-03f,  -6.966376000e-03f,  -4.640152000e-03f,  -6.993254000e-03f,  -4.658060000e-03f,
            -7.020132000e-03f,  -4.675968000e-03f,  -7.047010000e-03f,  -4.693876000e-03f,  -7.073888000e-03f,  -4.711784000e-03f,
            -7.100766000e-03f,  -4.729692000e-03f,  -7.127644000e-03f,  -4.747600000e-03f,  -7.154522000e-03f,  -4.765508000e-03f,
            -7.181400000e-03f,  -4.783416000e-03f,  -7.208278000e-03f,  -4.801324000e-03f,  -7.235156000e-03f,  -4.819232000e-03f,
            -7.262034000e-03f,  -4.837140000e-03f,  -7.288912000e-03f,  -4.855048000e-03f,  -7.315790000e-03f,  -4.872956000e-03f,
            -7.342668000e-03f,  -4.890864000e-03f,  -7.369546000e-03f,  -4.908772000e-03f,  -7.396424000e-03f,  -4.926680000e-03f,
            -7.423302000e-03f,  -4.944588000e-03f,  -7.450180000e-03f,  -4.962496000e-03f,  -7.477058000e-03f,  -4.980404000e-03f,
            -7.503936000e-03f,  -4.998312000e-03f,  -7.530814000e-03f,  -5.016220000e-03f,  -7.557692000e-03f,  -5.034128000e-03f,
            -7.584570000e-03f,  -5.052036000e-03f,  -7.611448000e-03f,  -5.069944000e-03f,  -7.638326000e-03f,  -5.087852000e-03f,
            -7.665204000e-03f,  -5.105760000e-03f,  -7.692082000e-03f,  -5.123668000e-03f,  -7.718960000e-03f,  -5.141576000e-03f,
            -7.745838000e-03f,  -5.159484000e-03f,  -7.772716000e-03f,  -5.177392000e-03f,  -7.799594000e-03f,  -5.195300000e-03f,
            -7.826472000e-03f,  -5.213208000e-03f,  -7.853350000e-03f,  -5.231116000e-03f,  -7.880228000e-03f,  -5.249024000e-03f,
            -7.907106000e-03f,  -5.266932000e-03f,  -7.933984000e-03f,  -5.284840000e-03f,  -7.960862000e-03f,  -5.302748000e-03f,
            -7.987740000e-03f,  -5.320656000e-03f,  -8.014618000e-03f,  -5.338564000e-03f,  -8.041496000e-03f,  -5.356472000e-03f,
            -8.068374000e-03f,  -5.374380000e-03f,  -8.095252000e-03f,  -5.392288000e-03f,  -8.122130000e-03f,  -5.410196000e-03f,
            -8.149008000e-03f,  -5.428104000e-03f,  -8.175886000e-03f,  -5.446012000e-03f,  -8.202764000e-03f,  -5.463920000e-03f,
            -8.229642000e-03f,  -5.481828000e-03f,  -8.256520000e-03f,  -5.499736000e-03f,  -8.283398000e-03f,  -5.517644000e-03f,
            -8.310276000e-03f,  -5.535552000e-03f,  -8.337154000e-03f,  -5.553460000e-03f,  -8.364032000e-03f,  -5.571368000e-03f,
            -8.390910000e-03f,  -5.589276000e-03f,  -8.417788000e-03f,  -5.607184000e-03f,  -8.444666000e-03f,  -5.625092000e-03f,
            -8.471544000e-03f,  -5.643000000e-03f,  -8.498422000e-03f,  -5.660908000e-03f,  -8.525300000e-03f,  -5.678816000e-03f,
            -8.552178000e-03f,  -5.696724000e-03f,  -8.579056000e-03f,  -5.714632000e-03f,  -8.605934000e-03f,  -5.732540000e-03f,
            -8.632812000e-03f,  -5.750448000e-03f,  -8.659690000e-03f,  -5.768356000e-03f,  -8.686568000e-03f,  -5.786264000e-03f,
            -8.713446000e-03f,  -5.804172000e-03f,  -8.740324000e-03f,  -5.822080000e-03f,  -8.767202000e-03f,  -5.839988000e-03f,
            -8.794080000e-03f,  -5.857896000e-03f,  -8.820958000e-03f,  -5.875804000e-03f,  -8.847836000e-03f,  -5.893712000e-03f,
            -8.874714000e-03f,  -5.911620000e-03f,  -8.901592000e-03f,  -5.929528000e-03f,  -8.928470000e-03f,  -5.947436000e-03f,
            -8.955348000e-03f,  -5.965344000e-03f,  -8.982226000e-03f,  -5.983252000e-03f,  -9.009104000e-03f,  -6.001160000e-03f,
            -9.035982000e-03f,  -6.019068000e-03f,  -9.062860000e-03f,  -6.036976000e-03f,  -9.089738000e-03f,  -6.054884000e-03f,
            -9.116616000e-03f,  -6.072792000e-03f,  -9.143494000e-03f,  -6.090700000e-03f,  -9.170372000e-03f,  -6.108608000e-03f,
            -9.197250000e-03f,  -6.126516000e-03f,  -9.224128000e-03f,  -6.144424000e-03f,  -9.251006000e-03f,  -6.162332000e-03f,
            -9.277884000e-03f,  -6.180240000e-03f,  -9.304762000e-03f,  -6.198148000e-03f,  -9.331640000e-03f,  -6.216056000e-03f,
            -9.358518000e-03f,  -6.233964000e-03f,  -9.385396000e-03f,  -6.251872000e-03f,  -9.412274000e-03f,  -6.269780000e-03f,
            -9.439152000e-03f,  -6.287688000e-03f,  -9.466030000e-03f,  -6.305596000e-03f,  -9.492908000e-03f,  -6.323504000e-03f,
            -9.519786000e-03f,  -6.341412000e-03f,  -9.546664000e-03f,  -6.359320000e-03f,  -9.573542000e-03f,  -6.377228000e-03f,
            -9.600420000e-03f,  -6.395136000e-03f,  -9.627298000e-03f,  -6.413044000e-03f,  -9.654176000e-03f,  -6.430952000e-03f,
            -9.681054000e-03f,  -6.448860000e-03f,  -9.707932000e-03f,  -6.466768000e-03f,  -9.734810000e-03f,  -6.484676000e-03f,
            -9.761688000e-03f,  -6.502584000e-03f,  -9.788566000e-03f,  -6.520492000e-03f,  -9.815444000e-03f,  -6.538400000e-03f,
            -9.842322000e-03f,  -6.556308000e-03f,  -9.869200000e-03f,  -6.574216000e-03f,  -9.896078000e-03f,  -6.592124000e-03f,
            -9.922956000e-03f,  -6.610032000e-03f,  -9.949834000e-03f,  -6.627940000e-03f,  -9.976712000e-03f,  -6.645848000e-03f,
            -1.000359000e-02f,  -6.663756000e-03f,  -1.003046800e-02f,  -6.681664000e-03f,  -1.005734600e-02f,  -6.699572000e-03f,
            -1.008422400e-02f,  -6.717480000e-03f,  -1.011110200e-02f,  -6.735388000e-03f,  -1.013798000e-02f,  -6.753296000e-03f,
            -1.016485800e-02f,  -6.771204000e-03f,  -1.019173600e-02f,  -6.789112000e-03f,  -1.021861400e-02f,  -6.807020000e-03f,
            -1.024549200e-02f,  -6.824928000e-03f,  -1.027237000e-02f,  -6.842836000e-03f,  -1.029924800e-02f,  -6.860744000e-03f,
            -1.032612600e-02f,  -6.878652000e-03f,  -1.035300400e-02f,  -6.896560000e-03f,  -1.037988200e-02f,  -6.914468000e-03f,
            -1.040676000e-02f,  -6.932376000e-03f,  -1.043363800e-02f,  -6.950284000e-03f,  -1.046051600e-02f,  -6.968192000e-03f,
            -1.048739400e-02f,  -6.986100000e-03f,  -1.051427200e-02f,  -7.004008000e-03f,  -1.054115000e-02f,  -7.021916000e-03f,
            -1.056802800e-02f,  -7.039824000e-03f,  -1.059490600e-02f,  -7.057732000e-03f,  -1.062178400e-02f,  -7.075640000e-03f,
            -1.064866200e-02f,  -7.093548000e-03f,  -1.067554000e-02f,  -7.111456000e-03f,  -1.070241800e-02f,  -7.129364000e-03f,
            -1.072929600e-02f,  -7.147272000e-03f,  -1.075617400e-02f,  -7.165180000e-03f,  -1.078305200e-02f,  -7.183088000e-03f,
            -1.080993000e-02f,  -7.200996000e-03f,  -1.083680800e-02f,  -7.218904000e-03f,  -1.086368600e-02f,  -7.236812000e-03f,
            -1.089056400e-02f,  -7.254720000e-03f,  -1.091744200e-02f,  -7.272628000e-03f,  -1.094432000e-02f,  -7.290536000e-03f,
            -1.097119800e-02f,  -7.308444000e-03f,  -1.099807600e-02f,  -7.326352000e-03f,  -1.102495400e-02f,  -7.344260000e-03f,
            -1.105183200e-02f,  -7.362168000e-03f,  -1.107871000e-02f,  -7.380076000e-03f,  -1.110558800e-02f,  -7.397984000e-03f,
            -1.113246600e-02f,  -7.415892000e-03f,  -1.115934400e-02f,  -7.433800000e-03f,  -1.118622200e-02f,  -7.451708000e-03f,
            -1.121310000e-02f,  -7.469616000e-03f,  -1.123997800e-02f,  -7.487524000e-03f,  -1.126685600e-02f,  -7.505432000e-03f,
        };

        float[] gw_expect = new float[] {
            -1.467606328e+02f,  -1.470230173e+02f,  -1.473306906e+02f,  -1.475941999e+02f,  -1.479007485e+02f,  -1.481653825e+02f,
        };
    }
}
