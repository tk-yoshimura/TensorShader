using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TensorShader;
using static TensorShader.Field;

namespace TensorShaderTest.Links.QuaternionConvolution {
    [TestClass]
    public class QuaternionDeconvolution2DTest {
        [TestMethod]
        public void ReferenceTest() {
            int inchannels = 8, outchannels = 12, kwidth = 3, kheight = 5, inwidth = 7, inheight = 8;
            int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1, batch = 3;

            float[] xval = (new float[inwidth * inheight * inchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * outchannels * inchannels / 4]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            Tensor xtensor = new Tensor(Shape.Map2D(inchannels, inwidth, inheight, batch), xval);
            Tensor ytensor = new Tensor(Shape.Map2D(outchannels, outwidth, outheight, batch), yval);
            Tensor wtensor = new Tensor(Shape.Kernel2D(inchannels, outchannels / 4, kwidth, kheight), wval);

            VariableField x_actual = xtensor;
            ParameterField w = wtensor;
            ParameterField y = ytensor;

            Field x_expect = QuaternionDeconvolution2D(y, w);
            Field err = x_expect - x_actual;

            (Flow flow, Parameters Parameters) = Flow.Optimize(err);

            flow.Execute();

            float[] gy_actual = y.GradTensor.State;
            float[] gw_actual = w.GradTensor.State;

            AssertError.Tolerance(gy_expect, gy_actual, 1e-7f, 1e-5f, $"not equal gy");

            AssertError.Tolerance(gw_expect, gw_actual, 1e-6f, 1e-4f, $"not equal gw"); /*backward tolerance*/
        }

        [TestMethod]
        public void TheoreticalTest() {
            int inchannels = 8, outchannels = 12, kwidth = 3, kheight = 5, inwidth = 7, inheight = 8;
            int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1, batch = 3;

            float[] xval = (new float[inwidth * inheight * inchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * outchannels * inchannels / 4]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            Tensor xtensor = new Tensor(Shape.Map2D(inchannels, inwidth, inheight, batch), xval);
            Tensor ytensor = new Tensor(Shape.Map2D(outchannels, outwidth, outheight, batch), yval);
            Tensor wtensor = new Tensor(Shape.Kernel2D(inchannels, outchannels / 4, kwidth, kheight), wval);

            VariableField x_actual = xtensor;
            ParameterField w = wtensor;
            ParameterField y = ytensor;

            Field yr = QuaternionR(y), yi = QuaternionI(y), yj = QuaternionJ(y), yk = QuaternionK(y);
            Field wr = QuaternionR(w), wi = QuaternionI(w), wj = QuaternionJ(w), wk = QuaternionK(w);

            Shape outshape = Shape.Map2D(inchannels / 4, inwidth, inheight, batch);

            Field xr = Deconvolution2D(yr, wr) - Deconvolution2D(yi, wi) - Deconvolution2D(yj, wj) - Deconvolution2D(yk, wk);
            Field xi = Deconvolution2D(yr, wi) + Deconvolution2D(yi, wr) + Deconvolution2D(yj, wk) - Deconvolution2D(yk, wj);
            Field xj = Deconvolution2D(yr, wj) - Deconvolution2D(yi, wk) + Deconvolution2D(yj, wr) + Deconvolution2D(yk, wi);
            Field xk = Deconvolution2D(yr, wk) + Deconvolution2D(yi, wj) - Deconvolution2D(yj, wi) + Deconvolution2D(yk, wr);

            Field x_expect = QuaternionCast(xr, xi, xj, xk);

            Field err = x_expect - x_actual;

            (Flow flow, Parameters Parameters) = Flow.Optimize(err);

            flow.Execute();

            float[] gy_actual = y.GradTensor.State;
            float[] gw_actual = w.GradTensor.State;

            AssertError.Tolerance(gy_expect, gy_actual, 1e-7f, 1e-5f, $"not equal gy");

            AssertError.Tolerance(gw_expect, gw_actual, 1e-6f, 1e-4f, $"not equal gw"); /*backward tolerance*/
        }

        float[] gy_expect = new float[] {
            3.176930304e+00f,  5.102751600e+00f,  5.145936864e+00f,  5.207303280e+00f,  2.956324992e+00f,  4.764365808e+00f,
            4.800760416e+00f,  4.860674544e+00f,  2.735719680e+00f,  4.425980016e+00f,  4.455583968e+00f,  4.514045808e+00f,
            5.486513280e+00f,  7.641362784e+00f,  7.694896192e+00f,  7.788812864e+00f,  5.134122880e+00f,  7.164170848e+00f,
            7.208616512e+00f,  7.300534848e+00f,  4.781732480e+00f,  6.686978912e+00f,  6.722336832e+00f,  6.812256832e+00f,
            7.330718112e+00f,  9.692640504e+00f,  9.749881296e+00f,  9.860623560e+00f,  6.882788832e+00f,  9.113075256e+00f,
            9.159789456e+00f,  9.268453896e+00f,  6.434859552e+00f,  8.533510008e+00f,  8.569697616e+00f,  8.676284232e+00f,
            7.139248896e+00f,  9.655596768e+00f,  9.710378176e+00f,  9.804100544e+00f,  6.728693248e+00f,  9.106169824e+00f,
            9.151218368e+00f,  9.243458496e+00f,  6.318137600e+00f,  8.556742880e+00f,  8.592058560e+00f,  8.682816448e+00f,
            5.272808448e+00f,  7.914438000e+00f,  7.964911584e+00f,  8.023493232e+00f,  4.993196160e+00f,  7.488131568e+00f,
            7.531040352e+00f,  7.588943856e+00f,  4.713583872e+00f,  7.061825136e+00f,  7.097169120e+00f,  7.154394480e+00f,
            5.017762560e+00f,  8.198578080e+00f,  8.272879680e+00f,  8.338066944e+00f,  4.792049664e+00f,  7.802647200e+00f,
            7.869252672e+00f,  7.933409280e+00f,  4.566336768e+00f,  7.406716320e+00f,  7.465625664e+00f,  7.528751616e+00f,
            8.470956480e+00f,  1.187451043e+01f,  1.197103846e+01f,  1.206991149e+01f,  8.096530112e+00f,  1.132336573e+01f,
            1.140957107e+01f,  1.150704480e+01f,  7.722103744e+00f,  1.077222102e+01f,  1.084810368e+01f,  1.094417811e+01f,
            1.102483190e+01f,  1.462825248e+01f,  1.473673277e+01f,  1.485148944e+01f,  1.054722730e+01f,  1.396742918e+01f,
            1.406394173e+01f,  1.417733597e+01f,  1.006962269e+01f,  1.330660589e+01f,  1.339115069e+01f,  1.350318250e+01f,
            1.043007379e+01f,  1.418374666e+01f,  1.428768589e+01f,  1.438202157e+01f,  1.000126074e+01f,  1.356432982e+01f,
            1.365720909e+01f,  1.375073530e+01f,  9.572447680e+00f,  1.294491299e+01f,  1.302673229e+01f,  1.311944902e+01f,
            7.478505216e+00f,  1.135745731e+01f,  1.144798214e+01f,  1.150339430e+01f,  7.201379328e+00f,  1.088145782e+01f,
            1.096340179e+01f,  1.101866803e+01f,  6.924253440e+00f,  1.040545834e+01f,  1.047882144e+01f,  1.053394176e+01f,
            5.945662848e+00f,  1.034568989e+01f,  1.044886368e+01f,  1.049560128e+01f,  5.772216960e+00f,  9.949593120e+00f,
            1.004501549e+01f,  1.009149658e+01f,  5.598771072e+00f,  9.553496352e+00f,  9.641167296e+00f,  9.687391872e+00f,
            1.005100051e+01f,  1.465559434e+01f,  1.479191322e+01f,  1.486597523e+01f,  9.734831552e+00f,  1.411071651e+01f,
            1.423663898e+01f,  1.431033389e+01f,  9.418662592e+00f,  1.356583869e+01f,  1.368136474e+01f,  1.375469254e+01f,
            1.290078384e+01f,  1.769176243e+01f,  1.784800886e+01f,  1.793314262e+01f,  1.248996144e+01f,  1.704595200e+01f,
            1.719014774e+01f,  1.727508029e+01f,  1.207913904e+01f,  1.640014157e+01f,  1.653228662e+01f,  1.661701795e+01f,
            1.188382176e+01f,  1.682692234e+01f,  1.697673498e+01f,  1.704172538e+01f,  1.152742189e+01f,  1.622792816e+01f,
            1.636660710e+01f,  1.643182022e+01f,  1.117102202e+01f,  1.562893398e+01f,  1.575647923e+01f,  1.582191507e+01f,
            8.158790016e+00f,  1.323970128e+01f,  1.336728211e+01f,  1.339716672e+01f,  7.954280064e+00f,  1.278388483e+01f,
            1.290282950e+01f,  1.293334234e+01f,  7.749770112e+00f,  1.232806838e+01f,  1.243837690e+01f,  1.246951795e+01f,
            4.633480512e+00f,  1.022927429e+01f,  1.035066422e+01f,  1.036054546e+01f,  4.578883008e+00f,  9.899017008e+00f,
            1.001356099e+01f,  1.002400824e+01f,  4.524285504e+00f,  9.568759728e+00f,  9.676457760e+00f,  9.687471024e+00f,
            8.483206272e+00f,  1.425975485e+01f,  1.442048646e+01f,  1.444601581e+01f,  8.315393920e+00f,  1.381039523e+01f,
            1.396196538e+01f,  1.398818746e+01f,  8.147581568e+00f,  1.336103562e+01f,  1.350344429e+01f,  1.353035910e+01f,
            1.101765581e+01f,  1.696548694e+01f,  1.715108587e+01f,  1.718066282e+01f,  1.077824314e+01f,  1.643825935e+01f,
            1.661324875e+01f,  1.664377534e+01f,  1.053883046e+01f,  1.591103177e+01f,  1.607541163e+01f,  1.610688785e+01f,
            9.799382784e+00f,  1.590674045e+01f,  1.608475590e+01f,  1.609809171e+01f,  9.610785280e+00f,  1.542252592e+01f,
            1.559073478e+01f,  1.560527942e+01f,  9.422187776e+00f,  1.493831139e+01f,  1.509671366e+01f,  1.511246714e+01f,
            6.069511488e+00f,  1.233566021e+01f,  1.248579331e+01f,  1.247419973e+01f,  6.009433536e+00f,  1.197100882e+01f,
            1.211352182e+01f,  1.210326840e+01f,  5.949355584e+00f,  1.160635742e+01f,  1.174125034e+01f,  1.173233707e+01f,
            1.084877798e+01f,  2.295877080e+01f,  2.294146838e+01f,  2.299275864e+01f,  1.016743411e+01f,  2.174117861e+01f,
            2.170934410e+01f,  2.176305278e+01f,  9.486090240e+00f,  2.052358642e+01f,  2.047721981e+01f,  2.053334693e+01f,
            1.930945344e+01f,  3.167280470e+01f,  3.164963027e+01f,  3.174158086e+01f,  1.822518976e+01f,  3.004914237e+01f,
            3.000655827e+01f,  3.010167149e+01f,  1.714092608e+01f,  2.842548003e+01f,  2.836348627e+01f,  2.846176211e+01f,
            2.425754371e+01f,  3.683432690e+01f,  3.681062050e+01f,  3.692151636e+01f,  2.294991523e+01f,  3.498240070e+01f,
            3.493655554e+01f,  3.505117966e+01f,  2.164228675e+01f,  3.313047449e+01f,  3.306249058e+01f,  3.318084295e+01f,
            2.126134042e+01f,  3.396296573e+01f,  3.395652218e+01f,  3.404053702e+01f,  2.014987725e+01f,  3.229803414e+01f,
            3.227153581e+01f,  3.235922938e+01f,  1.903841408e+01f,  3.063310256e+01f,  3.058654944e+01f,  3.067792173e+01f,
            1.354295885e+01f,  2.632231128e+01f,  2.634326294e+01f,  2.637628555e+01f,  1.286453952e+01f,  2.507872997e+01f,
            2.508437539e+01f,  2.512059058e+01f,  1.218612019e+01f,  2.383514866e+01f,  2.382548784e+01f,  2.386489560e+01f,
            1.659665280e+01f,  2.988864912e+01f,  2.995112352e+01f,  2.998190438e+01f,  1.590522470e+01f,  2.861019408e+01f,
            2.865612499e+01f,  2.869029888e+01f,  1.521379661e+01f,  2.733173904e+01f,  2.736112646e+01f,  2.739869338e+01f,
            2.733288288e+01f,  4.084485283e+01f,  4.093139686e+01f,  4.099494189e+01f,  2.622363411e+01f,  3.914650045e+01f,
            3.921092531e+01f,  3.927896928e+01f,  2.511438534e+01f,  3.744814806e+01f,  3.749045376e+01f,  3.756299667e+01f,
            3.349952246e+01f,  4.720334112e+01f,  4.730718269e+01f,  4.738393872e+01f,  3.216138922e+01f,  4.527181574e+01f,
            4.535041853e+01f,  4.543244765e+01f,  3.082325597e+01f,  4.334029037e+01f,  4.339365437e+01f,  4.348095658e+01f,
            2.938932115e+01f,  4.322486794e+01f,  4.333651789e+01f,  4.338667821e+01f,  2.826107514e+01f,  4.149363286e+01f,
            4.158242637e+01f,  4.163767546e+01f,  2.713282912e+01f,  3.976239779e+01f,  3.982833485e+01f,  3.988867270e+01f,
            1.925203738e+01f,  3.318908611e+01f,  3.330317318e+01f,  3.330648422e+01f,  1.857997517e+01f,  3.190134134e+01f,
            3.199800019e+01f,  3.200558899e+01f,  1.790791296e+01f,  3.061359658e+01f,  3.069282720e+01f,  3.070469376e+01f,
            1.768878221e+01f,  3.211041053e+01f,  3.226147680e+01f,  3.224394816e+01f,  1.716906048e+01f,  3.095122896e+01f,
            3.108569645e+01f,  3.107233498e+01f,  1.664933875e+01f,  2.979204739e+01f,  2.990991610e+01f,  2.990072179e+01f,
            2.893283347e+01f,  4.352640394e+01f,  4.373236506e+01f,  4.373128595e+01f,  2.804109459e+01f,  4.199357091e+01f,
            4.217733914e+01f,  4.218179117e+01f,  2.714935571e+01f,  4.046073789e+01f,  4.062231322e+01f,  4.063229638e+01f,
            3.526350000e+01f,  5.002050739e+01f,  5.026169462e+01f,  5.026403798e+01f,  3.417130800e+01f,  4.828315392e+01f,
            4.849901942e+01f,  4.850779709e+01f,  3.307911600e+01f,  4.654580045e+01f,  4.673634422e+01f,  4.675155619e+01f,
            3.062409696e+01f,  4.552963210e+01f,  4.576678170e+01f,  4.574778362e+01f,  2.972751661e+01f,  4.397807216e+01f,
            4.419229158e+01f,  4.417941446e+01f,  2.883093626e+01f,  4.242651222e+01f,  4.261780147e+01f,  4.261104531e+01f,
            1.961879386e+01f,  3.466822224e+01f,  3.487908499e+01f,  3.482700864e+01f,  1.913878694e+01f,  3.352009987e+01f,
            3.371347910e+01f,  3.366645466e+01f,  1.865878003e+01f,  3.237197750e+01f,  3.254787322e+01f,  3.250590067e+01f,
            1.274327251e+01f,  2.828435909e+01f,  2.850451382e+01f,  2.842469266e+01f,  1.254644141e+01f,  2.739340037e+01f,
            2.759896771e+01f,  2.752358328e+01f,  1.234961030e+01f,  2.650244165e+01f,  2.669342160e+01f,  2.662247390e+01f,
            2.235923059e+01f,  3.802577597e+01f,  3.832213638e+01f,  3.823953133e+01f,  2.188421824e+01f,  3.685461923e+01f,
            3.713149626e+01f,  3.705474490e+01f,  2.140920589e+01f,  3.568346250e+01f,  3.594085613e+01f,  3.586995846e+01f,
            2.764588301e+01f,  4.345025686e+01f,  4.379378731e+01f,  4.370407850e+01f,  2.702452858e+01f,  4.212842575e+01f,
            4.244973451e+01f,  4.236678142e+01f,  2.640317414e+01f,  4.080659465e+01f,  4.110568171e+01f,  4.102948433e+01f,
            2.333754854e+01f,  3.931167869e+01f,  3.964080582e+01f,  3.953826579e+01f,  2.287271680e+01f,  3.813663280e+01f,
            3.844563142e+01f,  3.834946118e+01f,  2.240788506e+01f,  3.696158691e+01f,  3.725045702e+01f,  3.716065658e+01f,
            1.350358637e+01f,  2.966857925e+01f,  2.994844291e+01f,  2.983166405e+01f,  1.336320634e+01f,  2.880515794e+01f,
            2.906966006e+01f,  2.895809208e+01f,  1.322282630e+01f,  2.794173662e+01f,  2.819087722e+01f,  2.808452011e+01f,
            1.852062566e+01f,  4.081479000e+01f,  4.073699990e+01f,  4.077821400e+01f,  1.737854323e+01f,  3.871799141e+01f,
            3.861792778e+01f,  3.866543102e+01f,  1.623646080e+01f,  3.662119282e+01f,  3.649885565e+01f,  3.655264805e+01f,
            3.313239360e+01f,  5.570424662e+01f,  5.560436435e+01f,  5.569434886e+01f,  3.131625664e+01f,  5.293411389e+01f,
            5.280450003e+01f,  5.290280813e+01f,  2.950011968e+01f,  5.016398115e+01f,  5.000463571e+01f,  5.011126739e+01f,
            4.118436931e+01f,  6.397601330e+01f,  6.387135970e+01f,  6.398240916e+01f,  3.901704163e+01f,  6.085172614e+01f,
            6.071332162e+01f,  6.083390542e+01f,  3.684971395e+01f,  5.772743897e+01f,  5.755528354e+01f,  5.768540167e+01f,
            3.538343194e+01f,  5.827033469e+01f,  5.820266618e+01f,  5.827697350e+01f,  3.357106125e+01f,  5.548989846e+01f,
            5.539185325e+01f,  5.547500026e+01f,  3.175869056e+01f,  5.270946224e+01f,  5.258104032e+01f,  5.267302701e+01f,
            2.181310925e+01f,  4.473018456e+01f,  4.472161430e+01f,  4.472907787e+01f,  2.073588288e+01f,  4.266932837e+01f,
            4.263771043e+01f,  4.265223730e+01f,  1.965865651e+01f,  4.060847218e+01f,  4.055380656e+01f,  4.057539672e+01f,
            2.817554304e+01f,  5.157872016e+01f,  5.162936736e+01f,  5.162574182e+01f,  2.701839974e+01f,  4.941774096e+01f,
            4.944299731e+01f,  4.944718848e+01f,  2.586125645e+01f,  4.725676176e+01f,  4.725662726e+01f,  4.726863514e+01f,
            4.619480928e+01f,  6.981519523e+01f,  6.989175526e+01f,  6.991997229e+01f,  4.435073811e+01f,  6.696963517e+01f,
            6.701227955e+01f,  6.705089376e+01f,  4.250666694e+01f,  6.412407510e+01f,  6.413280384e+01f,  6.418181523e+01f,
            5.597421302e+01f,  7.977842976e+01f,  7.987763261e+01f,  7.991638800e+01f,  5.377555114e+01f,  7.657620230e+01f,
            7.663689533e+01f,  7.668755933e+01f,  5.157688925e+01f,  7.337397485e+01f,  7.339615805e+01f,  7.345873066e+01f,
            4.834856851e+01f,  7.226598922e+01f,  7.238534989e+01f,  7.239133485e+01f,  4.652088954e+01f,  6.942293590e+01f,
            6.950764365e+01f,  6.952461562e+01f,  4.469321056e+01f,  6.657988259e+01f,  6.662993741e+01f,  6.665789638e+01f,
            3.102556954e+01f,  5.502071491e+01f,  5.515836422e+01f,  5.510957414e+01f,  2.995857101e+01f,  5.292122486e+01f,
            5.303259859e+01f,  5.299250995e+01f,  2.889157248e+01f,  5.082173482e+01f,  5.090683296e+01f,  5.087544576e+01f,
            2.943190157e+01f,  5.387513117e+01f,  5.407408992e+01f,  5.399229504e+01f,  2.856590400e+01f,  5.195286480e+01f,
            5.212637741e+01f,  5.205317338e+01f,  2.769990643e+01f,  5.003059843e+01f,  5.017866490e+01f,  5.011405171e+01f,
            4.781466643e+01f,  7.239721354e+01f,  7.267281690e+01f,  7.259659667e+01f,  4.634735763e+01f,  6.987642531e+01f,
            7.011803930e+01f,  7.005324845e+01f,  4.488004883e+01f,  6.735563709e+01f,  6.756326170e+01f,  6.750990022e+01f,
            5.762621616e+01f,  8.234925235e+01f,  8.267538038e+01f,  8.259493334e+01f,  5.585265456e+01f,  7.952035584e+01f,
            7.980789110e+01f,  7.974051389e+01f,  5.407909296e+01f,  7.669145933e+01f,  7.694040182e+01f,  7.688609443e+01f,
            4.936437216e+01f,  7.423234186e+01f,  7.455682842e+01f,  7.445384186e+01f,  4.792761133e+01f,  7.172821616e+01f,
            7.201797606e+01f,  7.192700870e+01f,  4.649085050e+01f,  6.922409046e+01f,  6.947912371e+01f,  6.940017555e+01f,
            3.107879770e+01f,  5.609674320e+01f,  5.639088787e+01f,  5.625685056e+01f,  3.032329382e+01f,  5.425631491e+01f,
            5.452412870e+01f,  5.439956698e+01f,  2.956778995e+01f,  5.241588662e+01f,  5.265736954e+01f,  5.254228339e+01f,
            2.085306451e+01f,  4.633944389e+01f,  4.665836342e+01f,  4.648883986e+01f,  2.051399981e+01f,  4.488778373e+01f,
            4.518437443e+01f,  4.502315832e+01f,  2.017493510e+01f,  4.343612357e+01f,  4.371038544e+01f,  4.355747678e+01f,
            3.623525491e+01f,  6.179179709e+01f,  6.222378630e+01f,  6.203304685e+01f,  3.545304256e+01f,  5.989884323e+01f,
            6.030102714e+01f,  6.012130234e+01f,  3.467083021e+01f,  5.800588938e+01f,  5.837826797e+01f,  5.820955782e+01f,
            4.427411021e+01f,  6.993502678e+01f,  7.043648875e+01f,  7.022749418e+01f,  4.327081402e+01f,  6.781859215e+01f,
            6.828622027e+01f,  6.808978750e+01f,  4.226751782e+01f,  6.570215753e+01f,  6.613595179e+01f,  6.595208081e+01f,
            3.687571430e+01f,  6.271661693e+01f,  6.319685574e+01f,  6.297843987e+01f,  3.613464832e+01f,  6.085073968e+01f,
            6.130052806e+01f,  6.109364294e+01f,  3.539358234e+01f,  5.898486243e+01f,  5.940420038e+01f,  5.920884602e+01f,
            2.093766125e+01f,  4.700149829e+01f,  4.741109251e+01f,  4.718912837e+01f,  2.071697914e+01f,  4.563930706e+01f,
            4.602579830e+01f,  4.581291576e+01f,  2.049629702e+01f,  4.427711582e+01f,  4.464050410e+01f,  4.443670315e+01f,
        };

        float[] gw_expect = new float[] {
            1.230276089e+02f,  1.875540528e+02f,  1.869336516e+02f,  1.860799675e+02f,  1.198005602e+02f,  1.846660032e+02f,
            1.840454215e+02f,  1.831935384e+02f,  1.239842882e+02f,  1.890415008e+02f,  1.884190337e+02f,  1.875512971e+02f,
            1.207310738e+02f,  1.861309872e+02f,  1.855082705e+02f,  1.846424731e+02f,  1.249409676e+02f,  1.905289488e+02f,
            1.899044158e+02f,  1.890226267e+02f,  1.216615874e+02f,  1.875959712e+02f,  1.869711194e+02f,  1.860914078e+02f,
            1.351897454e+02f,  2.003200112e+02f,  1.996312285e+02f,  1.987320761e+02f,  1.317158815e+02f,  1.971853307e+02f,
            1.964964596e+02f,  1.955989238e+02f,  1.362620464e+02f,  2.019307883e+02f,  2.012396789e+02f,  2.003253192e+02f,
            1.327597819e+02f,  1.987713973e+02f,  1.980801248e+02f,  1.971675314e+02f,  1.373343475e+02f,  2.035415653e+02f,
            2.028481294e+02f,  2.019185623e+02f,  1.338036823e+02f,  2.003574640e+02f,  1.996637900e+02f,  1.987361390e+02f,
            1.163227154e+02f,  1.821644006e+02f,  1.815213233e+02f,  1.807111051e+02f,  1.130854716e+02f,  1.792668470e+02f,
            1.786239348e+02f,  1.778148264e+02f,  1.172627561e+02f,  1.836501206e+02f,  1.830046663e+02f,  1.821804994e+02f,
            1.139986553e+02f,  1.807294118e+02f,  1.800840535e+02f,  1.792611346e+02f,  1.182027967e+02f,  1.851358406e+02f,
            1.844880094e+02f,  1.836498936e+02f,  1.149118390e+02f,  1.821919766e+02f,  1.815441722e+02f,  1.807074427e+02f,
            1.384206923e+02f,  2.074198277e+02f,  2.065510522e+02f,  2.055605464e+02f,  1.343220033e+02f,  2.036606976e+02f,
            2.027920216e+02f,  2.018027568e+02f,  1.395793237e+02f,  2.091619094e+02f,  2.082895543e+02f,  2.072820671e+02f,
            1.354465270e+02f,  2.053723320e+02f,  2.044999865e+02f,  2.034939200e+02f,  1.407379551e+02f,  2.109039912e+02f,
            2.100280565e+02f,  2.090035877e+02f,  1.365710508e+02f,  2.070839664e+02f,  2.062079514e+02f,  2.051850832e+02f,
            1.510821556e+02f,  2.206583254e+02f,  2.196988091e+02f,  2.186541779e+02f,  1.466654839e+02f,  2.165815559e+02f,
            2.156223107e+02f,  2.145785772e+02f,  1.523715383e+02f,  2.225387029e+02f,  2.215751696e+02f,  2.205121749e+02f,
            1.479177498e+02f,  2.184284620e+02f,  2.174651025e+02f,  2.164032002e+02f,  1.536609209e+02f,  2.244190804e+02f,
            2.234515302e+02f,  2.223701718e+02f,  1.491700158e+02f,  2.202753682e+02f,  2.193078944e+02f,  2.182278232e+02f,
            1.295272454e+02f,  1.998394111e+02f,  1.989471585e+02f,  1.980040921e+02f,  1.254215234e+02f,  1.960741466e+02f,
            1.951824428e+02f,  1.942397189e+02f,  1.306576570e+02f,  2.015680490e+02f,  2.006718125e+02f,  1.997118994e+02f,
            1.265169288e+02f,  1.977714386e+02f,  1.968756609e+02f,  1.959162701e+02f,  1.317880686e+02f,  2.032966869e+02f,
            2.023964664e+02f,  2.014197067e+02f,  1.276123342e+02f,  1.994687306e+02f,  1.985688791e+02f,  1.975928213e+02f,
            1.149259912e+02f,  1.885387795e+02f,  1.875637571e+02f,  1.865843404e+02f,  1.105318824e+02f,  1.844856605e+02f,
            1.835114529e+02f,  1.825318465e+02f,  1.159717981e+02f,  1.902199651e+02f,  1.892399668e+02f,  1.882434425e+02f,
            1.115396903e+02f,  1.861324934e+02f,  1.851532132e+02f,  1.841566928e+02f,  1.170176050e+02f,  1.919011507e+02f,
            1.909161766e+02f,  1.899025447e+02f,  1.125474981e+02f,  1.877793264e+02f,  1.867949736e+02f,  1.857815390e+02f,
            1.254622163e+02f,  1.996432347e+02f,  1.985704058e+02f,  1.975354257e+02f,  1.207293658e+02f,  1.952518739e+02f,
            1.941801099e+02f,  1.931444400e+02f,  1.266272997e+02f,  2.014510643e+02f,  2.003726890e+02f,  1.993192143e+02f,
            1.218530794e+02f,  1.970219640e+02f,  1.959445487e+02f,  1.948905940e+02f,  1.277923831e+02f,  2.032588939e+02f,
            2.021749723e+02f,  2.011030029e+02f,  1.229767929e+02f,  1.987920541e+02f,  1.977089876e+02f,  1.966367479e+02f,
            1.050039096e+02f,  1.799388409e+02f,  1.789457768e+02f,  1.780083849e+02f,  1.006100428e+02f,  1.758869315e+02f,
            1.748951661e+02f,  1.739566167e+02f,  1.060093420e+02f,  1.815943830e+02f,  1.805959076e+02f,  1.796415532e+02f,
            1.015765084e+02f,  1.775071532e+02f,  1.765098797e+02f,  1.755545615e+02f,  1.070147744e+02f,  1.832499251e+02f,
            1.822460383e+02f,  1.812747215e+02f,  1.025429740e+02f,  1.791273750e+02f,  1.781245934e+02f,  1.771525063e+02f,
            6.401866630e+01f,  1.424343528e+02f,  1.415207263e+02f,  1.406553436e+02f,  5.991344546e+01f,  1.386715939e+02f,
            1.377595184e+02f,  1.368924738e+02f,  6.467846863e+01f,  1.437814138e+02f,  1.428619889e+02f,  1.419818850e+02f,
            6.053623711e+01f,  1.399853045e+02f,  1.390673407e+02f,  1.381857546e+02f,  6.533827097e+01f,  1.451284747e+02f,
            1.442032515e+02f,  1.433084263e+02f,  6.115902876e+01f,  1.412990150e+02f,  1.403751630e+02f,  1.394790354e+02f,
            7.089530949e+01f,  1.498896206e+02f,  1.488868573e+02f,  1.479696297e+02f,  6.647942399e+01f,  1.458167823e+02f,
            1.448158626e+02f,  1.438963878e+02f,  7.164202199e+01f,  1.513308269e+02f,  1.503216430e+02f,  1.493885004e+02f,
            6.718587487e+01f,  1.472213722e+02f,  1.462139346e+02f,  1.452787396e+02f,  7.238873450e+01f,  1.527720332e+02f,
            1.517564287e+02f,  1.508073712e+02f,  6.789232574e+01f,  1.486259622e+02f,  1.476120066e+02f,  1.466610913e+02f,
            5.446633298e+01f,  1.342194146e+02f,  1.332963078e+02f,  1.324612574e+02f,  5.036859439e+01f,  1.304650365e+02f,
            1.295439300e+02f,  1.287063191e+02f,  5.507717954e+01f,  1.355322957e+02f,  1.346029862e+02f,  1.337533493e+02f,
            5.094153170e+01f,  1.317436687e+02f,  1.308162696e+02f,  1.299642519e+02f,  5.568802610e+01f,  1.368451768e+02f,
            1.359096646e+02f,  1.350454413e+02f,  5.151446902e+01f,  1.330223008e+02f,  1.320886091e+02f,  1.312221847e+02f,
            -2.210884560e+00f,  8.122718880e+01f,  8.055754152e+01f,  7.987599120e+01f,  -5.447264400e+00f,  7.833395520e+01f,
            7.766620104e+01f,  7.698230448e+01f,  -2.153740560e+00f,  8.202412800e+01f,  8.134888968e+01f,  8.065722672e+01f,
            -5.420433360e+00f,  7.910428320e+01f,  7.843086888e+01f,  7.773699792e+01f,  -2.096596560e+00f,  8.282106720e+01f,
            8.214023784e+01f,  8.143846224e+01f,  -5.393602320e+00f,  7.987461120e+01f,  7.919553672e+01f,  7.849169136e+01f,
            5.594106600e-01f,  8.460541428e+01f,  8.387059518e+01f,  8.314499784e+01f,  -2.913330060e+00f,  8.147634972e+01f,
            8.074368870e+01f,  8.001521520e+01f,  6.571638600e-01f,  8.545016892e+01f,  8.470920438e+01f,  8.397266784e+01f,
            -2.848470300e+00f,  8.229190116e+01f,  8.155301982e+01f,  8.081375688e+01f,  7.549170600e-01f,  8.629492356e+01f,
            8.554781358e+01f,  8.480033784e+01f,  -2.783610540e+00f,  8.310745260e+01f,  8.236235094e+01f,  8.161229856e+01f,
            -9.856155600e+00f,  7.493552064e+01f,  7.426497000e+01f,  7.359889200e+01f,  -1.308199464e+01f,  7.205351904e+01f,
            7.138520712e+01f,  7.071609168e+01f,  -9.848827920e+00f,  7.569755424e+01f,  7.502110152e+01f,  7.434501456e+01f,
            -1.310567112e+01f,  7.278825024e+01f,  7.211396712e+01f,  7.143498096e+01f,  -9.841500240e+00f,  7.645958784e+01f,
            7.577723304e+01f,  7.509113712e+01f,  -1.312934760e+01f,  7.352298144e+01f,  7.284272712e+01f,  7.215387024e+01f,

        };
    }
}
