using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using TensorShader;
using static TensorShader.Field;

namespace TensorShaderTest.Links.TrivectorConvolution {
    [TestClass]
    public class TrivectorDeconvolution2DTest {
        [TestMethod]
        public void ReferenceTest() {
            int inchannels = 9, outchannels = 12, kwidth = 3, kheight = 5, inwidth = 7, inheight = 8;
            int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1, batch = 3;

            float[] xval = (new float[inwidth * inheight * inchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * outchannels * inchannels / 9 * 4]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            VariableField x_actual = new Tensor(Shape.Map2D(inchannels, inwidth, inheight, batch), xval);
            ParameterField w = new Tensor(Shape.Kernel2D(inchannels / 3 * 4, outchannels / 3, kwidth, kheight), wval);
            ParameterField y = new Tensor(Shape.Map2D(outchannels, outwidth, outheight, batch), yval);

            Field x_expect = TrivectorDeconvolution2D(y, w);
            Field err = x_expect - x_actual;

            (Flow flow, Parameters parameters) = Flow.Optimize(err);

            flow.Execute();

            float[] gy_actual = y.GradState;
            float[] gw_actual = w.GradState;

            AssertError.Tolerance(gw_expect, gw_actual, 1e-6f, 1e-5f, $"not equal gw");

            AssertError.Tolerance(gy_expect, gy_actual, 1e-6f, 1e-5f, $"not equal gy");
        }

        [TestMethod]
        public void TheoreticalTest() {
            int inchannels = 9, outchannels = 12, kwidth = 3, kheight = 5, inwidth = 7, inheight = 8;
            int outwidth = inwidth - kwidth + 1, outheight = inheight - kheight + 1, batch = 3;

            float[] xval = (new float[inwidth * inheight * inchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] yval = (new float[outwidth * outheight * outchannels * batch]).Select((_, idx) => idx * 1e-3f).ToArray();
            float[] wval = (new float[kwidth * kheight * outchannels * inchannels / 9 * 4]).Select((_, idx) => idx * 1e-3f).Reverse().ToArray();

            VariableField x_actual = new Tensor(Shape.Map2D(inchannels, inwidth, inheight, batch), xval);
            ParameterField w = new Tensor(Shape.Kernel2D(inchannels / 3 * 4, outchannels / 3, kwidth, kheight), wval);
            ParameterField y = new Tensor(Shape.Map2D(outchannels, outwidth, outheight, batch), yval);

            Field yx = TrivectorX(y), yy = TrivectorY(y), yz = TrivectorZ(y);
            Field wr = QuaternionR(w), wi = QuaternionI(w), wj = QuaternionJ(w), wk = QuaternionK(w);
            Field wrr = wr * wr, wii = wi * wi, wjj = wj * wj, wkk = wk * wk;
            Field wri = wr * wi, wrj = wr * wj, wrk = wr * wk, wij = wi * wj, wik = wi * wk, wjk = wj * wk;

            Field xx = Deconvolution2D(yx, (wrr + wii - wjj - wkk)) + 2 * (Deconvolution2D(yy, (wij - wrk)) + Deconvolution2D(yz, (wik + wrj)));
            Field xy = Deconvolution2D(yy, (wrr - wii + wjj - wkk)) + 2 * (Deconvolution2D(yz, (wjk - wri)) + Deconvolution2D(yx, (wij + wrk)));
            Field xz = Deconvolution2D(yz, (wrr - wii - wjj + wkk)) + 2 * (Deconvolution2D(yx, (wik - wrj)) + Deconvolution2D(yy, (wjk + wri)));

            Field x_expect = TrivectorCast(xx, xy, xz);

            Field err = x_expect - x_actual;

            (Flow flow, Parameters parameters) = Flow.Optimize(err);

            flow.Execute();

            float[] gy_actual = y.GradState;
            float[] gw_actual = w.GradState;

            AssertError.Tolerance(gw_expect, gw_actual, 1e-6f, 1e-5f, $"not equal gw");

            AssertError.Tolerance(gy_expect, gy_actual, 1e-6f, 1e-5f, $"not equal gy");
        }

        float[] gy_expect = new float[] {
            3.134407795e+01f,  3.192707531e+01f,  3.249603050e+01f,  2.918565701e+01f,  2.973770967e+01f,  3.027218487e+01f,
            2.712916741e+01f,  2.765135870e+01f,  2.815317101e+01f,  2.517460912e+01f,  2.566802241e+01f,  2.613898892e+01f,
            4.892106825e+01f,  4.971549475e+01f,  5.045165766e+01f,  4.569999608e+01f,  4.645302640e+01f,  4.714374059e+01f,
            4.262241938e+01f,  4.333545989e+01f,  4.398310345e+01f,  3.968833814e+01f,  4.036279522e+01f,  4.096974622e+01f,
            6.394653309e+01f,  6.484632931e+01f,  6.566106453e+01f,  5.988703391e+01f,  6.074041611e+01f,  6.150377611e+01f,
            5.600085981e+01f,  5.680938042e+01f,  5.752406566e+01f,  5.228801078e+01f,  5.305322225e+01f,  5.372193319e+01f,
            6.490359367e+01f,  6.570729845e+01f,  6.644870135e+01f,  6.093169809e+01f,  6.169440723e+01f,  6.238834209e+01f,
            5.712067991e+01f,  5.784373422e+01f,  5.849263938e+01f,  5.347053911e+01f,  5.415527941e+01f,  5.476159322e+01f,
            5.327635156e+01f,  5.387804945e+01f,  5.447215285e+01f,  5.013415507e+01f,  5.070572076e+01f,  5.126197509e+01f,
            4.711176599e+01f,  4.765415150e+01f,  4.817439602e+01f,  4.420918432e+01f,  4.472334166e+01f,  4.520941562e+01f,
            6.167727857e+01f,  6.241840153e+01f,  6.316821914e+01f,  5.836266487e+01f,  5.906848862e+01f,  5.977323913e+01f,
            5.515659024e+01f,  5.582812057e+01f,  5.648964367e+01f,  5.205905468e+01f,  5.269729737e+01f,  5.331743275e+01f,
            9.129681894e+01f,  9.229624763e+01f,  9.327840517e+01f,  8.651232353e+01f,  8.746495523e+01f,  8.838764372e+01f,
            8.187964192e+01f,  8.278677950e+01f,  8.365240234e+01f,  7.739877411e+01f,  7.826172044e+01f,  7.907268103e+01f,
            1.136856724e+02f,  1.148116930e+02f,  1.159115484e+02f,  1.078367532e+02f,  1.089105463e+02f,  1.099429615e+02f,
            1.021693245e+02f,  1.031923262e+02f,  1.041600270e+02f,  9.668338615e+01f,  9.765703258e+01f,  9.856274477e+01f,
            1.105842614e+02f,  1.115864677e+02f,  1.125953255e+02f,  1.050279512e+02f,  1.059842377e+02f,  1.069310311e+02f,
            9.963795567e+01f,  1.005495597e+02f,  1.014367457e+02f,  9.441427484e+01f,  9.528243376e+01f,  9.611246925e+01f,
            8.778128439e+01f,  8.852799487e+01f,  8.933567618e+01f,  8.350161156e+01f,  8.421479265e+01f,  8.497361018e+01f,
            7.934384956e+01f,  8.002437572e+01f,  8.073617799e+01f,  7.530799837e+01f,  7.595674409e+01f,  7.662337962e+01f,
            8.585653074e+01f,  8.660191162e+01f,  8.744316392e+01f,  8.196575369e+01f,  8.267863286e+01f,  8.347126613e+01f,
            7.817235205e+01f,  7.885351940e+01f,  7.959915949e+01f,  7.447632584e+01f,  7.512657126e+01f,  7.582684400e+01f,
            1.235111221e+02f,  1.245094698e+02f,  1.256161566e+02f,  1.180019792e+02f,  1.189574792e+02f,  1.200002432e+02f,
            1.126288277e+02f,  1.135425027e+02f,  1.145234586e+02f,  1.073916677e+02f,  1.082645402e+02f,  1.091858029e+02f,
            1.495890377e+02f,  1.507093737e+02f,  1.519573734e+02f,  1.429861113e+02f,  1.440587878e+02f,  1.452343011e+02f,
            1.365444689e+02f,  1.375706118e+02f,  1.386760311e+02f,  1.302641103e+02f,  1.312448458e+02f,  1.322825634e+02f,
            1.416798059e+02f,  1.426729352e+02f,  1.438245708e+02f,  1.355396358e+02f,  1.364910596e+02f,  1.375761440e+02f,
            1.295451907e+02f,  1.304558753e+02f,  1.314765614e+02f,  1.236964706e+02f,  1.245673823e+02f,  1.255258232e+02f,
            1.097820661e+02f,  1.105168923e+02f,  1.114399722e+02f,  1.051572677e+02f,  1.058618943e+02f,  1.067328896e+02f,
            1.006369747e+02f,  1.013120786e+02f,  1.021326073e+02f,  9.622118720e+01f,  9.686744537e+01f,  9.763912522e+01f,
            8.489939836e+01f,  8.549324727e+01f,  8.630115666e+01f,  8.152011455e+01f,  8.209009344e+01f,  8.285452958e+01f,
            7.820891720e+01f,  7.875553364e+01f,  7.947772844e+01f,  7.496580631e+01f,  7.548956788e+01f,  7.617075326e+01f,
            1.206036051e+02f,  1.213953382e+02f,  1.224533566e+02f,  1.158468424e+02f,  1.166071970e+02f,  1.176085887e+02f,
            1.111864403e+02f,  1.119160757e+02f,  1.128624294e+02f,  1.066223989e+02f,  1.073219740e+02f,  1.082148786e+02f,
            1.438768857e+02f,  1.447623150e+02f,  1.459578275e+02f,  1.382371901e+02f,  1.390878087e+02f,  1.402193009e+02f,
            1.327115957e+02f,  1.335281291e+02f,  1.345973911e+02f,  1.273001025e+02f,  1.280832763e+02f,  1.290920979e+02f,
            1.337561566e+02f,  1.345368726e+02f,  1.356448105e+02f,  1.286039169e+02f,  1.293543617e+02f,  1.304035838e+02f,
            1.235528591e+02f,  1.242736509e+02f,  1.252657660e+02f,  1.186029834e+02f,  1.192947400e+02f,  1.202313573e+02f,
            1.013194874e+02f,  1.018910455e+02f,  1.027815715e+02f,  9.753847721e+01f,  9.808839740e+01f,  9.893300109e+01f,
            9.382709000e+01f,  9.435579748e+01f,  9.515568928e+01f,  9.018532577e+01f,  9.069324572e+01f,  9.144963613e+01f,
            1.627168447e+02f,  1.633002275e+02f,  1.637168583e+02f,  1.535569781e+02f,  1.541094675e+02f,  1.544815163e+02f,
            1.447430438e+02f,  1.452657267e+02f,  1.455965396e+02f,  1.362750418e+02f,  1.367690048e+02f,  1.370619284e+02f,
            2.310709994e+02f,  2.318659397e+02f,  2.324044883e+02f,  2.183438390e+02f,  2.190974442e+02f,  2.195759762e+02f,
            2.060809570e+02f,  2.067946380e+02f,  2.072175259e+02f,  1.942823534e+02f,  1.949575211e+02f,  1.953291374e+02f,
            2.713827351e+02f,  2.722830954e+02f,  2.728906811e+02f,  2.566151662e+02f,  2.574691763e+02f,  2.580080583e+02f,
            2.423763750e+02f,  2.431855923e+02f,  2.436606847e+02f,  2.286663613e+02f,  2.294323433e+02f,  2.298485603e+02f,
            2.492257060e+02f,  2.500298156e+02f,  2.506203903e+02f,  2.358472416e+02f,  2.366104078e+02f,  2.371363007e+02f,
            2.229346958e+02f,  2.236582638e+02f,  2.241238542e+02f,  2.104880685e+02f,  2.111733837e+02f,  2.115830510e+02f,
            1.890350239e+02f,  1.896368893e+02f,  1.901730966e+02f,  1.790938452e+02f,  1.796656119e+02f,  1.801485764e+02f,
            1.694849913e+02f,  1.700276148e+02f,  1.704605979e+02f,  1.602084623e+02f,  1.607228979e+02f,  1.611091612e+02f,
            2.308726899e+02f,  2.316139267e+02f,  2.323468377e+02f,  2.195281828e+02f,  2.202341440e+02f,  2.209006307e+02f,
            2.085174977e+02f,  2.091891929e+02f,  2.097926315e+02f,  1.978406345e+02f,  1.984790732e+02f,  1.990228399e+02f,
            3.224573352e+02f,  3.234569809e+02f,  3.244338839e+02f,  3.068926740e+02f,  3.078455457e+02f,  3.087337970e+02f,
            2.917756359e+02f,  2.926830415e+02f,  2.934870421e+02f,  2.771062209e+02f,  2.779694683e+02f,  2.786936193e+02f,
            3.751918581e+02f,  3.763181549e+02f,  3.774340482e+02f,  3.572646651e+02f,  3.583387545e+02f,  3.593537204e+02f,
            3.398463454e+02f,  3.408696693e+02f,  3.417886465e+02f,  3.229368991e+02f,  3.239108992e+02f,  3.247388265e+02f,
            3.423361041e+02f,  3.433384969e+02f,  3.444031399e+02f,  3.262138914e+02f,  3.271703771e+02f,  3.281415944e+02f,
            3.105380660e+02f,  3.114498871e+02f,  3.123320721e+02f,  2.953086278e+02f,  2.961770267e+02f,  2.969745730e+02f,
            2.581707639e+02f,  2.589175271e+02f,  2.598313595e+02f,  2.462936381e+02f,  2.470068751e+02f,  2.478461293e+02f,
            2.347322325e+02f,  2.354128215e+02f,  2.361807604e+02f,  2.234865471e+02f,  2.241353666e+02f,  2.248352527e+02f,
            2.558696632e+02f,  2.566151178e+02f,  2.576238814e+02f,  2.446329398e+02f,  2.453458819e+02f,  2.462778842e+02f,
            2.336672769e+02f,  2.343485002e+02f,  2.352066971e+02f,  2.229726745e+02f,  2.236229726e+02f,  2.244103201e+02f,
            3.541314086e+02f,  3.551299963e+02f,  3.564760656e+02f,  3.388061928e+02f,  3.397619098e+02f,  3.410065148e+02f,
            3.238458152e+02f,  3.247596894e+02f,  3.259066672e+02f,  3.092502758e+02f,  3.101233349e+02f,  3.111765227e+02f,
            4.094110773e+02f,  4.105317670e+02f,  4.120688541e+02f,  3.918444084e+02f,  3.929174070e+02f,  3.943395811e+02f,
            3.746923118e+02f,  3.757187511e+02f,  3.770303080e+02f,  3.579547875e+02f,  3.589357993e+02f,  3.601410348e+02f,
            3.709615744e+02f,  3.719550048e+02f,  3.734057783e+02f,  3.552830714e+02f,  3.562347632e+02f,  3.575800910e+02f,
            3.399656050e+02f,  3.408765296e+02f,  3.421202259e+02f,  3.250091752e+02f,  3.258803039e+02f,  3.270261830e+02f,
            2.770943537e+02f,  2.778293760e+02f,  2.790404565e+02f,  2.656830028e+02f,  2.663877942e+02f,  2.675159419e+02f,
            2.545227720e+02f,  2.551980134e+02f,  2.562460538e+02f,  2.436136613e+02f,  2.442600334e+02f,  2.452307922e+02f,
            2.183525863e+02f,  2.189467135e+02f,  2.200709640e+02f,  2.097032522e+02f,  2.102734692e+02f,  2.113260506e+02f,
            2.012284116e+02f,  2.017752291e+02f,  2.027583523e+02f,  1.929280642e+02f,  1.934519933e+02f,  1.943678691e+02f,
            3.013848395e+02f,  3.021771474e+02f,  3.036590958e+02f,  2.895696184e+02f,  2.903304868e+02f,  2.917189502e+02f,
            2.779929743e+02f,  2.787230668e+02f,  2.800208946e+02f,  2.666549073e+02f,  2.673548872e+02f,  2.685649291e+02f,
            3.470416320e+02f,  3.479278317e+02f,  3.496096530e+02f,  3.335272549e+02f,  3.343785703e+02f,  3.359552045e+02f,
            3.202848465e+02f,  3.211020078e+02f,  3.225766333e+02f,  3.073144066e+02f,  3.080981445e+02f,  3.094739392e+02f,
            3.118098889e+02f,  3.125913154e+02f,  3.141665448e+02f,  2.998679816e+02f,  3.006190670e+02f,  3.020982779e+02f,
            2.881596016e+02f,  2.888809683e+02f,  2.902669769e+02f,  2.766847489e+02f,  2.773770192e+02f,  2.786726418e+02f,
            2.292652834e+02f,  2.298373911e+02f,  2.311318374e+02f,  2.207552292e+02f,  2.213056410e+02f,  2.225250804e+02f,
            2.124014627e+02f,  2.129306070e+02f,  2.140771220e+02f,  2.042039838e+02f,  2.047122891e+02f,  2.057879621e+02f,
            2.940896115e+02f,  2.946733796e+02f,  2.949376862e+02f,  2.779282992e+02f,  2.784812254e+02f,  2.786908476e+02f,
            2.623569202e+02f,  2.628800946e+02f,  2.630399082e+02f,  2.473754746e+02f,  2.478699873e+02f,  2.479848679e+02f,
            4.132209306e+02f,  4.140163846e+02f,  4.143573190e+02f,  3.909876819e+02f,  3.917418620e+02f,  3.920082118e+02f,
            3.695394946e+02f,  3.702538161e+02f,  3.704519484e+02f,  3.488763687e+02f,  3.495522469e+02f,  3.496885286e+02f,
            4.788189370e+02f,  4.797198615e+02f,  4.801202977e+02f,  4.533432985e+02f,  4.541979365e+02f,  4.545123405e+02f,
            4.287518901e+02f,  4.295618041e+02f,  4.297973037e+02f,  4.050447119e+02f,  4.058114643e+02f,  4.059751874e+02f,
            4.335478183e+02f,  4.343523327e+02f,  4.347920792e+02f,  4.107627851e+02f,  4.115264083e+02f,  4.118842593e+02f,
            3.887487116e+02f,  3.894727934e+02f,  3.897550691e+02f,  3.675055979e+02f,  3.681914880e+02f,  3.684045087e+02f,
            3.247936962e+02f,  3.253957291e+02f,  3.258740403e+02f,  3.080535352e+02f,  3.086255031e+02f,  3.090351777e+02f,
            2.918582166e+02f,  2.924010782e+02f,  2.927467999e+02f,  2.762077402e+02f,  2.767224542e+02f,  2.770089069e+02f,
            4.000681012e+02f,  4.008094519e+02f,  4.015254562e+02f,  3.806937008e+02f,  3.813997995e+02f,  3.820280224e+02f,
            3.618784052e+02f,  3.625502652e+02f,  3.630956193e+02f,  3.436222144e+02f,  3.442608491e+02f,  3.447282470e+02f,
            5.536178514e+02f,  5.546177142e+02f,  5.555893627e+02f,  5.272730245e+02f,  5.282261362e+02f,  5.290799503e+02f,
            5.016716299e+02f,  5.025793035e+02f,  5.033216819e+02f,  4.768136676e+02f,  4.776772163e+02f,  4.783145576e+02f,
            6.366980437e+02f,  6.378246169e+02f,  6.389565479e+02f,  6.066925769e+02f,  6.077669627e+02f,  6.087644792e+02f,
            5.775233664e+02f,  5.785470124e+02f,  5.794172660e+02f,  5.491904121e+02f,  5.501647659e+02f,  5.509149083e+02f,
            5.740879469e+02f,  5.750905261e+02f,  5.762109542e+02f,  5.473998317e+02f,  5.483565166e+02f,  5.493521577e+02f,
            5.214381763e+02f,  5.223502144e+02f,  5.232273986e+02f,  4.962029807e+02f,  4.970716196e+02f,  4.978366767e+02f,
            4.285602435e+02f,  4.293070594e+02f,  4.303270429e+02f,  4.090856646e+02f,  4.097989575e+02f,  4.107186485e+02f,
            3.901206154e+02f,  3.908012673e+02f,  3.916253428e+02f,  3.716650959e+02f,  3.723139891e+02f,  3.730471257e+02f,
            4.258827956e+02f,  4.266283239e+02f,  4.278045989e+02f,  4.073001260e+02f,  4.080131309e+02f,  4.090845023e+02f,
            3.891622018e+02f,  3.898434810e+02f,  3.908142347e+02f,  3.714690232e+02f,  3.721193740e+02f,  3.729937961e+02f,
            5.847516951e+02f,  5.857505227e+02f,  5.873359745e+02f,  5.596104064e+02f,  5.605663405e+02f,  5.620127864e+02f,
            5.350628027e+02f,  5.359768761e+02f,  5.372898758e+02f,  5.111088839e+02f,  5.119821295e+02f,  5.131672426e+02f,
            6.692331170e+02f,  6.703541604e+02f,  6.721803347e+02f,  6.407027055e+02f,  6.417760262e+02f,  6.434448611e+02f,
            6.128401547e+02f,  6.138668904e+02f,  6.153845849e+02f,  5.856454647e+02f,  5.866267528e+02f,  5.879995061e+02f,
            6.002433429e+02f,  6.012370744e+02f,  6.029869859e+02f,  5.750265071e+02f,  5.759784669e+02f,  5.775840379e+02f,
            5.503860194e+02f,  5.512971840e+02f,  5.527638903e+02f,  5.263218798e+02f,  5.271932256e+02f,  5.285265429e+02f,
            4.444066413e+02f,  4.451418596e+02f,  4.466409408e+02f,  4.262087379e+02f,  4.269136942e+02f,  4.282989941e+02f,
            4.084085693e+02f,  4.090839481e+02f,  4.103595003e+02f,  3.910061354e+02f,  3.916526214e+02f,  3.928224592e+02f,
            3.518057742e+02f,  3.524001797e+02f,  3.538407713e+02f,  3.378863899e+02f,  3.384568449e+02f,  3.397975716e+02f,
            3.242479059e+02f,  3.247949246e+02f,  3.260389762e+02f,  3.108903222e+02f,  3.114144187e+02f,  3.125649850e+02f,
            4.821660739e+02f,  4.829589567e+02f,  4.848648350e+02f,  4.632923944e+02f,  4.640537766e+02f,  4.658293117e+02f,
            4.447995084e+02f,  4.455300579e+02f,  4.471793599e+02f,  4.266874157e+02f,  4.273878005e+02f,  4.289149796e+02f,
            5.502063783e+02f,  5.510933485e+02f,  5.532614785e+02f,  5.288173198e+02f,  5.296693318e+02f,  5.316911082e+02f,
            5.078580973e+02f,  5.086758865e+02f,  5.105558755e+02f,  4.873287107e+02f,  4.881130127e+02f,  4.898557804e+02f,
            4.898636212e+02f,  4.906457583e+02f,  4.926882790e+02f,  4.711320464e+02f,  4.718837723e+02f,  4.737929721e+02f,
            4.527663441e+02f,  4.534882857e+02f,  4.552681879e+02f,  4.347665143e+02f,  4.354592985e+02f,  4.371139263e+02f,
            3.572110793e+02f,  3.577837368e+02f,  3.594821033e+02f,  3.439719812e+02f,  3.445228845e+02f,  3.461171598e+02f,
            3.309758354e+02f,  3.315054164e+02f,  3.329985547e+02f,  3.182226419e+02f,  3.187313325e+02f,  3.201262882e+02f,
        };

        float[] gw_expect = new float[] {
            1.129860262e+03f,  1.130062715e+03f,  1.126497036e+03f,  1.123596924e+03f,  1.106237624e+03f,  1.106447022e+03f,
            1.102926853e+03f,  1.100060347e+03f,  1.082940230e+03f,  1.083156517e+03f,  1.079681480e+03f,  1.076848394e+03f,
            1.117694702e+03f,  1.117840122e+03f,  1.114302757e+03f,  1.111459972e+03f,  1.094223135e+03f,  1.094375689e+03f,
            1.090884165e+03f,  1.088074628e+03f,  1.071076509e+03f,  1.071236149e+03f,  1.067790076e+03f,  1.065013600e+03f,
            1.105301992e+03f,  1.105388549e+03f,  1.101881793e+03f,  1.099097233e+03f,  1.081984978e+03f,  1.082078881e+03f,
            1.078618269e+03f,  1.075866593e+03f,  1.058992579e+03f,  1.059093783e+03f,  1.055678914e+03f,  1.052959934e+03f,
            1.092682132e+03f,  1.092707998e+03f,  1.089234143e+03f,  1.086508708e+03f,  1.069523155e+03f,  1.069556597e+03f,
            1.066129163e+03f,  1.063436241e+03f,  1.046688439e+03f,  1.046729418e+03f,  1.043347993e+03f,  1.040687397e+03f,
            1.113998407e+03f,  1.113801465e+03f,  1.110511225e+03f,  1.107725158e+03f,  1.090102186e+03f,  1.089916821e+03f,
            1.086669800e+03f,  1.083917763e+03f,  1.066545783e+03f,  1.066371903e+03f,  1.063167740e+03f,  1.060449531e+03f,
            1.100763351e+03f,  1.100503455e+03f,  1.097245646e+03f,  1.094522310e+03f,  1.077034206e+03f,  1.076786120e+03f,
            1.073571854e+03f,  1.070882148e+03f,  1.053644502e+03f,  1.053408139e+03f,  1.050237042e+03f,  1.047580763e+03f,
            1.087284754e+03f,  1.086959953e+03f,  1.083737016e+03f,  1.081077381e+03f,  1.063726452e+03f,  1.063413716e+03f,
            1.060234615e+03f,  1.057608202e+03f,  1.040507183e+03f,  1.040206431e+03f,  1.037070781e+03f,  1.034477388e+03f,
            1.073562615e+03f,  1.073170960e+03f,  1.069985334e+03f,  1.067390369e+03f,  1.050178921e+03f,  1.049799607e+03f,
            1.046658083e+03f,  1.044095926e+03f,  1.027133825e+03f,  1.026766777e+03f,  1.023668958e+03f,  1.021139404e+03f,
            9.201385548e+02f,  9.196861430e+02f,  9.170815007e+02f,  9.147892244e+02f,  8.996479220e+02f,  8.992097670e+02f,
            8.966397610e+02f,  8.943767780e+02f,  8.794596768e+02f,  8.790356632e+02f,  8.765000033e+02f,  8.742661285e+02f,
            9.080159792e+02f,  9.075041249e+02f,  9.049316688e+02f,  9.026979954e+02f,  8.876833887e+02f,  8.871860293e+02f,
            8.846484787e+02f,  8.824437185e+02f,  8.676527918e+02f,  8.671698172e+02f,  8.646668716e+02f,  8.624908381e+02f,
            8.956734115e+02f,  8.951003409e+02f,  8.925622827e+02f,  8.903881104e+02f,  8.755023424e+02f,  8.749440248e+02f,
            8.724411149e+02f,  8.702954689e+02f,  8.556328466e+02f,  8.550891768e+02f,  8.526211043e+02f,  8.505037971e+02f,
            8.831108518e+02f,  8.824747910e+02f,  8.799733424e+02f,  8.778595692e+02f,  8.631047834e+02f,  8.624837534e+02f,
            8.600176696e+02f,  8.579320291e+02f,  8.433998411e+02f,  8.427937418e+02f,  8.403627015e+02f,  8.383050054e+02f,
            9.085906300e+02f,  9.078158950e+02f,  9.054187216e+02f,  9.030594212e+02f,  8.869934203e+02f,  8.862369746e+02f,
            8.838751489e+02f,  8.815507805e+02f,  8.657465006e+02f,  8.650081463e+02f,  8.626813641e+02f,  8.603916875e+02f,
            8.953676877e+02f,  8.945256510e+02f,  8.921648593e+02f,  8.898731347e+02f,  8.739560965e+02f,  8.731326978e+02f,
            8.708074953e+02f,  8.685501933e+02f,  8.528940760e+02f,  8.520891233e+02f,  8.497991935e+02f,  8.475760725e+02f,
            8.819001093e+02f,  8.809887848e+02f,  8.786668320e+02f,  8.764437271e+02f,  8.606782005e+02f,  8.597858866e+02f,
            8.574997331e+02f,  8.553105327e+02f,  8.398051082e+02f,  8.389316186e+02f,  8.366809357e+02f,  8.345253967e+02f,
            8.681878948e+02f,  8.672052966e+02f,  8.649246398e+02f,  8.627711983e+02f,  8.471597324e+02f,  8.461965410e+02f,
            8.439518623e+02f,  8.418317986e+02f,  8.264795973e+02f,  8.255356321e+02f,  8.233265908e+02f,  8.212396603e+02f,
            8.761216000e+02f,  8.749109361e+02f,  8.728261017e+02f,  8.706551008e+02f,  8.546004745e+02f,  8.534134628e+02f,
            8.513610820e+02f,  8.492247994e+02f,  8.334420883e+02f,  8.322784815e+02f,  8.302582735e+02f,  8.281564488e+02f,
            8.617811293e+02f,  8.604965325e+02f,  8.584528555e+02f,  8.563555552e+02f,  8.404643929e+02f,  8.392038584e+02f,
            8.371928541e+02f,  8.351297030e+02f,  8.195095418e+02f,  8.182728285e+02f,  8.162942027e+02f,  8.142649388e+02f,
            8.471792706e+02f,  8.458186275e+02f,  8.438187169e+02f,  8.417962397e+02f,  8.260713034e+02f,  8.247351583e+02f,
            8.227681057e+02f,  8.207791992e+02f,  8.053243289e+02f,  8.040124468e+02f,  8.020779450e+02f,  8.001223454e+02f,
            8.323160240e+02f,  8.308772212e+02f,  8.289236857e+02f,  8.269771542e+02f,  8.114212061e+02f,  8.100073626e+02f,
            8.080868368e+02f,  8.061732878e+02f,  7.908864498e+02f,  7.894973364e+02f,  7.876095004e+02f,  7.857286686e+02f,
            7.049266719e+02f,  7.035776733e+02f,  7.020349171e+02f,  7.003385576e+02f,  6.867919713e+02f,  6.854681090e+02f,
            6.839503757e+02f,  6.822832567e+02f,  6.689769292e+02f,  6.676779455e+02f,  6.661850199e+02f,  6.645469009e+02f,
            6.918445801e+02f,  6.904261155e+02f,  6.889236371e+02f,  6.872959058e+02f,  6.739022990e+02f,  6.725093769e+02f,
            6.710320884e+02f,  6.694330571e+02f,  6.562788216e+02f,  6.549111899e+02f,  6.534588639e+02f,  6.518882905e+02f,
            6.785272340e+02f,  6.770373845e+02f,  6.755775443e+02f,  6.740194773e+02f,  6.607814049e+02f,  6.593175276e+02f,
            6.578830133e+02f,  6.563530970e+02f,  6.433534887e+02f,  6.419153370e+02f,  6.405059095e+02f,  6.390039001e+02f,
            6.649746336e+02f,  6.634114801e+02f,  6.619966385e+02f,  6.605092720e+02f,  6.474292890e+02f,  6.458925611e+02f,
            6.445031507e+02f,  6.430433765e+02f,  6.302009305e+02f,  6.286903866e+02f,  6.273261567e+02f,  6.258937296e+02f,
            5.453837226e+02f,  5.441034410e+02f,  5.429427383e+02f,  5.415136611e+02f,  5.299335020e+02f,  5.286784316e+02f,
            5.275387277e+02f,  5.261379727e+02f,  5.147875244e+02f,  5.135573502e+02f,  5.124384696e+02f,  5.110657777e+02f,
            5.338894128e+02f,  5.325432321e+02f,  5.314218372e+02f,  5.300586144e+02f,  5.186281088e+02f,  5.173076134e+02f,
            5.162072976e+02f,  5.148717984e+02f,  5.036699222e+02f,  5.023748024e+02f,  5.012953781e+02f,  4.999873418e+02f,
            5.221837322e+02f,  5.207698679e+02f,  5.196899532e+02f,  5.183935934e+02f,  5.071152661e+02f,  5.057275848e+02f,
            5.046687990e+02f,  5.033995545e+02f,  4.923487522e+02f,  4.909869496e+02f,  4.899490931e+02f,  4.887067015e+02f,
            5.102666808e+02f,  5.087833485e+02f,  5.077470860e+02f,  5.065185982e+02f,  4.953949739e+02f,  4.939383460e+02f,
            4.929232317e+02f,  4.917212409e+02f,  4.808240146e+02f,  4.793937918e+02f,  4.783996145e+02f,  4.772238568e+02f,
            5.076742325e+02f,  5.060102790e+02f,  5.051322133e+02f,  5.039269974e+02f,  4.926181543e+02f,  4.909844789e+02f,
            4.901245570e+02f,  4.889466200e+02f,  4.778732458e+02f,  4.762694830e+02f,  4.754275512e+02f,  4.742766124e+02f,
            4.952483353e+02f,  4.935123958e+02f,  4.926781904e+02f,  4.915445188e+02f,  4.803991843e+02f,  4.786940692e+02f,
            4.778780507e+02f,  4.767709900e+02f,  4.658598942e+02f,  4.641852437e+02f,  4.633872454e+02f,  4.623065130e+02f,
            4.825973098e+02f,  4.807874902e+02f,  4.799994458e+02f,  4.789383993e+02f,  4.679592964e+02f,  4.661808729e+02f,
            4.654110258e+02f,  4.643759114e+02f,  4.536297917e+02f,  4.518824098e+02f,  4.511305806e+02f,  4.501211140e+02f,
            4.697211559e+02f,  4.678355621e+02f,  4.670959794e+02f,  4.661086389e+02f,  4.552984905e+02f,  4.534448899e+02f,
            4.527234822e+02f,  4.517613842e+02f,  4.411829381e+02f,  4.393609815e+02f,  4.386575570e+02f,  4.377204154e+02f,
            3.897754810e+02f,  3.880875069e+02f,  3.875489786e+02f,  3.867079303e+02f,  3.774321743e+02f,  3.757746329e+02f,
            3.752490809e+02f,  3.744301579e+02f,  3.653594206e+02f,  3.637319530e+02f,  3.632192680e+02f,  3.624222111e+02f,
            3.785238159e+02f,  3.767685283e+02f,  3.762724106e+02f,  3.754977605e+02f,  3.663743807e+02f,  3.646500581e+02f,
            3.641669202e+02f,  3.634137613e+02f,  3.544942106e+02f,  3.528004990e+02f,  3.523302199e+02f,  3.515982914e+02f,
            3.670707731e+02f,  3.652464563e+02f,  3.647948258e+02f,  3.640875680e+02f,  3.551190713e+02f,  3.533262751e+02f,
            3.528875979e+02f,  3.522011872e+02f,  3.434353059e+02f,  3.416736812e+02f,  3.412478247e+02f,  3.405819987e+02f,
            3.554163526e+02f,  3.535212911e+02f,  3.531162241e+02f,  3.524773528e+02f,  3.436662461e+02f,  3.418032839e+02f,
            3.414111139e+02f,  3.407924355e+02f,  3.321827066e+02f,  3.303514994e+02f,  3.299720825e+02f,  3.293733328e+02f,
            2.272073348e+02f,  2.260542402e+02f,  2.256996277e+02f,  2.251175232e+02f,  2.188203209e+02f,  2.176917764e+02f,
            2.173468205e+02f,  2.167824227e+02f,  2.106479978e+02f,  2.095436557e+02f,  2.092082766e+02f,  2.086613450e+02f,
            2.193556439e+02f,  2.181481751e+02f,  2.178301315e+02f,  2.173017491e+02f,  2.111304075e+02f,  2.099480194e+02f,
            2.096395352e+02f,  2.091282541e+02f,  2.031184530e+02f,  2.019608021e+02f,  2.016617874e+02f,  2.011673655e+02f,
            2.113601217e+02f,  2.100969456e+02f,  2.098170615e+02f,  2.093432192e+02f,  2.032998162e+02f,  2.020622717e+02f,
            2.017918243e+02f,  2.013344684e+02f,  1.954513455e+02f,  1.942390928e+02f,  1.939779825e+02f,  1.935368692e+02f,
            2.032207682e+02f,  2.019005520e+02f,  2.016604177e+02f,  2.012419335e+02f,  1.953285471e+02f,  1.940345333e+02f,
            1.938036878e+02f,  1.934010655e+02f,  1.876466752e+02f,  1.863785278e+02f,  1.861568619e+02f,  1.857698561e+02f,
            1.972453080e+02f,  1.958147817e+02f,  1.956720994e+02f,  1.952956009e+02f,  1.893880319e+02f,  1.879860828e+02f,
            1.878506972e+02f,  1.874901999e+02f,  1.817460091e+02f,  1.803722485e+02f,  1.802440920e+02f,  1.798993355e+02f,
            1.887866706e+02f,  1.872971965e+02f,  1.871946589e+02f,  1.868762055e+02f,  1.811052969e+02f,  1.796450036e+02f,
            1.795496181e+02f,  1.792464909e+02f,  1.736375589e+02f,  1.722060616e+02f,  1.721177500e+02f,  1.718296867e+02f,
            1.801752949e+02f,  1.786254637e+02f,  1.785647492e+02f,  1.783052124e+02f,  1.726731916e+02f,  1.711531660e+02f,
            1.710994320e+02f,  1.708545359e+02f,  1.653830640e+02f,  1.638924635e+02f,  1.638456213e+02f,  1.636151018e+02f,
            1.714111811e+02f,  1.697995833e+02f,  1.697823702e+02f,  1.695826215e+02f,  1.640917158e+02f,  1.625105702e+02f,
            1.625001390e+02f,  1.623143349e+02f,  1.569825243e+02f,  1.554314542e+02f,  1.554277058e+02f,  1.552555806e+02f,
            1.361138655e+02f,  1.347188447e+02f,  1.347491274e+02f,  1.345955307e+02f,  1.300101280e+02f,  1.286430811e+02f,
            1.286776325e+02f,  1.285359671e+02f,  1.240894925e+02f,  1.227500498e+02f,  1.227888244e+02f,  1.226588501e+02f,
            1.285697525e+02f,  1.271199116e+02f,  1.271885719e+02f,  1.270886210e+02f,  1.226298504e+02f,  1.212085645e+02f,
            1.212813282e+02f,  1.211926683e+02f,  1.168714754e+02f,  1.154783786e+02f,  1.155551903e+02f,  1.154775797e+02f,
            1.208905851e+02f,  1.193846519e+02f,  1.194931990e+02f,  1.194476922e+02f,  1.151175927e+02f,  1.136408153e+02f,
            1.137532757e+02f,  1.137184101e+02f,  1.095245130e+02f,  1.080765292e+02f,  1.081928380e+02f,  1.081683700e+02f,
            1.130763633e+02f,  1.115130654e+02f,  1.116630085e+02f,  1.116727445e+02f,  1.074733549e+02f,  1.059398334e+02f,
            1.060934750e+02f,  1.061131923e+02f,  1.020486054e+02f,  1.005445015e+02f,  1.007017675e+02f,  1.007312210e+02f,
            3.942086339e+01f,  3.897298365e+01f,  3.888260979e+01f,  3.875225383e+01f,  3.683718951e+01f,  3.640545152e+01f,
            3.631927331e+01f,  3.619603478e+01f,  3.436372663e+01f,  3.394786051e+01f,  3.386582041e+01f,  3.374951421e+01f,
            3.640979029e+01f,  3.592664579e+01f,  3.586561518e+01f,  3.576859231e+01f,  3.393489630e+01f,  3.346838328e+01f,
            3.341130519e+01f,  3.332089284e+01f,  3.156878124e+01f,  3.111863205e+01f,  3.106544242e+01f,  3.098145423e+01f,
            3.334434502e+01f,  3.282521401e+01f,  3.279435715e+01f,  3.273117158e+01f,  3.098012342e+01f,  3.047812726e+01f,
            3.045096315e+01f,  3.039387358e+01f,  2.872321808e+01f,  2.823809125e+01f,  2.821454945e+01f,  2.816336824e+01f,
            3.022452757e+01f,  2.966868831e+01f,  2.966883571e+01f,  2.963999167e+01f,  2.797287087e+01f,  2.743468348e+01f,
            2.743824719e+01f,  2.741497700e+01f,  2.582703714e+01f,  2.530623809e+01f,  2.531314148e+01f,  2.529525625e+01f,
            2.710095882e+01f,  2.650047095e+01f,  2.654248996e+01f,  2.654689506e+01f,  2.495186423e+01f,  2.437010752e+01f,
            2.441464288e+01f,  2.442430124e+01f,  2.290879509e+01f,  2.234547577e+01f,  2.239246811e+01f,  2.240717951e+01f,
            2.387696293e+01f,  2.323876281e+01f,  2.331223680e+01f,  2.335229216e+01f,  2.184462125e+01f,  2.122570297e+01f,
            2.130140135e+01f,  2.134614520e+01f,  1.991667613e+01f,  1.931674821e+01f,  1.939460470e+01f,  1.944383541e+01f,
            2.059542565e+01f,  1.991875658e+01f,  2.002455498e+01f,  2.010079185e+01f,  1.868183758e+01f,  1.802501568e+01f,
            1.813272871e+01f,  1.821308094e+01f,  1.687098360e+01f,  1.623371954e+01f,  1.634327419e+01f,  1.642753877e+01f,
            1.725634697e+01f,  1.654045224e+01f,  1.667944448e+01f,  1.679239413e+01f,  1.546351322e+01f,  1.476804564e+01f,
            1.490862496e+01f,  1.502510848e+01f,  1.377171749e+01f,  1.309638978e+01f,  1.323847658e+01f,  1.335828958e+01f,
            1.082178004e+01f,  1.024148059e+01f,  1.036807424e+01f,  1.047270051e+01f,  9.477308461e+00f,  8.915247161e+00f,
            9.042704158e+00f,  9.150016029e+00f,  8.218830666e+00f,  7.674735200e+00f,  7.803003506e+00f,  7.912816540e+00f,
            8.130008718e+00f,  7.514918827e+00f,  7.671179057e+00f,  7.808542123e+00f,  6.893321747e+00f,  6.296994911e+00f,
            6.453826590e+00f,  6.593340225e+00f,  5.741056574e+00f,  5.163222450e+00f,  5.320567303e+00f,  5.462045769e+00f,
            5.389726066e+00f,  4.739167363e+00f,  4.925869622e+00f,  5.096453695e+00f,  4.262635449e+00f,  3.631378118e+00f,
            3.818343717e+00f,  3.990535515e+00f,  3.218363232e+00f,  2.606138797e+00f,  2.793303382e+00f,  2.966915866e+00f,
            2.600932085e+00f,  1.914226197e+00f,  2.132145937e+00f,  2.336435230e+00f,  1.585249566e+00f,  9.183967816e-01f,
            1.136255539e+00f,  1.341601901e+00f,  6.507506384e-01f,  3.484241593e-03f,  2.212117423e-01f,  4.274268309e-01f,
        };
    }
}
